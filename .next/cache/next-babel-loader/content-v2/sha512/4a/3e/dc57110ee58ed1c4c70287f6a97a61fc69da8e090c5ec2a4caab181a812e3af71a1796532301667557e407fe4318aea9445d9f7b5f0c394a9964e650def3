{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Elements\\\\EditorSimple\\\\Editor.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef, useLayoutEffect } from 'react';\nimport ReactSummernote from 'react-summernote';\nimport { studentApi } from '~/apiBase';\nimport ReactHtmlParser from 'react-html-parser';\nimport { Modal, Input } from 'antd';\nimport 'bootstrap/js/src/modal';\nimport 'bootstrap/js/src/dropdown';\nimport 'bootstrap/js/src/tooltip';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport 'react-summernote/dist/react-summernote.css';\nimport 'react-summernote/lang/summernote-ru-RU';\nimport { PlusOutlined } from '@ant-design/icons';\n\nvar EditorSummernote = function EditorSummernote(props) {\n  _s();\n\n  var getDataEditor = props.getDataEditor,\n      questionContent = props.questionContent,\n      isReset = props.isReset,\n      isTranslate = props.isTranslate,\n      defaultValue = props.defaultValue,\n      isSimpleTool = props.isSimpleTool,\n      height = props.height,\n      isFull = props.isFull;\n  var inputTranslate = useRef(null);\n\n  var _useState = useState(questionContent),\n      valueEditor = _useState[0],\n      setValueEditor = _useState[1];\n\n  var _useState2 = useState(null),\n      textSelect = _useState2[0],\n      setTextSelect = _useState2[1];\n\n  var _useState3 = useState(null),\n      textTranslate = _useState3[0],\n      setTextTranslate = _useState3[1];\n\n  var _useState4 = useState(false),\n      isModalVisible = _useState4[0],\n      setIsModalVisible = _useState4[1];\n\n  var _useState5 = useState([]),\n      dataTranslate = _useState5[0],\n      setDataTranslate = _useState5[1];\n\n  var _useState6 = useState(false),\n      isAddTranslate = _useState6[0],\n      setIsAddTranslate = _useState6[1];\n\n  var _useState7 = useState(false),\n      reloadContent = _useState7[0],\n      setReloadContent = _useState7[1];\n\n  useEffect(function () {\n    !!defaultValue && setValueEditor(defaultValue);\n  }, []);\n\n  var showModal = function showModal(type) {\n    setIsModalVisible(true);\n\n    if (type == 'add') {\n      setIsAddTranslate(true);\n    } else {\n      setIsAddTranslate(false);\n    }\n  };\n\n  var handleOk = function handleOk() {\n    if (isAddTranslate) {\n      if (textSelect) {\n        handleAddTranslate();\n      }\n    } else {\n      handleFixTranslate();\n    }\n\n    setIsModalVisible(false);\n  };\n\n  var handleCancel = function handleCancel() {\n    setIsModalVisible(false);\n    setTextSelect(null);\n    setTextTranslate(null);\n  }; // GET TRANSLATE TEXT\n\n\n  var onChange_GetTranslateText = function onChange_GetTranslateText(e) {\n    var text = e.target.value;\n    setTextTranslate(text);\n  };\n\n  var onKeyDown = function onKeyDown(e) {\n    if (e.key === 'Enter') {\n      handleAddTranslate();\n      setIsModalVisible(false);\n    }\n  }; // HANDLE FIX TRANSLATE\n\n\n  var handleFixTranslate = function handleFixTranslate() {\n    var elementNote = document.querySelectorAll('#editor-element .note-editable .text-note-of-translate');\n    elementNote.forEach(function (item, index) {\n      var noteID = parseInt(item.getAttribute('data-note'));\n      var textItem = item.innerHTML;\n      var indexData = dataTranslate.findIndex(function (e) {\n        return e.noteID === noteID;\n      });\n\n      if (dataTranslate[indexData].textTranslate !== textItem) {\n        item.innerHTML = dataTranslate[indexData].textTranslate;\n        item.setAttribute('title', dataTranslate[indexData].textTranslate);\n      }\n    });\n    setReloadContent(true);\n  }; // HANDLE ADD TRANSLATE\n\n\n  var handleAddTranslate = function handleAddTranslate() {\n    var elementEditor = document.querySelectorAll('#editor-element .note-editable');\n    var elementP = document.querySelectorAll('#editor-element .note-editable p');\n\n    var onAdd = function onAdd(item) {\n      var innerText = item.innerHTML;\n\n      if (innerText.includes(textSelect)) {\n        var noteID = null;\n\n        if (dataTranslate.length < 1) {\n          noteID = 0;\n        } else {\n          noteID = dataTranslate[dataTranslate.length - 1].noteID + 1;\n        }\n\n        item.innerHTML = innerText.replace(textSelect, \"<input class=\\\"input-prevent-translate\\\"/><span title=\\\"\".concat(textTranslate, \"\\\" class=\\\"text-normal-of-translate\\\">\").concat(textSelect, \"<span data-note=\\\"\").concat(noteID, \"\\\" class=\\\"text-note-of-translate\\\">\").concat(textTranslate, \"</span></span><input class=\\\"input-prevent-translate\\\"/>\"));\n        dataTranslate.push({\n          noteID: noteID,\n          textSelect: textSelect,\n          textTranslate: textTranslate\n        });\n        setDataTranslate(_toConsumableArray(dataTranslate));\n      }\n    };\n\n    if (elementP.length > 0) {\n      elementP.forEach(function (item) {\n        onAdd(item);\n      });\n    } else {\n      onAdd(elementEditor[0]);\n    }\n\n    setTextTranslate(null);\n    setTextSelect(null);\n    setReloadContent(true);\n  };\n\n  var onFixTextTranslate = function onFixTextTranslate(e, noteID) {\n    var text = e.target.value;\n    var index = dataTranslate.findIndex(function (item) {\n      return item.noteID == noteID;\n    });\n    dataTranslate[index].textTranslate = text;\n    setDataTranslate(_toConsumableArray(dataTranslate));\n  };\n\n  useEffect(function () {\n    var getNodes = function getNodes(str) {\n      return new DOMParser().parseFromString(str, 'text/html').body.childNodes;\n    };\n\n    var editorElement = document.getElementById('editor-element');\n    editorElement.addEventListener('mouseup', function (e) {\n      var sel = window.getSelection && window.getSelection();\n\n      if (sel && sel.rangeCount > 0) {\n        var _textSelect = window.getSelection().toString();\n\n        setTextSelect(_textSelect);\n      }\n    });\n  }); // ON CHANGE\n\n  var _onChange = function onChange(content) {\n    getDataEditor(content);\n  }; // UPLOAD IMAGES\n\n\n  var onImageUpload = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(fileList) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return studentApi.uploadImage(fileList[0]);\n\n            case 3:\n              res = _context.sent;\n\n              if (res.status == 200) {\n                ReactSummernote.insertImage(res.data.data);\n              }\n\n              _context.next = 9;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n\n    return function onImageUpload(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useLayoutEffect(function () {\n    if (isModalVisible) {\n      inputTranslate.current && inputTranslate.current.select();\n    }\n  }, [isModalVisible]);\n  useEffect(function () {\n    if (reloadContent) {\n      var elementEditor = document.querySelectorAll('#editor-element .note-editable');\n      setValueEditor(elementEditor[0].innerHTML);\n      getDataEditor(elementEditor[0].innerHTML);\n      setReloadContent(false);\n    }\n  }, [reloadContent]); // HANDLE RESET\n\n  useEffect(function () {\n    isReset && (ReactSummernote.reset(), setValueEditor(''));\n  }, [isReset]);\n  useEffect(function () {\n    var elementNote = document.querySelectorAll('#editor-element .note-editable .text-normal-of-translate');\n\n    if (elementNote.length > 0) {\n      elementNote.forEach(function (item) {\n        var noteID = item.lastChild.attributes[0].nodeValue;\n        var textSelect = item.firstChild.nodeValue;\n        var textTranslate = item.lastChild.childNodes[0].nodeValue;\n        dataTranslate.push({\n          noteID: parseInt(noteID),\n          textSelect: textSelect,\n          textTranslate: textTranslate\n        });\n      });\n      setDataTranslate(_toConsumableArray(dataTranslate));\n    }\n  }, []);\n\n  var getListTool = function getListTool() {\n    var temp = [];\n\n    if (!!isFull) {\n      temp = [['style', ['style']], ['font', ['bold', 'underline', 'clear']], ['color', ['color']], ['para', ['ul', 'ol', 'paragraph']], ['table', ['table']], ['insert', ['link', 'picture', 'video']], ['view', ['fullscreen', 'codeview', 'help']]];\n    } else if (isSimpleTool) {\n      temp = [['style', ['style']], ['font', ['bold', 'underline']], ['color', ['color']], ['fontname', ['fontname']], ['para', ['ol', 'paragraph']], ['insert', ['link']]];\n    } else {\n      temp = [['style', ['style']], ['font', ['bold', 'underline', 'clear']], ['fontname', ['fontname']], ['para', ['ul', 'ol', 'paragraph']], ['table', ['table']], ['insert', ['link', 'picture', 'video']], ['view', ['codeview', 'fullscreen']]];\n    }\n\n    return temp;\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Modal, {\n      title: \"Phi\\xEAn \\xE2m\",\n      visible: isModalVisible,\n      okText: \"L\\u01B0u\",\n      cancelText: \"H\\u1EE7y\",\n      onOk: handleOk,\n      onCancel: handleCancel,\n      children: isAddTranslate ? textSelect ? /*#__PURE__*/_jsxDEV(Input, {\n        allowClear: true,\n        id: \"input-translate\",\n        className: \"style-input\",\n        value: textTranslate,\n        onChange: onChange_GetTranslateText,\n        onKeyDown: onKeyDown,\n        ref: inputTranslate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 7\n      }, _this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          fontWeight: 500\n        },\n        children: \"Vui l\\xF2ng ch\\u1ECDn n\\u1ED9i dung c\\u1EA7n phi\\xEAn \\xE2m\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 7\n      }, _this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"detail-translate\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"text-center\",\n              children: \"N\\u1ED9i dung\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 9\n            }, _this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"text-center\",\n              children: \"Phi\\xEAn \\xE2m\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 9\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 8\n          }, _this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: dataTranslate.map(function (item, index) {\n              return /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: item.textSelect\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 269,\n                  columnNumber: 11\n                }, _this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"text-center\",\n                  children: /*#__PURE__*/_jsxDEV(\"input\", {\n                    className: \"show-text-translate\",\n                    type: \"text\",\n                    value: item.textTranslate,\n                    onChange: function onChange(e) {\n                      onFixTextTranslate(e, item.noteID);\n                    },\n                    onKeyDown: function onKeyDown(e) {\n                      if (e.key === 'Enter') {\n                        handleFixTranslate();\n                        setIsModalVisible(false);\n                      }\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 271,\n                    columnNumber: 12\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 11\n                }, _this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 10\n              }, _this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 8\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 7\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 6\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 4\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"wrap-editor\",\n      id: \"editor-element\",\n      style: {\n        borderRadius: 8\n      },\n      children: [isTranslate && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex align-items-center mb-2\",\n          style: {\n            display: 'flex',\n            flexDirection: 'row',\n            width: '100%',\n            justifyContent: 'flex-end'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-editor d-flex align-items-center mr-2\",\n            onClick: function onClick() {\n              return showModal('add');\n            },\n            children: [/*#__PURE__*/_jsxDEV(PlusOutlined, {\n              className: \"mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 9\n            }, _this), \" Th\\xEAm Phi\\xEAn \\xE2m\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 8\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 7\n        }, _this)\n      }, void 0, false), /*#__PURE__*/_jsxDEV(ReactSummernote, {\n        value: valueEditor,\n        children: ReactHtmlParser(valueEditor),\n        options: {\n          lang: 'vn',\n          height: height || 220,\n          dialogsInBody: true,\n          toolbar: getListTool()\n        },\n        onChange: function onChange(content) {\n          return _onChange(content);\n        },\n        onImageUpload: onImageUpload\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 5\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 4\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(EditorSummernote, \"3r4ysgT/TPQJdj18jOmWeF5o98Q=\");\n\n_c = EditorSummernote;\nexport default EditorSummernote;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditorSummernote\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Elements/EditorSimple/Editor.tsx"],"names":["React","useEffect","useState","useRef","useLayoutEffect","ReactSummernote","studentApi","ReactHtmlParser","Modal","Input","PlusOutlined","EditorSummernote","props","getDataEditor","questionContent","isReset","isTranslate","defaultValue","isSimpleTool","height","isFull","inputTranslate","valueEditor","setValueEditor","textSelect","setTextSelect","textTranslate","setTextTranslate","isModalVisible","setIsModalVisible","dataTranslate","setDataTranslate","isAddTranslate","setIsAddTranslate","reloadContent","setReloadContent","showModal","type","handleOk","handleAddTranslate","handleFixTranslate","handleCancel","onChange_GetTranslateText","e","text","target","value","onKeyDown","key","elementNote","document","querySelectorAll","forEach","item","index","noteID","parseInt","getAttribute","textItem","innerHTML","indexData","findIndex","setAttribute","elementEditor","elementP","onAdd","innerText","includes","length","replace","push","onFixTextTranslate","getNodes","str","DOMParser","parseFromString","body","childNodes","editorElement","getElementById","addEventListener","sel","window","getSelection","rangeCount","toString","onChange","content","onImageUpload","fileList","uploadImage","res","status","insertImage","data","current","select","reset","lastChild","attributes","nodeValue","firstChild","getListTool","temp","fontWeight","map","borderRadius","display","flexDirection","width","justifyContent","lang","dialogsInBody","toolbar"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef, useLayoutEffect } from 'react'\r\nimport ReactSummernote from 'react-summernote'\r\nimport { studentApi } from '~/apiBase'\r\nimport ReactHtmlParser from 'react-html-parser'\r\nimport { Modal, Input } from 'antd'\r\nimport 'bootstrap/js/src/modal'\r\nimport 'bootstrap/js/src/dropdown'\r\nimport 'bootstrap/js/src/tooltip'\r\nimport 'bootstrap/dist/css/bootstrap.css'\r\nimport 'react-summernote/dist/react-summernote.css'\r\nimport 'react-summernote/lang/summernote-ru-RU'\r\nimport { PlusOutlined } from '@ant-design/icons'\r\n\r\ntype dataTranslate = Array<{\r\n\tnoteID: number\r\n\ttextSelect: string\r\n\ttextTranslate: string\r\n}>\r\n\r\nconst EditorSummernote = (props) => {\r\n\tconst { getDataEditor, questionContent, isReset, isTranslate, defaultValue, isSimpleTool, height, isFull } = props\r\n\tlet inputTranslate = useRef(null)\r\n\r\n\tconst [valueEditor, setValueEditor] = useState(questionContent)\r\n\tconst [textSelect, setTextSelect] = useState(null)\r\n\tconst [textTranslate, setTextTranslate] = useState(null)\r\n\tconst [isModalVisible, setIsModalVisible] = useState(false)\r\n\tconst [dataTranslate, setDataTranslate] = useState<dataTranslate>([])\r\n\tconst [isAddTranslate, setIsAddTranslate] = useState(false)\r\n\tconst [reloadContent, setReloadContent] = useState(false)\r\n\r\n\tuseEffect(() => {\r\n\t\t!!defaultValue && setValueEditor(defaultValue)\r\n\t}, [])\r\n\r\n\tconst showModal = (type) => {\r\n\t\tsetIsModalVisible(true)\r\n\t\tif (type == 'add') {\r\n\t\t\tsetIsAddTranslate(true)\r\n\t\t} else {\r\n\t\t\tsetIsAddTranslate(false)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleOk = () => {\r\n\t\tif (isAddTranslate) {\r\n\t\t\tif (textSelect) {\r\n\t\t\t\thandleAddTranslate()\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\thandleFixTranslate()\r\n\t\t}\r\n\t\tsetIsModalVisible(false)\r\n\t}\r\n\r\n\tconst handleCancel = () => {\r\n\t\tsetIsModalVisible(false)\r\n\t\tsetTextSelect(null)\r\n\t\tsetTextTranslate(null)\r\n\t}\r\n\r\n\t// GET TRANSLATE TEXT\r\n\tconst onChange_GetTranslateText = (e) => {\r\n\t\tlet text = e.target.value\r\n\t\tsetTextTranslate(text)\r\n\t}\r\n\r\n\tconst onKeyDown = (e) => {\r\n\t\tif (e.key === 'Enter') {\r\n\t\t\thandleAddTranslate()\r\n\t\t\tsetIsModalVisible(false)\r\n\t\t}\r\n\t}\r\n\r\n\t// HANDLE FIX TRANSLATE\r\n\tconst handleFixTranslate = () => {\r\n\t\tlet elementNote = document.querySelectorAll('#editor-element .note-editable .text-note-of-translate')\r\n\t\telementNote.forEach((item, index) => {\r\n\t\t\tlet noteID = parseInt(item.getAttribute('data-note'))\r\n\t\t\tlet textItem = item.innerHTML\r\n\r\n\t\t\tlet indexData = dataTranslate.findIndex((e) => e.noteID === noteID)\r\n\t\t\tif (dataTranslate[indexData].textTranslate !== textItem) {\r\n\t\t\t\titem.innerHTML = dataTranslate[indexData].textTranslate\r\n\t\t\t\titem.setAttribute('title', dataTranslate[indexData].textTranslate)\r\n\t\t\t}\r\n\t\t})\r\n\t\tsetReloadContent(true)\r\n\t}\r\n\r\n\t// HANDLE ADD TRANSLATE\r\n\tconst handleAddTranslate = () => {\r\n\t\tlet elementEditor = document.querySelectorAll('#editor-element .note-editable')\r\n\t\tlet elementP = document.querySelectorAll('#editor-element .note-editable p')\r\n\r\n\t\tconst onAdd = (item) => {\r\n\t\t\tlet innerText = item.innerHTML\r\n\t\t\tif (innerText.includes(textSelect)) {\r\n\t\t\t\tlet noteID = null\r\n\t\t\t\tif (dataTranslate.length < 1) {\r\n\t\t\t\t\tnoteID = 0\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnoteID = dataTranslate[dataTranslate.length - 1].noteID + 1\r\n\t\t\t\t}\r\n\r\n\t\t\t\titem.innerHTML = innerText.replace(\r\n\t\t\t\t\ttextSelect,\r\n\t\t\t\t\t`<input class=\"input-prevent-translate\"/><span title=\"${textTranslate}\" class=\"text-normal-of-translate\">${textSelect}<span data-note=\"${noteID}\" class=\"text-note-of-translate\">${textTranslate}</span></span><input class=\"input-prevent-translate\"/>`\r\n\t\t\t\t)\r\n\r\n\t\t\t\tdataTranslate.push({\r\n\t\t\t\t\tnoteID: noteID,\r\n\t\t\t\t\ttextSelect: textSelect,\r\n\t\t\t\t\ttextTranslate: textTranslate\r\n\t\t\t\t})\r\n\t\t\t\tsetDataTranslate([...dataTranslate])\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (elementP.length > 0) {\r\n\t\t\telementP.forEach((item) => {\r\n\t\t\t\tonAdd(item)\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tonAdd(elementEditor[0])\r\n\t\t}\r\n\r\n\t\tsetTextTranslate(null)\r\n\t\tsetTextSelect(null)\r\n\t\tsetReloadContent(true)\r\n\t}\r\n\r\n\tconst onFixTextTranslate = (e, noteID) => {\r\n\t\tlet text = e.target.value\r\n\t\tlet index = dataTranslate.findIndex((item) => item.noteID == noteID)\r\n\r\n\t\tdataTranslate[index].textTranslate = text\r\n\t\tsetDataTranslate([...dataTranslate])\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tlet getNodes = (str) => new DOMParser().parseFromString(str, 'text/html').body.childNodes\r\n\r\n\t\tlet editorElement = document.getElementById('editor-element')\r\n\t\teditorElement.addEventListener('mouseup', (e) => {\r\n\t\t\tvar sel = window.getSelection && window.getSelection()\r\n\t\t\tif (sel && sel.rangeCount > 0) {\r\n\t\t\t\tlet textSelect = window.getSelection().toString()\r\n\t\t\t\tsetTextSelect(textSelect)\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\t// ON CHANGE\r\n\tconst onChange = (content) => {\r\n\t\tgetDataEditor(content)\r\n\t}\r\n\r\n\t// UPLOAD IMAGES\r\n\tconst onImageUpload = async (fileList) => {\r\n\t\ttry {\r\n\t\t\tlet res = await studentApi.uploadImage(fileList[0])\r\n\t\t\tif (res.status == 200) {\r\n\t\t\t\tReactSummernote.insertImage(res.data.data)\r\n\t\t\t}\r\n\t\t} catch (error) {}\r\n\t}\r\n\r\n\tuseLayoutEffect(() => {\r\n\t\tif (isModalVisible) {\r\n\t\t\tinputTranslate.current && inputTranslate.current.select()\r\n\t\t}\r\n\t}, [isModalVisible])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (reloadContent) {\r\n\t\t\tlet elementEditor = document.querySelectorAll('#editor-element .note-editable')\r\n\t\t\tsetValueEditor(elementEditor[0].innerHTML)\r\n\t\t\tgetDataEditor(elementEditor[0].innerHTML)\r\n\t\t\tsetReloadContent(false)\r\n\t\t}\r\n\t}, [reloadContent])\r\n\r\n\t// HANDLE RESET\r\n\tuseEffect(() => {\r\n\t\tisReset && (ReactSummernote.reset(), setValueEditor(''))\r\n\t}, [isReset])\r\n\r\n\tuseEffect(() => {\r\n\t\tlet elementNote = document.querySelectorAll('#editor-element .note-editable .text-normal-of-translate')\r\n\r\n\t\tif (elementNote.length > 0) {\r\n\t\t\telementNote.forEach((item: any) => {\r\n\t\t\t\tlet noteID = item.lastChild.attributes[0].nodeValue\r\n\t\t\t\tlet textSelect = item.firstChild.nodeValue\r\n\t\t\t\tlet textTranslate = item.lastChild.childNodes[0].nodeValue\r\n\t\t\t\tdataTranslate.push({\r\n\t\t\t\t\tnoteID: parseInt(noteID),\r\n\t\t\t\t\ttextSelect: textSelect,\r\n\t\t\t\t\ttextTranslate: textTranslate\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\tsetDataTranslate([...dataTranslate])\r\n\t\t}\r\n\t}, [])\r\n\r\n\tconst getListTool = () => {\r\n\t\tlet temp: any = []\r\n\t\tif (!!isFull) {\r\n\t\t\ttemp = [\r\n\t\t\t\t['style', ['style']],\r\n\t\t\t\t['font', ['bold', 'underline', 'clear']],\r\n\t\t\t\t['color', ['color']],\r\n\t\t\t\t['para', ['ul', 'ol', 'paragraph']],\r\n\t\t\t\t['table', ['table']],\r\n\t\t\t\t['insert', ['link', 'picture', 'video']],\r\n\t\t\t\t['view', ['fullscreen', 'codeview', 'help']]\r\n\t\t\t]\r\n\t\t} else if (isSimpleTool) {\r\n\t\t\ttemp = [\r\n\t\t\t\t['style', ['style']],\r\n\t\t\t\t['font', ['bold', 'underline']],\r\n\t\t\t\t['color', ['color']],\r\n\t\t\t\t['fontname', ['fontname']],\r\n\t\t\t\t['para', ['ol', 'paragraph']],\r\n\t\t\t\t['insert', ['link']]\r\n\t\t\t]\r\n\t\t} else {\r\n\t\t\ttemp = [\r\n\t\t\t\t['style', ['style']],\r\n\t\t\t\t['font', ['bold', 'underline', 'clear']],\r\n\t\t\t\t['fontname', ['fontname']],\r\n\t\t\t\t['para', ['ul', 'ol', 'paragraph']],\r\n\t\t\t\t['table', ['table']],\r\n\t\t\t\t['insert', ['link', 'picture', 'video']],\r\n\t\t\t\t['view', ['codeview', 'fullscreen']]\r\n\t\t\t]\r\n\t\t}\r\n\t\treturn temp\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Modal title=\"Phiên âm\" visible={isModalVisible} okText=\"Lưu\" cancelText=\"Hủy\" onOk={handleOk} onCancel={handleCancel}>\r\n\t\t\t\t{isAddTranslate ? (\r\n\t\t\t\t\ttextSelect ? (\r\n\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\tallowClear\r\n\t\t\t\t\t\t\tid=\"input-translate\"\r\n\t\t\t\t\t\t\tclassName=\"style-input\"\r\n\t\t\t\t\t\t\tvalue={textTranslate}\r\n\t\t\t\t\t\t\tonChange={onChange_GetTranslateText}\r\n\t\t\t\t\t\t\tonKeyDown={onKeyDown}\r\n\t\t\t\t\t\t\tref={inputTranslate}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<p style={{ fontWeight: 500 }}>Vui lòng chọn nội dung cần phiên âm</p>\r\n\t\t\t\t\t)\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<div className=\"detail-translate\">\r\n\t\t\t\t\t\t<table>\r\n\t\t\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t\t\t<th className=\"text-center\">Nội dung</th>\r\n\t\t\t\t\t\t\t\t<th className=\"text-center\">Phiên âm</th>\r\n\t\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t{dataTranslate.map((item, index) => (\r\n\t\t\t\t\t\t\t\t\t<tr key={index}>\r\n\t\t\t\t\t\t\t\t\t\t<td>{item.textSelect}</td>\r\n\t\t\t\t\t\t\t\t\t\t<td className=\"text-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"show-text-translate\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={item.textTranslate}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonFixTextTranslate(e, item.noteID)\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonKeyDown={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (e.key === 'Enter') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleFixTranslate()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetIsModalVisible(false)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t</table>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</Modal>\r\n\t\t\t<div className=\"wrap-editor\" id=\"editor-element\" style={{ borderRadius: 8 }}>\r\n\t\t\t\t{isTranslate && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName=\"d-flex align-items-center mb-2\"\r\n\t\t\t\t\t\t\tstyle={{ display: 'flex', flexDirection: 'row', width: '100%', justifyContent: 'flex-end' }}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<button className=\"btn-editor d-flex align-items-center mr-2\" onClick={() => showModal('add')}>\r\n\t\t\t\t\t\t\t\t<PlusOutlined className=\"mr-2\" /> Thêm Phiên âm\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<ReactSummernote\r\n\t\t\t\t\tvalue={valueEditor}\r\n\t\t\t\t\tchildren={ReactHtmlParser(valueEditor)}\r\n\t\t\t\t\toptions={{\r\n\t\t\t\t\t\tlang: 'vn',\r\n\t\t\t\t\t\theight: height || 220,\r\n\t\t\t\t\t\tdialogsInBody: true,\r\n\t\t\t\t\t\ttoolbar: getListTool()\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonChange={(content: any) => onChange(content)}\r\n\t\t\t\t\tonImageUpload={onImageUpload}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default EditorSummernote\r\n"]},"metadata":{},"sourceType":"module"}