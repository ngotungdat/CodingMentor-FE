{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\pages\\\\course\\\\calendar\\\\index.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Card } from 'antd';\nimport moment from 'moment';\nimport { useRouter } from 'next/router';\nimport React, { useLayoutEffect } from 'react';\nimport { useState } from 'react';\nimport { CalendarApi } from '~/apiBase/Calendar/calendar';\nimport CourseCalendar from '~/components/CourseCalendar';\nimport FillterCalendar from '~/components/Global/Option/FilterTable/FillterCalendar';\nimport LayoutBase from '~/components/LayoutBase';\nimport { useWrap } from '~/context/wrap';\nvar now = new Date();\nvar todoApiInit = {\n  status: null,\n  teacherId: 0,\n  openDate: moment(now).format('YYYY/MM/DD')\n};\nvar options = {\n  status: {\n    teacher: [{\n      ID: null,\n      title: 'Tất cả'\n    }, {\n      ID: 1,\n      title: 'Đang mở'\n    }, {\n      ID: 2,\n      title: 'Đã hủy'\n    }, {\n      ID: 3,\n      title: 'Đã đặt lịch'\n    }, {\n      ID: 4,\n      title: 'Đã hoàn thành'\n    }, {\n      ID: 5,\n      title: 'Đã xác nhận dạy'\n    }, {\n      ID: 6,\n      title: 'Sự cố'\n    }, {\n      ID: 7,\n      title: 'Đang diễn ra'\n    }, {\n      ID: 8,\n      title: 'Đã kết thúc'\n    }, {\n      ID: 9,\n      title: 'Đã tạo phòng'\n    }],\n    student: [{\n      ID: null,\n      title: 'Tất cả'\n    }, {\n      ID: 1,\n      title: 'Đang mở'\n    }, {\n      ID: 3,\n      title: 'Đã đặt lịch'\n    }, {\n      ID: 4,\n      title: 'Đã hoàn thành'\n    }, {\n      ID: 5,\n      title: 'Đã xác nhận dạy'\n    }, {\n      ID: 6,\n      title: 'Sự cố'\n    }, {\n      ID: 7,\n      title: 'Đang diễn ra'\n    }, {\n      ID: 8,\n      title: 'Đã kết thúc'\n    }, {\n      ID: 9,\n      title: 'Đã tạo phòng'\n    }]\n  }\n};\n\nvar CouCalen = function CouCalen() {\n  _s();\n\n  var _useWrap = useWrap(),\n      getTitlePage = _useWrap.getTitlePage,\n      showNoti = _useWrap.showNoti,\n      userInformation = _useWrap.userInformation;\n\n  var _useState = useState([]),\n      calendarEvents = _useState[0],\n      setEvents = _useState[1];\n\n  var _useState2 = useState([]),\n      videoCourses = _useState2[0],\n      setVideoCourses = _useState2[1];\n\n  var _useState3 = useState(todoApiInit),\n      todoApi = _useState3[0],\n      setTodoApi = _useState3[1];\n\n  var route = useRouter();\n  var query = route.query;\n\n  var isTeach = function isTeach() {\n    return !!userInformation && userInformation.RoleID == 2 ? true : false;\n  };\n\n  var isAdOrTeach = function isAdOrTeach() {\n    return !!userInformation && (userInformation.RoleID == 1 || isTeach()) ? true : false;\n  };\n\n  useLayoutEffect(function () {\n    if (!!(query !== null && query !== void 0 && query.teacher)) {\n      setTodoApi(_objectSpread(_objectSpread({}, todoApi), {}, {\n        teacherId: parseInt(query.teacher)\n      }));\n    } else {\n      setTodoApi(_objectSpread(_objectSpread({}, todoApi), {}, {\n        teacherId: userInformation === null || userInformation === void 0 ? void 0 : userInformation.UserInformationID\n      }));\n    }\n  }, []);\n  useLayoutEffect(function () {\n    todoApi !== todoApiInit && getTeacherEvents();\n  }, [todoApi]);\n\n  var _getData = function _getData() {\n    isAdOrTeach() && getTeacherEvents();\n  };\n\n  var getTeacherEvents = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return CalendarApi.getCalendarEvents(_objectSpread({}, todoApi));\n\n            case 3:\n              res = _context.sent;\n              res.status == 200 && setEvents(res.data.data);\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              showNoti('danger', _context.t0 === null || _context.t0 === void 0 ? void 0 : _context.t0.message);\n\n            case 10:\n              _context.prev = 10;\n              isTeach() && getVideoCourseCalendar();\n              return _context.finish(10);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7, 10, 13]]);\n    }));\n\n    return function getTeacherEvents() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var getVideoCourseCalendar = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return CalendarApi.getOpenCalendar();\n\n            case 3:\n              res = _context2.sent;\n              res.status == 200 && setVideoCourses(res.data.data);\n              _context2.next = 10;\n              break;\n\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](0);\n              showNoti('danger', _context2.t0 === null || _context2.t0 === void 0 ? void 0 : _context2.t0.message);\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 7]]);\n    }));\n\n    return function getVideoCourseCalendar() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var _formatEvents = function _formatEvents(param) {\n    var temp = [];\n\n    if (!!param) {\n      for (var i = 0; i < param.length; i++) {\n        var event = param[i];\n        temp.push({\n          id: event === null || event === void 0 ? void 0 : event.ID,\n          name: event === null || event === void 0 ? void 0 : event.Title,\n          title: (event === null || event === void 0 ? void 0 : event.sTime) + ' - ' + (event === null || event === void 0 ? void 0 : event.eTime),\n          allDay: true,\n          start: new Date(event === null || event === void 0 ? void 0 : event.sDateTime),\n          end: new Date(event === null || event === void 0 ? void 0 : event.eDateTime),\n          sTime: event === null || event === void 0 ? void 0 : event.sTime,\n          eTime: event === null || event === void 0 ? void 0 : event.eTime,\n          OpenDate: event === null || event === void 0 ? void 0 : event.OpenDate,\n          resource: event\n        });\n      }\n    }\n\n    console.log('_formatEvents: ', temp);\n    return temp;\n  };\n\n  var _reset = function _reset() {\n    setTodoApi(_objectSpread(_objectSpread({}, todoApiInit), {}, {\n      pageIndex: 1\n    }));\n  };\n\n  var _filter = function _filter(paramFilter) {\n    var newTodoApi = _objectSpread(_objectSpread({}, todoApiInit), paramFilter);\n\n    setTodoApi(newTodoApi);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    title: /*#__PURE__*/_jsxDEV(FillterCalendar, {\n      handleReset: _reset,\n      data: options,\n      handleFilter: function handleFilter(value) {\n        return _filter(value);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 16\n    }, _this),\n    children: [getTitlePage('Đăng ký lịch'), /*#__PURE__*/_jsxDEV(CourseCalendar, {\n      getData: getTeacherEvents,\n      events: _formatEvents(calendarEvents),\n      courses: videoCourses\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 4\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 137,\n    columnNumber: 3\n  }, _this);\n};\n\n_s(CouCalen, \"VOQE8ydxSrjt9wqPyUzmx0MckEk=\", false, function () {\n  return [useWrap, useRouter];\n});\n\n_c = CouCalen;\nCouCalen.layout = LayoutBase;\nexport default CouCalen;\n\nvar _c;\n\n$RefreshReg$(_c, \"CouCalen\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/pages/course/calendar/index.tsx"],"names":["Card","moment","useRouter","React","useLayoutEffect","useState","CalendarApi","CourseCalendar","FillterCalendar","LayoutBase","useWrap","now","Date","todoApiInit","status","teacherId","openDate","format","options","teacher","ID","title","student","CouCalen","getTitlePage","showNoti","userInformation","calendarEvents","setEvents","videoCourses","setVideoCourses","todoApi","setTodoApi","route","query","isTeach","RoleID","isAdOrTeach","parseInt","UserInformationID","getTeacherEvents","_getData","getCalendarEvents","res","data","message","getVideoCourseCalendar","getOpenCalendar","_formatEvents","param","temp","i","length","event","push","id","name","Title","sTime","eTime","allDay","start","sDateTime","end","eDateTime","OpenDate","resource","console","log","_reset","pageIndex","_filter","paramFilter","newTodoApi","value","layout"],"mappings":"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","sourcesContent":["import { Card, message } from 'antd'\r\nimport moment from 'moment'\r\nimport { useRouter } from 'next/router'\r\nimport React, { useEffect, useLayoutEffect } from 'react'\r\nimport { useState } from 'react'\r\nimport { CalendarApi } from '~/apiBase/Calendar/calendar'\r\nimport CourseCalendar from '~/components/CourseCalendar'\r\nimport FillterCalendar from '~/components/Global/Option/FilterTable/FillterCalendar'\r\nimport FilterTeacher from '~/components/Global/Option/FilterTable/FilterTeacher'\r\nimport LayoutBase from '~/components/LayoutBase'\r\nimport { useWrap } from '~/context/wrap'\r\n\r\nconst now = new Date()\r\n\r\nconst todoApiInit = {\r\n\tstatus: null,\r\n\tteacherId: 0,\r\n\topenDate: moment(now).format('YYYY/MM/DD')\r\n}\r\n\r\nconst options = {\r\n\tstatus: {\r\n\t\tteacher: [\r\n\t\t\t{ ID: null, title: 'Tất cả' },\r\n\t\t\t{ ID: 1, title: 'Đang mở' },\r\n\t\t\t{ ID: 2, title: 'Đã hủy' },\r\n\t\t\t{ ID: 3, title: 'Đã đặt lịch' },\r\n\t\t\t{ ID: 4, title: 'Đã hoàn thành' },\r\n\t\t\t{ ID: 5, title: 'Đã xác nhận dạy' },\r\n\t\t\t{ ID: 6, title: 'Sự cố' },\r\n\t\t\t{ ID: 7, title: 'Đang diễn ra' },\r\n\t\t\t{ ID: 8, title: 'Đã kết thúc' },\r\n\t\t\t{ ID: 9, title: 'Đã tạo phòng' }\r\n\t\t],\r\n\t\tstudent: [\r\n\t\t\t{ ID: null, title: 'Tất cả' },\r\n\t\t\t{ ID: 1, title: 'Đang mở' },\r\n\t\t\t{ ID: 3, title: 'Đã đặt lịch' },\r\n\t\t\t{ ID: 4, title: 'Đã hoàn thành' },\r\n\t\t\t{ ID: 5, title: 'Đã xác nhận dạy' },\r\n\t\t\t{ ID: 6, title: 'Sự cố' },\r\n\t\t\t{ ID: 7, title: 'Đang diễn ra' },\r\n\t\t\t{ ID: 8, title: 'Đã kết thúc' },\r\n\t\t\t{ ID: 9, title: 'Đã tạo phòng' }\r\n\t\t]\r\n\t}\r\n}\r\n\r\nconst CouCalen = () => {\r\n\tconst { getTitlePage, showNoti, userInformation } = useWrap()\r\n\r\n\tconst [calendarEvents, setEvents] = useState([])\r\n\tconst [videoCourses, setVideoCourses] = useState([])\r\n\tconst [todoApi, setTodoApi] = useState<any>(todoApiInit)\r\n\r\n\tconst route = useRouter()\r\n\r\n\tconst query: any = route.query\r\n\r\n\tconst isTeach = () => {\r\n\t\treturn !!userInformation && userInformation.RoleID == 2 ? true : false\r\n\t}\r\n\r\n\tconst isAdOrTeach = () => {\r\n\t\treturn !!userInformation && (userInformation.RoleID == 1 || isTeach()) ? true : false\r\n\t}\r\n\r\n\tuseLayoutEffect(() => {\r\n\t\tif (!!query?.teacher) {\r\n\t\t\tsetTodoApi({ ...todoApi, teacherId: parseInt(query.teacher) })\r\n\t\t} else {\r\n\t\t\tsetTodoApi({ ...todoApi, teacherId: userInformation?.UserInformationID })\r\n\t\t}\r\n\t}, [])\r\n\r\n\tuseLayoutEffect(() => {\r\n\t\ttodoApi !== todoApiInit && getTeacherEvents()\r\n\t}, [todoApi])\r\n\r\n\tconst _getData = () => {\r\n\t\tisAdOrTeach() && getTeacherEvents()\r\n\t}\r\n\r\n\tconst getTeacherEvents = async () => {\r\n\t\ttry {\r\n\t\t\tconst res: any = await CalendarApi.getCalendarEvents({ ...todoApi })\r\n\t\t\tres.status == 200 && setEvents(res.data.data)\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error?.message)\r\n\t\t} finally {\r\n\t\t\tisTeach() && getVideoCourseCalendar()\r\n\t\t}\r\n\t}\r\n\r\n\tconst getVideoCourseCalendar = async () => {\r\n\t\ttry {\r\n\t\t\tconst res: any = await CalendarApi.getOpenCalendar()\r\n\t\t\tres.status == 200 && setVideoCourses(res.data.data)\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error?.message)\r\n\t\t}\r\n\t}\r\n\r\n\tconst _formatEvents = (param: any) => {\r\n\t\tlet temp: any = []\r\n\t\tif (!!param) {\r\n\t\t\tfor (let i = 0; i < param.length; i++) {\r\n\t\t\t\tlet event = param[i]\r\n\t\t\t\ttemp.push({\r\n\t\t\t\t\tid: event?.ID,\r\n\t\t\t\t\tname: event?.Title,\r\n\t\t\t\t\ttitle: event?.sTime + ' - ' + event?.eTime,\r\n\t\t\t\t\tallDay: true,\r\n\t\t\t\t\tstart: new Date(event?.sDateTime),\r\n\t\t\t\t\tend: new Date(event?.eDateTime),\r\n\t\t\t\t\tsTime: event?.sTime,\r\n\t\t\t\t\teTime: event?.eTime,\r\n\t\t\t\t\tOpenDate: event?.OpenDate,\r\n\t\t\t\t\tresource: event\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\tconsole.log('_formatEvents: ', temp)\r\n\t\treturn temp\r\n\t}\r\n\r\n\tconst _reset = () => {\r\n\t\tsetTodoApi({ ...todoApiInit, pageIndex: 1 })\r\n\t}\r\n\r\n\tconst _filter = (paramFilter: any) => {\r\n\t\tlet newTodoApi = { ...todoApiInit, ...paramFilter }\r\n\t\tsetTodoApi(newTodoApi)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Card title={<FillterCalendar handleReset={_reset} data={options} handleFilter={(value: any) => _filter(value)} />}>\r\n\t\t\t{getTitlePage('Đăng ký lịch')}\r\n\t\t\t<CourseCalendar getData={getTeacherEvents} events={_formatEvents(calendarEvents)} courses={videoCourses} />\r\n\t\t</Card>\r\n\t)\r\n}\r\n\r\nCouCalen.layout = LayoutBase\r\nexport default CouCalen\r\n"]},"metadata":{},"sourceType":"module"}