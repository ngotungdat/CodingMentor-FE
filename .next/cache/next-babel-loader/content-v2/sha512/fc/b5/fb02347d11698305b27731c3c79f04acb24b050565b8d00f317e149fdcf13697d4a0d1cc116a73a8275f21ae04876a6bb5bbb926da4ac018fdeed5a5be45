{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\ManageZoom\\\\ZoomView\\\\ZoomView.tsx\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Spin } from 'antd';\nimport { signIn, useSession } from 'next-auth/client';\nimport Head from 'next/head';\nimport { useRouter } from 'next/router';\nimport React, { useEffect, useState } from 'react';\nimport { scheduleZoomApi } from '~/apiBase';\nimport { CalendarApi } from '~/apiBase/Calendar/calendar';\nimport { useWrap } from '~/context/wrap';\n\nfunction ZoomView() {\n  _s();\n\n  var router = useRouter();\n  var ScheduleID = router.query.slug;\n\n  var _useSession = useSession(),\n      _useSession2 = _slicedToArray(_useSession, 2),\n      session = _useSession2[0],\n      loading = _useSession2[1];\n\n  var path = router.pathname;\n\n  var _useState = useState(null),\n      dataZoom = _useState[0],\n      setDataZoom = _useState[1];\n\n  var _useWrap = useWrap(),\n      userInformation = _useWrap.userInformation,\n      showNoti = _useWrap.showNoti;\n\n  var fetchInfoRoomZoom = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _router$query, parseID, res, _router$query2, _res$data$data, ZoomID, ZoomPassword, Signature, ApiKey, _res$data$data2, ZoomRoomID, ZoomRoomPass, SignatureTeacher, SignatureStudent, _ApiKey;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n\n              if (userInformation) {\n                _context.next = 3;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 3:\n              parseID = parseInt(ScheduleID.toString());\n              _context.next = 6;\n              return !!((_router$query = router.query) !== null && _router$query !== void 0 && _router$query.isVideo) ? CalendarApi.joinRoom(parseID) : scheduleZoomApi.getById(parseID);\n\n            case 6:\n              res = _context.sent;\n\n              if (res.status === 200) {\n                if (!!((_router$query2 = router.query) !== null && _router$query2 !== void 0 && _router$query2.isVideo)) {\n                  _res$data$data = res.data.data, ZoomID = _res$data$data.ZoomID, ZoomPassword = _res$data$data.ZoomPassword, Signature = _res$data$data.Signature, ApiKey = _res$data$data.ApiKey;\n                  setDataZoom({\n                    apiKey: ApiKey,\n                    signature: Signature,\n                    meetingNumber: ZoomID,\n                    passWord: ZoomPassword,\n                    userName: userInformation.FullNameUnicode\n                  });\n                } else {\n                  _res$data$data2 = res.data.data, ZoomRoomID = _res$data$data2.ZoomRoomID, ZoomRoomPass = _res$data$data2.ZoomRoomPass, SignatureTeacher = _res$data$data2.SignatureTeacher, SignatureStudent = _res$data$data2.SignatureStudent, _ApiKey = _res$data$data2.ApiKey;\n                  setDataZoom({\n                    apiKey: _ApiKey,\n                    signature: SignatureTeacher && SignatureStudent ? (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) === 2 ? SignatureTeacher : SignatureStudent : '',\n                    meetingNumber: ZoomRoomID,\n                    passWord: ZoomRoomPass,\n                    userName: userInformation.FullNameUnicode\n                  });\n                }\n              }\n\n              _context.next = 14;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](0);\n              console.log('fetchInfoRoomZoom', _context.t0.message);\n              showNoti('danger', _context.t0 === null || _context.t0 === void 0 ? void 0 : _context.t0.message);\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 10]]);\n    }));\n\n    return function fetchInfoRoomZoom() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var _leave = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var parseID;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              parseID = parseInt(ScheduleID.toString());\n              _context2.next = 4;\n              return CalendarApi.exitRoom(parseID);\n\n            case 4:\n              _context2.next = 8;\n              break;\n\n            case 6:\n              _context2.prev = 6;\n              _context2.t0 = _context2[\"catch\"](0);\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 6]]);\n    }));\n\n    return function _leave() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    fetchInfoRoomZoom();\n  }, [userInformation]);\n  useEffect(function () {\n    if (typeof session !== 'undefined') {\n      if (session == null) {\n        if (path.search('signin') < 0) {\n          signIn();\n        }\n      }\n    }\n  }, [session]);\n\n  if (true) {\n    var cac = window.location.origin + '/course/calendar';\n  }\n\n  var initZoom = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var _document$getElementB;\n\n      var module, ZoomMtg, leaveUrl;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (dataZoom) {\n                _context3.next = 2;\n                break;\n              }\n\n              return _context3.abrupt(\"return\");\n\n            case 2:\n              _context3.next = 4;\n              return import('@zoomus/websdk');\n\n            case 4:\n              module = _context3.sent;\n              // DECLARE MODULE\n              ZoomMtg = module.ZoomMtg;\n              ZoomMtg.setZoomJSLib('https://source.zoom.us/2.2.0/lib', '/av');\n              ZoomMtg.preLoadWasm();\n              ZoomMtg.prepareWebSDK(); // SHOW LAYOUT ZOOM\n\n              (_document$getElementB = document.getElementById('zmmtg-root')) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.setAttribute('style', 'display:block;');\n              leaveUrl = 'http://localhost:3003/course/calendar/?ID=' + ScheduleID.toString();\n\n              if (true) {\n                leaveUrl = window.location.origin + '/course/calendar/?ID=' + ScheduleID.toString();\n              } // INIT MEETING\n\n\n              ZoomMtg.init({\n                leaveUrl: leaveUrl,\n                isSupportAV: true,\n                screenShare: true,\n                success: function success(_success) {\n                  // JOIN MEETING\n                  console.log('ZoomMtg.init - success:', _success);\n                  ZoomMtg.join(_objectSpread(_objectSpread({}, dataZoom), {}, {\n                    success: function success(_success2) {\n                      console.log('ZoomMtg.join - success: ', _success2);\n                    },\n                    error: function error(_error) {\n                      console.log('ZoomMtg.join - error: ', _error);\n                    }\n                  }));\n                },\n                error: function error(_error2) {\n                  console.log('ZoomMtg.init - error: ', _error2);\n                }\n              });\n\n            case 13:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function initZoom() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    initZoom();\n  }, [dataZoom]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"link\", {\n        type: \"text/css\",\n        rel: \"stylesheet\",\n        href: \"https://source.zoom.us/2.2.0/css/bootstrap.css\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"link\", {\n        type: \"text/css\",\n        rel: \"stylesheet\",\n        href: \"https://source.zoom.us/2.2.0/css/react-select.css\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"zoom-view\",\n      style: {\n        height: '100vh',\n        width: '100vw',\n        position: 'relative'\n      },\n      children: /*#__PURE__*/_jsxDEV(Spin, {\n        size: \"large\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n}\n\n_s(ZoomView, \"ZzjI0GdraZS/vx7ZHITiyp1o4H0=\", false, function () {\n  return [useRouter, useSession, useWrap];\n});\n\n_c = ZoomView;\nexport default ZoomView;\n\nvar _c;\n\n$RefreshReg$(_c, \"ZoomView\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/ManageZoom/ZoomView/ZoomView.tsx"],"names":["Spin","signIn","useSession","Head","useRouter","React","useEffect","useState","scheduleZoomApi","CalendarApi","useWrap","ZoomView","router","ScheduleID","query","slug","session","loading","path","pathname","dataZoom","setDataZoom","userInformation","showNoti","fetchInfoRoomZoom","parseID","parseInt","toString","isVideo","joinRoom","getById","res","status","data","ZoomID","ZoomPassword","Signature","ApiKey","apiKey","signature","meetingNumber","passWord","userName","FullNameUnicode","ZoomRoomID","ZoomRoomPass","SignatureTeacher","SignatureStudent","RoleID","console","log","message","_leave","exitRoom","search","cac","window","location","origin","initZoom","module","ZoomMtg","setZoomJSLib","preLoadWasm","prepareWebSDK","document","getElementById","setAttribute","leaveUrl","init","isSupportAV","screenShare","success","join","error","height","width","position"],"mappings":"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","sourcesContent":["import { Spin } from 'antd'\r\nimport { signIn, useSession } from 'next-auth/client'\r\nimport Head from 'next/head'\r\nimport { useRouter } from 'next/router'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { scheduleZoomApi } from '~/apiBase'\r\nimport { CalendarApi } from '~/apiBase/Calendar/calendar'\r\nimport { useWrap } from '~/context/wrap'\r\n\r\nfunction ZoomView() {\r\n\tconst router = useRouter()\r\n\tconst { slug: ScheduleID } = router.query\r\n\tconst [session, loading] = useSession()\r\n\tlet path: string = router.pathname\r\n\r\n\tconst [dataZoom, setDataZoom] = useState<{\r\n\t\tapiKey: string\r\n\t\tsignature: string\r\n\t\tmeetingNumber: string\r\n\t\tpassWord: string\r\n\t\tuserName: string\r\n\t}>(null)\r\n\r\n\tconst { userInformation, showNoti } = useWrap()\r\n\r\n\tconst fetchInfoRoomZoom = async () => {\r\n\t\ttry {\r\n\t\t\tif (!userInformation) return\r\n\t\t\tconst parseID = parseInt(ScheduleID.toString())\r\n\t\t\tconst res = await (!!router.query?.isVideo ? CalendarApi.joinRoom(parseID) : scheduleZoomApi.getById(parseID))\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tif (!!router.query?.isVideo) {\r\n\t\t\t\t\tconst { ZoomID, ZoomPassword, Signature, ApiKey } = res.data.data\r\n\t\t\t\t\tsetDataZoom({\r\n\t\t\t\t\t\tapiKey: ApiKey,\r\n\t\t\t\t\t\tsignature: Signature,\r\n\t\t\t\t\t\tmeetingNumber: ZoomID,\r\n\t\t\t\t\t\tpassWord: ZoomPassword,\r\n\t\t\t\t\t\tuserName: userInformation.FullNameUnicode\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst { ZoomRoomID, ZoomRoomPass, SignatureTeacher, SignatureStudent, ApiKey } = res.data.data\r\n\t\t\t\t\tsetDataZoom({\r\n\t\t\t\t\t\tapiKey: ApiKey,\r\n\t\t\t\t\t\tsignature: SignatureTeacher && SignatureStudent ? (userInformation?.RoleID === 2 ? SignatureTeacher : SignatureStudent) : '',\r\n\t\t\t\t\t\tmeetingNumber: ZoomRoomID,\r\n\t\t\t\t\t\tpassWord: ZoomRoomPass,\r\n\t\t\t\t\t\tuserName: userInformation.FullNameUnicode\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('fetchInfoRoomZoom', error.message)\r\n\t\t\tshowNoti('danger', error?.message)\r\n\t\t}\r\n\t}\r\n\r\n\tconst _leave = async () => {\r\n\t\ttry {\r\n\t\t\tconst parseID = parseInt(ScheduleID.toString())\r\n\t\t\tawait CalendarApi.exitRoom(parseID)\r\n\t\t} catch (error) {}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tfetchInfoRoomZoom()\r\n\t}, [userInformation])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (typeof session !== 'undefined') {\r\n\t\t\tif (session == null) {\r\n\t\t\t\tif (path.search('signin') < 0) {\r\n\t\t\t\t\tsignIn()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}, [session])\r\n\r\n\tif (typeof window !== 'undefined') {\r\n\t\tconst cac = window.location.origin + '/course/calendar'\r\n\t}\r\n\r\n\tconst initZoom = async () => {\r\n\t\tif (!dataZoom) return\r\n\r\n\t\tconst module = await import('@zoomus/websdk')\r\n\r\n\t\t// DECLARE MODULE\r\n\t\tconst { ZoomMtg } = module\r\n\r\n\t\tZoomMtg.setZoomJSLib('https://source.zoom.us/2.2.0/lib', '/av')\r\n\t\tZoomMtg.preLoadWasm()\r\n\t\tZoomMtg.prepareWebSDK()\r\n\r\n\t\t// SHOW LAYOUT ZOOM\r\n\t\tdocument.getElementById('zmmtg-root')?.setAttribute('style', 'display:block;')\r\n\t\tlet leaveUrl = 'http://localhost:3003/course/calendar/?ID=' + ScheduleID.toString()\r\n\t\tif (typeof window !== 'undefined') {\r\n\t\t\tleaveUrl = window.location.origin + '/course/calendar/?ID=' + ScheduleID.toString()\r\n\t\t}\r\n\t\t// INIT MEETING\r\n\t\tZoomMtg.init({\r\n\t\t\tleaveUrl,\r\n\t\t\tisSupportAV: true,\r\n\t\t\tscreenShare: true,\r\n\t\t\tsuccess: (success) => {\r\n\t\t\t\t// JOIN MEETING\r\n\t\t\t\tconsole.log('ZoomMtg.init - success:', success)\r\n\t\t\t\tZoomMtg.join({\r\n\t\t\t\t\t...dataZoom,\r\n\t\t\t\t\tsuccess: (success) => {\r\n\t\t\t\t\t\tconsole.log('ZoomMtg.join - success: ', success)\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: (error) => {\r\n\t\t\t\t\t\tconsole.log('ZoomMtg.join - error: ', error)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\terror: (error) => {\r\n\t\t\t\tconsole.log('ZoomMtg.init - error: ', error)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tinitZoom()\r\n\t}, [dataZoom])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Head>\r\n\t\t\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"https://source.zoom.us/2.2.0/css/bootstrap.css\" />\r\n\t\t\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"https://source.zoom.us/2.2.0/css/react-select.css\" />\r\n\t\t\t</Head>\r\n\t\t\t<div className=\"zoom-view\" style={{ height: '100vh', width: '100vw', position: 'relative' }}>\r\n\t\t\t\t<Spin size=\"large\" />\r\n\t\t\t</div>\r\n\t\t</>\r\n\t)\r\n}\r\nexport default ZoomView\r\n"]},"metadata":{},"sourceType":"module"}