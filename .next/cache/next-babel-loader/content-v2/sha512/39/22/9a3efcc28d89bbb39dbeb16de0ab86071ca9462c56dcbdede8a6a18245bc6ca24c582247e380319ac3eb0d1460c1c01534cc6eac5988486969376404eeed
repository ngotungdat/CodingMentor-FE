{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\CodingMentor\\\\CodingMentor-FE\\\\src\\\\components\\\\Global\\\\CourseList\\\\CourseListDetail\\\\RollUp\\\\RollUp.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Input, Select } from 'antd';\nimport Checkbox from 'antd/lib/checkbox/Checkbox';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport { rollUpApi } from '~/apiBase/course-detail/roll-up';\nimport PowerTable from '~/components/PowerTable';\nimport { useDebounce } from '~/context/useDebounce';\nimport { useWrap } from '~/context/wrap';\nRollUp.propTypes = {\n  courseID: PropTypes.number,\n  isReloadRollUp: PropTypes.bool\n};\n\nfunction RollUp(props) {\n  let today = new Date();\n  const {\n    courseID,\n    isReloadRollUp\n  } = props;\n  const {\n    showNoti,\n    userInformation\n  } = useWrap();\n  const {\n    0: selectedDate,\n    1: setSelectedDate\n  } = useState('');\n  const {\n    0: defaultSelect,\n    1: setDefaulSelect\n  } = useState(0);\n  const {\n    0: currentDate,\n    1: setCurrentDate\n  } = useState(moment(today).format('DD/MM/YYYY'));\n  const {\n    0: dataRollUp,\n    1: setDataRollUp\n  } = useState({\n    RollUp: [],\n    ScheduleList: [],\n    StudentList: []\n  });\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState({\n    type: 'GET_ALL',\n    status: false\n  });\n  const {\n    0: totalPage,\n    1: setTotalPage\n  } = useState(null);\n  const {\n    Option\n  } = Select;\n  const rollUpStatusOptionList = [{\n    value: 0,\n    title: '---Chọn trạng thái---'\n  }, {\n    title: 'Có mặt',\n    value: 1\n  }, {\n    title: 'Vắng có phép',\n    value: 2\n  }, {\n    title: 'Vắng không phép',\n    value: 3\n  }, {\n    title: 'Đi muộn',\n    value: 4\n  }, {\n    title: 'Về sớm',\n    value: 5\n  }, {\n    title: 'Nghỉ lễ',\n    value: 6\n  }];\n  const leaningStatusOptionList = [{\n    value: 0,\n    title: '---Chọn học lực---'\n  }, {\n    title: 'Giỏi',\n    value: 1\n  }, {\n    title: 'Khá',\n    value: 2\n  }, {\n    title: 'Trung bình',\n    value: 3\n  }, {\n    title: 'Kém',\n    value: 4\n  }, {\n    title: 'Theo dõi đặc biệt',\n    value: 5\n  }, {\n    title: 'Có cố gắng',\n    value: 6\n  }, {\n    title: 'Không cố gắng',\n    value: 7\n  }, {\n    title: 'Không nhận xét',\n    value: 8\n  }]; // FILTER\n\n  const {\n    0: filters,\n    1: setFilters\n  } = useState({\n    pageSize: 10,\n    pageIndex: 1,\n    CourseID: courseID,\n    CourseScheduleID: 0,\n    StudentID: 0\n  });\n\n  const getPagination = pageNumber => {\n    setFilters(_objectSpread(_objectSpread({}, filters), {}, {\n      pageIndex: pageNumber\n    }));\n  };\n\n  const onSelectCourseSchedule = CourseScheduleID => {\n    dataRollUp.ScheduleList.forEach(item => {\n      if (item.value === CourseScheduleID) {\n        setSelectedDate(item.date);\n      }\n    });\n    setFilters(_objectSpread(_objectSpread({}, filters), {}, {\n      CourseScheduleID\n    }));\n  };\n\n  useEffect(() => {\n    if (isReloadRollUp) {\n      onSelectCourseSchedule(0);\n      setDefaulSelect(0);\n    }\n  }, [isReloadRollUp]);\n\n  const onChangeValue = async (key, vl, idx) => {\n    try {\n      const newStudentList = [...dataRollUp.StudentList];\n\n      const student = _objectSpread(_objectSpread({}, newStudentList[idx]), {}, {\n        [key]: vl\n      });\n\n      let dataChange = {\n        BranchID: dataRollUp.ScheduleList[1].options.BranchID,\n        CourseID: filters.CourseID,\n        CourseScheduleID: filters.CourseScheduleID,\n        StudentID: student.StudentID,\n        StatusID: student.StatusID,\n        LearningStatusID: student.LearningStatusID,\n        Note: student.Note,\n        Warning: student.Warning,\n        [key]: vl\n      };\n      let res = await rollUpApi.update([dataChange]);\n\n      if (res.status === 200) {\n        newStudentList.splice(idx, 1, student);\n        setDataRollUp(_objectSpread(_objectSpread({}, dataRollUp), {}, {\n          StudentList: newStudentList\n        }));\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    }\n  };\n\n  const debounceOnChangeValue = useDebounce(onChangeValue, 500, []);\n  useEffect(() => {\n    console.log('dataRollUp: ', dataRollUp);\n  }, [dataRollUp]);\n\n  const getRollUpList = async () => {\n    try {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: true\n      });\n      const res = await rollUpApi.getAll(_objectSpread(_objectSpread({}, filters), {}, {\n        StudentID: userInformation !== null && userInformation.RoleID == 3 ? userInformation === null || userInformation === void 0 ? void 0 : userInformation.UserInformationID : 0\n      }));\n\n      if (res.status === 200 && userInformation.RoleID == 3) {\n        var _res$data;\n\n        setDataRollUp(_objectSpread(_objectSpread({}, dataRollUp), {}, {\n          StudentList: res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.data\n        }));\n      }\n\n      if (res.status === 200 && userInformation.RoleID !== 3) {\n        const {\n          RollUp,\n          ScheduleList,\n          StudentList,\n          TotalRow\n        } = res.data;\n        const fmScheduleList = ScheduleList.map((item, index) => {\n          const date = moment(item.StartTime).format('DD/MM/YYYY');\n          const startTime = moment(item.StartTime).format('HH:mm');\n          const endTime = moment(item.EndTime).format('HH:mm');\n          return {\n            value: item.ID,\n            title: `${item.RoomName ? `[${item.RoomName}]` : ''}[${date}] ${startTime} - ${endTime}`,\n            date: date,\n            options: {\n              BranchID: item.BranchID\n            }\n          };\n        });\n        const fmStudentList = StudentList.map(s => {\n          const studentRollUp = RollUp.find(r => r.StudentID === s.StudentID);\n          const moreInfo = {\n            RollUpID: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.ID) || 0,\n            BranchID: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.BranchID) || 0,\n            CourseScheduleID: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.CourseScheduleID) || 0,\n            Note: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.Note) || '',\n            StatusID: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.StatusID) || 0,\n            StatusName: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.StatusName) || '',\n            LearningStatusID: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.LearningStatusID) || 0,\n            LearningStatusName: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.LearningStatusName) || ''\n          };\n          return _objectSpread(_objectSpread({}, s), moreInfo);\n        });\n        setDataRollUp({\n          RollUp,\n          ScheduleList: [{\n            value: 0,\n            title: '---Chọn ca học---',\n            date: ''\n          }, ...fmScheduleList],\n          StudentList: filters.CourseScheduleID ? fmStudentList : []\n        });\n        setTotalPage(TotalRow);\n      }\n\n      if (res.status === 204) {\n        showNoti('danger', 'Không tìm thấy');\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: false\n      });\n    }\n  };\n\n  useEffect(() => {\n    getRollUpList();\n  }, [filters]);\n  const columns = [{\n    title: 'Học viên',\n    dataIndex: 'StudentName',\n    render: text => /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-weight-primary\",\n      children: text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 22\n    }, this)\n  }, {\n    title: 'Điểm danh',\n    dataIndex: 'StatusID',\n    render: (status, item, idx) => {\n      return /*#__PURE__*/_jsxDEV(Select, {\n        style: {\n          width: 200\n        },\n        value: status,\n        className: \"style-input\",\n        onChange: vl => debounceOnChangeValue('StatusID', vl, idx),\n        disabled: (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) === 2 && currentDate !== selectedDate,\n        children: rollUpStatusOptionList.map((o, idx) => /*#__PURE__*/_jsxDEV(Option, {\n          value: o.value,\n          children: o.title\n        }, idx, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 8\n        }, this))\n      }, item.RollUpID, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 6\n      }, this);\n    }\n  }, {\n    title: 'Học lực',\n    dataIndex: 'LearningStatusID',\n    render: (status, item, idx) => {\n      return /*#__PURE__*/_jsxDEV(Select, {\n        style: {\n          width: 200\n        },\n        value: status,\n        className: \"style-input\",\n        onChange: vl => debounceOnChangeValue('LearningStatusID', vl, idx),\n        disabled: (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) === 2 && currentDate !== selectedDate,\n        children: leaningStatusOptionList.map((o, idx) => /*#__PURE__*/_jsxDEV(Option, {\n          value: o.value,\n          children: o.title\n        }, idx, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 8\n        }, this))\n      }, item.RollUpID, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 6\n      }, this);\n    }\n  }, {\n    title: 'Đánh giá',\n    dataIndex: 'Note',\n    render: (note, item, idx) => {\n      return /*#__PURE__*/_jsxDEV(Input, {\n        defaultValue: note,\n        style: {\n          width: 200\n        },\n        placeholder: \"Nh\\u1EADp \\u0111\\xE1nh gi\\xE1\",\n        className: \"style-input\",\n        allowClear: true,\n        disabled: (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) === 2 && currentDate !== selectedDate,\n        onChange: e => debounceOnChangeValue('Note', e.target.value, idx)\n      }, item.RollUpID, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 6\n      }, this);\n    }\n  }, {\n    width: 120,\n    title: 'Cảnh cáo',\n    dataIndex: 'Warning',\n    align: 'center',\n    render: (warning, item, idx) => {\n      return /*#__PURE__*/_jsxDEV(Checkbox, {\n        disabled: warning || (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) === 2 && currentDate !== selectedDate,\n        checked: warning,\n        onChange: e => debounceOnChangeValue('Warning', e.target.checked, idx)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 6\n      }, this);\n    }\n  }];\n  const columnsStudent = [{\n    title: 'Môn học',\n    dataIndex: 'SubjectName',\n    render: text => /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"\",\n      children: text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 22\n    }, this)\n  }, {\n    title: 'Buổi học',\n    dataIndex: 'Date',\n    width: 250,\n    render: (Date, item, idx) => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: Date\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 12\n      }, this);\n    }\n  }, {\n    title: 'Điểm danh',\n    dataIndex: 'StatusID',\n    render: (status, item, idx) => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: item === null || item === void 0 ? void 0 : item.StatusName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 12\n      }, this);\n    }\n  }, {\n    title: 'Đánh giá',\n    dataIndex: 'Note',\n    width: 400,\n    render: text => /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"\",\n      children: text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 22\n    }, this)\n  }, {\n    width: 120,\n    title: 'Cảnh cáo',\n    dataIndex: 'Warning',\n    align: 'center',\n    render: (warning, item, idx) => {\n      return /*#__PURE__*/_jsxDEV(Checkbox, {\n        disabled: warning || (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) === 2 && currentDate !== selectedDate,\n        checked: warning\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 12\n      }, this);\n    }\n  }];\n  return /*#__PURE__*/_jsxDEV(PowerTable, {\n    loading: isLoading,\n    currentPage: filters.pageIndex,\n    totalPage: totalPage,\n    getPagination: getPagination,\n    dataSource: dataRollUp.StudentList,\n    columns: userInformation.RoleID == 3 ? columnsStudent : columns,\n    TitleCard: userInformation !== null && userInformation.RoleID !== 3 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex align-items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"\",\n        children: /*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"Ca h\\u1ECDc:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 8\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Select, {\n          defaultValue: 0,\n          style: {\n            width: 280,\n            paddingLeft: 20,\n            marginBottom: 0\n          },\n          className: \"style-input\",\n          onChange: onSelectCourseSchedule,\n          value: defaultSelect,\n          children: dataRollUp.ScheduleList.map((o, idx) => /*#__PURE__*/_jsxDEV(Option, {\n            value: o.value,\n            children: o.title\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 10\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 8\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 6\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 337,\n    columnNumber: 3\n  }, this);\n}\n\nexport default RollUp;","map":{"version":3,"sources":["D:/MonaMedia/Project/CodingMentor/CodingMentor-FE/src/components/Global/CourseList/CourseListDetail/RollUp/RollUp.tsx"],"names":["Input","Select","Checkbox","moment","PropTypes","React","useEffect","useState","rollUpApi","PowerTable","useDebounce","useWrap","RollUp","propTypes","courseID","number","isReloadRollUp","bool","props","today","Date","showNoti","userInformation","selectedDate","setSelectedDate","defaultSelect","setDefaulSelect","currentDate","setCurrentDate","format","dataRollUp","setDataRollUp","ScheduleList","StudentList","isLoading","setIsLoading","type","status","totalPage","setTotalPage","Option","rollUpStatusOptionList","value","title","leaningStatusOptionList","filters","setFilters","pageSize","pageIndex","CourseID","CourseScheduleID","StudentID","getPagination","pageNumber","onSelectCourseSchedule","forEach","item","date","onChangeValue","key","vl","idx","newStudentList","student","dataChange","BranchID","options","StatusID","LearningStatusID","Note","Warning","res","update","splice","error","message","debounceOnChangeValue","console","log","getRollUpList","getAll","RoleID","UserInformationID","data","TotalRow","fmScheduleList","map","index","StartTime","startTime","endTime","EndTime","ID","RoomName","fmStudentList","s","studentRollUp","find","r","moreInfo","RollUpID","StatusName","LearningStatusName","columns","dataIndex","render","text","width","o","note","e","target","align","warning","checked","columnsStudent","paddingLeft","marginBottom"],"mappings":"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","sourcesContent":["import { Input, Select } from 'antd'\r\nimport Checkbox from 'antd/lib/checkbox/Checkbox'\r\nimport moment from 'moment'\r\nimport PropTypes from 'prop-types'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { rollUpApi } from '~/apiBase/course-detail/roll-up'\r\nimport PowerTable from '~/components/PowerTable'\r\nimport { useDebounce } from '~/context/useDebounce'\r\nimport { useWrap } from '~/context/wrap'\r\n\r\nRollUp.propTypes = {\r\n\tcourseID: PropTypes.number,\r\n\tisReloadRollUp: PropTypes.bool\r\n}\r\ninterface IStudentRollUp {\r\n\tID: number\r\n\tCourseID: number\r\n\tStudentID: number\r\n\tStudentName: string\r\n\tMobile: string\r\n\tEmail: string\r\n\tAcademicName: string\r\n\tDayOff: number\r\n\tWarning: boolean\r\n\tRollUpID: number\r\n\tBranchID: number\r\n\tCourseScheduleID: number\r\n\tNote: string\r\n\tStatusID: number\r\n\tStatusName: string\r\n\tLearningStatusID: number\r\n\tLearningStatusName: string\r\n}\r\ntype TypeDataRollUp = {\r\n\tRollUp: IRollUp[]\r\n\tScheduleList: IOptionCommon[]\r\n\tStudentList: any\r\n}\r\nfunction RollUp(props) {\r\n\tlet today = new Date()\r\n\tconst { courseID, isReloadRollUp } = props\r\n\tconst { showNoti, userInformation } = useWrap()\r\n\tconst [selectedDate, setSelectedDate] = useState('')\r\n\tconst [defaultSelect, setDefaulSelect] = useState(0)\r\n\tconst [currentDate, setCurrentDate] = useState(moment(today).format('DD/MM/YYYY'))\r\n\tconst [dataRollUp, setDataRollUp] = useState<TypeDataRollUp>({\r\n\t\tRollUp: [],\r\n\t\tScheduleList: [],\r\n\t\tStudentList: []\r\n\t})\r\n\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: 'GET_ALL',\r\n\t\tstatus: false\r\n\t})\r\n\tconst [totalPage, setTotalPage] = useState(null)\r\n\tconst { Option } = Select\r\n\tconst rollUpStatusOptionList = [\r\n\t\t{ value: 0, title: '---Chọn trạng thái---' },\r\n\t\t{ title: 'Có mặt', value: 1 },\r\n\t\t{ title: 'Vắng có phép', value: 2 },\r\n\t\t{ title: 'Vắng không phép', value: 3 },\r\n\t\t{ title: 'Đi muộn', value: 4 },\r\n\t\t{ title: 'Về sớm', value: 5 },\r\n\t\t{ title: 'Nghỉ lễ', value: 6 }\r\n\t]\r\n\tconst leaningStatusOptionList = [\r\n\t\t{ value: 0, title: '---Chọn học lực---' },\r\n\t\t{ title: 'Giỏi', value: 1 },\r\n\t\t{ title: 'Khá', value: 2 },\r\n\t\t{ title: 'Trung bình', value: 3 },\r\n\t\t{ title: 'Kém', value: 4 },\r\n\t\t{ title: 'Theo dõi đặc biệt', value: 5 },\r\n\t\t{ title: 'Có cố gắng', value: 6 },\r\n\t\t{ title: 'Không cố gắng', value: 7 },\r\n\t\t{ title: 'Không nhận xét', value: 8 }\r\n\t]\r\n\t// FILTER\r\n\tconst [filters, setFilters] = useState({\r\n\t\tpageSize: 10,\r\n\t\tpageIndex: 1,\r\n\t\tCourseID: courseID,\r\n\t\tCourseScheduleID: 0,\r\n\t\tStudentID: 0\r\n\t})\r\n\tconst getPagination = (pageNumber: number) => {\r\n\t\tsetFilters({\r\n\t\t\t...filters,\r\n\t\t\tpageIndex: pageNumber\r\n\t\t})\r\n\t}\r\n\tconst onSelectCourseSchedule = (CourseScheduleID: number) => {\r\n\t\tdataRollUp.ScheduleList.forEach((item) => {\r\n\t\t\tif (item.value === CourseScheduleID) {\r\n\t\t\t\tsetSelectedDate(item.date)\r\n\t\t\t}\r\n\t\t})\r\n\t\tsetFilters({\r\n\t\t\t...filters,\r\n\t\t\tCourseScheduleID\r\n\t\t})\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isReloadRollUp) {\r\n\t\t\tonSelectCourseSchedule(0)\r\n\t\t\tsetDefaulSelect(0)\r\n\t\t}\r\n\t}, [isReloadRollUp])\r\n\r\n\tconst onChangeValue = async (key: string, vl: number | string | boolean, idx: number) => {\r\n\t\ttry {\r\n\t\t\tconst newStudentList = [...dataRollUp.StudentList]\r\n\t\t\tconst student: IStudentRollUp = {\r\n\t\t\t\t...newStudentList[idx],\r\n\t\t\t\t[key]: vl\r\n\t\t\t}\r\n\t\t\tlet dataChange = {\r\n\t\t\t\tBranchID: dataRollUp.ScheduleList[1].options.BranchID,\r\n\t\t\t\tCourseID: filters.CourseID,\r\n\t\t\t\tCourseScheduleID: filters.CourseScheduleID,\r\n\t\t\t\tStudentID: student.StudentID,\r\n\t\t\t\tStatusID: student.StatusID,\r\n\t\t\t\tLearningStatusID: student.LearningStatusID,\r\n\t\t\t\tNote: student.Note,\r\n\t\t\t\tWarning: student.Warning,\r\n\t\t\t\t[key]: vl\r\n\t\t\t}\r\n\t\t\tlet res = await rollUpApi.update([dataChange])\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tnewStudentList.splice(idx, 1, student)\r\n\t\t\t\tsetDataRollUp({ ...dataRollUp, StudentList: newStudentList })\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t}\r\n\t}\r\n\r\n\tconst debounceOnChangeValue = useDebounce(onChangeValue, 500, [])\r\n\r\n\tuseEffect(() => {\r\n\t\tconsole.log('dataRollUp: ', dataRollUp)\r\n\t}, [dataRollUp])\r\n\r\n\tconst getRollUpList = async () => {\r\n\t\ttry {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: true\r\n\t\t\t})\r\n\t\t\tconst res: any = await rollUpApi.getAll({\r\n\t\t\t\t...filters,\r\n\t\t\t\tStudentID: userInformation !== null && userInformation.RoleID == 3 ? userInformation?.UserInformationID : 0\r\n\t\t\t})\r\n\t\t\tif (res.status === 200 && userInformation.RoleID == 3) {\r\n\t\t\t\tsetDataRollUp({ ...dataRollUp, StudentList: res?.data?.data })\r\n\t\t\t}\r\n\t\t\tif (res.status === 200 && userInformation.RoleID !== 3) {\r\n\t\t\t\tconst { RollUp, ScheduleList, StudentList, TotalRow } = res.data\r\n\t\t\t\tconst fmScheduleList = ScheduleList.map((item, index) => {\r\n\t\t\t\t\tconst date = moment(item.StartTime).format('DD/MM/YYYY')\r\n\t\t\t\t\tconst startTime = moment(item.StartTime).format('HH:mm')\r\n\t\t\t\t\tconst endTime = moment(item.EndTime).format('HH:mm')\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tvalue: item.ID,\r\n\t\t\t\t\t\ttitle: `${item.RoomName ? `[${item.RoomName}]` : ''}[${date}] ${startTime} - ${endTime}`,\r\n\t\t\t\t\t\tdate: date,\r\n\t\t\t\t\t\toptions: {\r\n\t\t\t\t\t\t\tBranchID: item.BranchID\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tconst fmStudentList = StudentList.map((s) => {\r\n\t\t\t\t\tconst studentRollUp = RollUp.find((r) => r.StudentID === s.StudentID)\r\n\t\t\t\t\tconst moreInfo = {\r\n\t\t\t\t\t\tRollUpID: studentRollUp?.ID || 0,\r\n\t\t\t\t\t\tBranchID: studentRollUp?.BranchID || 0,\r\n\t\t\t\t\t\tCourseScheduleID: studentRollUp?.CourseScheduleID || 0,\r\n\t\t\t\t\t\tNote: studentRollUp?.Note || '',\r\n\t\t\t\t\t\tStatusID: studentRollUp?.StatusID || 0,\r\n\t\t\t\t\t\tStatusName: studentRollUp?.StatusName || '',\r\n\t\t\t\t\t\tLearningStatusID: studentRollUp?.LearningStatusID || 0,\r\n\t\t\t\t\t\tLearningStatusName: studentRollUp?.LearningStatusName || ''\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...s,\r\n\t\t\t\t\t\t...moreInfo\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tsetDataRollUp({\r\n\t\t\t\t\tRollUp,\r\n\t\t\t\t\tScheduleList: [{ value: 0, title: '---Chọn ca học---', date: '' }, ...fmScheduleList],\r\n\t\t\t\t\tStudentList: filters.CourseScheduleID ? fmStudentList : []\r\n\t\t\t\t})\r\n\t\t\t\tsetTotalPage(TotalRow)\r\n\t\t\t}\r\n\t\t\tif (res.status === 204) {\r\n\t\t\t\tshowNoti('danger', 'Không tìm thấy')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tuseEffect(() => {\r\n\t\tgetRollUpList()\r\n\t}, [filters])\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Học viên',\r\n\t\t\tdataIndex: 'StudentName',\r\n\t\t\trender: (text) => <p className=\"font-weight-primary\">{text}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Điểm danh',\r\n\t\t\tdataIndex: 'StatusID',\r\n\t\t\trender: (status: number, item: IStudentRollUp, idx: number) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Select\r\n\t\t\t\t\t\tkey={item.RollUpID}\r\n\t\t\t\t\t\tstyle={{ width: 200 }}\r\n\t\t\t\t\t\tvalue={status}\r\n\t\t\t\t\t\tclassName=\"style-input\"\r\n\t\t\t\t\t\tonChange={(vl) => debounceOnChangeValue('StatusID', vl, idx)}\r\n\t\t\t\t\t\tdisabled={userInformation?.RoleID === 2 && currentDate !== selectedDate}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{rollUpStatusOptionList.map((o, idx) => (\r\n\t\t\t\t\t\t\t<Option key={idx} value={o.value}>\r\n\t\t\t\t\t\t\t\t{o.title}\r\n\t\t\t\t\t\t\t</Option>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</Select>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Học lực',\r\n\t\t\tdataIndex: 'LearningStatusID',\r\n\t\t\trender: (status: number, item: IStudentRollUp, idx) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Select\r\n\t\t\t\t\t\tkey={item.RollUpID}\r\n\t\t\t\t\t\tstyle={{ width: 200 }}\r\n\t\t\t\t\t\tvalue={status}\r\n\t\t\t\t\t\tclassName=\"style-input\"\r\n\t\t\t\t\t\tonChange={(vl) => debounceOnChangeValue('LearningStatusID', vl, idx)}\r\n\t\t\t\t\t\tdisabled={userInformation?.RoleID === 2 && currentDate !== selectedDate}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{leaningStatusOptionList.map((o, idx) => (\r\n\t\t\t\t\t\t\t<Option key={idx} value={o.value}>\r\n\t\t\t\t\t\t\t\t{o.title}\r\n\t\t\t\t\t\t\t</Option>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</Select>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Đánh giá',\r\n\t\t\tdataIndex: 'Note',\r\n\t\t\trender: (note: string, item: IStudentRollUp, idx) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\tkey={item.RollUpID}\r\n\t\t\t\t\t\tdefaultValue={note}\r\n\t\t\t\t\t\tstyle={{ width: 200 }}\r\n\t\t\t\t\t\tplaceholder=\"Nhập đánh giá\"\r\n\t\t\t\t\t\tclassName=\"style-input\"\r\n\t\t\t\t\t\tallowClear={true}\r\n\t\t\t\t\t\tdisabled={userInformation?.RoleID === 2 && currentDate !== selectedDate}\r\n\t\t\t\t\t\tonChange={(e) => debounceOnChangeValue('Note', e.target.value, idx)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\twidth: 120,\r\n\t\t\ttitle: 'Cảnh cáo',\r\n\t\t\tdataIndex: 'Warning',\r\n\t\t\talign: 'center',\r\n\t\t\trender: (warning, item: IStudentRollUp, idx) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Checkbox\r\n\t\t\t\t\t\tdisabled={warning || (userInformation?.RoleID === 2 && currentDate !== selectedDate)}\r\n\t\t\t\t\t\tchecked={warning}\r\n\t\t\t\t\t\tonChange={(e) => debounceOnChangeValue('Warning', e.target.checked, idx)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n\r\n\tconst columnsStudent = [\r\n\t\t{\r\n\t\t\ttitle: 'Môn học',\r\n\t\t\tdataIndex: 'SubjectName',\r\n\t\t\trender: (text) => <p className=\"\">{text}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Buổi học',\r\n\t\t\tdataIndex: 'Date',\r\n\t\t\twidth: 250,\r\n\t\t\trender: (Date: any, item: any, idx: number) => {\r\n\t\t\t\treturn <div>{Date}</div>\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Điểm danh',\r\n\t\t\tdataIndex: 'StatusID',\r\n\t\t\trender: (status: any, item: any, idx: number) => {\r\n\t\t\t\treturn <div>{item?.StatusName}</div>\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Đánh giá',\r\n\t\t\tdataIndex: 'Note',\r\n\t\t\twidth: 400,\r\n\t\t\trender: (text) => <p className=\"\">{text}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\twidth: 120,\r\n\t\t\ttitle: 'Cảnh cáo',\r\n\t\t\tdataIndex: 'Warning',\r\n\t\t\talign: 'center',\r\n\t\t\trender: (warning, item: IStudentRollUp, idx) => {\r\n\t\t\t\treturn <Checkbox disabled={warning || (userInformation?.RoleID === 2 && currentDate !== selectedDate)} checked={warning} />\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n\r\n\treturn (\r\n\t\t<PowerTable\r\n\t\t\tloading={isLoading}\r\n\t\t\tcurrentPage={filters.pageIndex}\r\n\t\t\ttotalPage={totalPage}\r\n\t\t\tgetPagination={getPagination}\r\n\t\t\tdataSource={dataRollUp.StudentList}\r\n\t\t\tcolumns={userInformation.RoleID == 3 ? columnsStudent : columns}\r\n\t\t\tTitleCard={\r\n\t\t\t\tuserInformation !== null &&\r\n\t\t\t\tuserInformation.RoleID !== 3 && (\r\n\t\t\t\t\t<div className=\"d-flex align-items-center\">\r\n\t\t\t\t\t\t<div className=\"\">\r\n\t\t\t\t\t\t\t<b>Ca học:</b>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\tdefaultValue={0}\r\n\t\t\t\t\t\t\t\tstyle={{ width: 280, paddingLeft: 20, marginBottom: 0 }}\r\n\t\t\t\t\t\t\t\tclassName=\"style-input\"\r\n\t\t\t\t\t\t\t\tonChange={onSelectCourseSchedule}\r\n\t\t\t\t\t\t\t\tvalue={defaultSelect}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{dataRollUp.ScheduleList.map((o, idx) => (\r\n\t\t\t\t\t\t\t\t\t<Option key={idx} value={o.value}>\r\n\t\t\t\t\t\t\t\t\t\t{o.title}\r\n\t\t\t\t\t\t\t\t\t</Option>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t/>\r\n\t)\r\n}\r\nexport default RollUp\r\n"]},"metadata":{},"sourceType":"module"}