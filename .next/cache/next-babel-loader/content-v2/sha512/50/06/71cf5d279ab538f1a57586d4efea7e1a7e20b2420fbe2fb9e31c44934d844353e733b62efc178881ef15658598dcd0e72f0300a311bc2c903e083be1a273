{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\CodingMentor\\\\CodingMentor-FE\\\\src\\\\components\\\\CourseCalendar\\\\modal-create-event.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Modal, Select, Spin, TimePicker } from 'antd';\nimport moment from 'moment';\nimport React, { useState, useEffect } from 'react';\nimport 'react-big-calendar/lib/css/react-big-calendar.css';\nimport { useWrap } from '~/context/wrap';\nimport { CalendarApi } from '~/apiBase/Calendar/calendar';\nconst {\n  Option\n} = Select;\nmoment.locale('vi');\n\nconst ModalCreateEvent = props => {\n  const {\n    visible,\n    setVisible,\n    date,\n    courses,\n    getData,\n    event,\n    teacherChangeData\n  } = props;\n  const {\n    showNoti,\n    userInformation\n  } = useWrap();\n  console.log('date: ', date);\n  const {\n    0: selected,\n    1: setSelected\n  } = useState({});\n  const {\n    0: startTime,\n    1: setStartTime\n  } = useState('');\n  const {\n    0: endTime,\n    1: setEndTime\n  } = useState('');\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(true);\n  const {\n    0: errorText,\n    1: setErrorText\n  } = useState('');\n  useEffect(() => {\n    !visible && setSelected({}), setStartTime(''), setEndTime('');\n  }, [visible]);\n\n  const onChange = value => {\n    let indexSelected = courses.findIndex(e => (e === null || e === void 0 ? void 0 : e.VideoCourseID) == value);\n    setSelected(courses[indexSelected]);\n    return null;\n  };\n\n  useEffect(() => {\n    if (visible && !!(event !== null && event !== void 0 && event.id)) {\n      getDataDetails();\n    } else {\n      setLoading(false);\n    }\n  }, [visible]);\n  const {\n    0: details,\n    1: setDetails\n  } = useState('');\n\n  const getDataDetails = async () => {\n    try {\n      const res = await CalendarApi.getByID(event === null || event === void 0 ? void 0 : event.id);\n\n      if (res.status == 200) {\n        var _res$data$data;\n\n        setDetails(res.data.data);\n        setStartTime((_res$data$data = res.data.data) === null || _res$data$data === void 0 ? void 0 : _res$data$data.sTime);\n        let index = courses.findIndex(e => {\n          var _res$data$data2;\n\n          return e.VideoCourseID == ((_res$data$data2 = res.data.data) === null || _res$data$data2 === void 0 ? void 0 : _res$data$data2.VideoCourseID);\n        });\n        index !== -1 && setSelected(courses[index]);\n      }\n    } catch (error) {\n      showNoti('danger', error === null || error === void 0 ? void 0 : error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (!!startTime) {\n      const tempMoment = moment(startTime, 'HH:mm');\n      const temp = new Date(startTime);\n      const timestamp = Math.floor(!!temp && temp != 'Invalid date' && temp != 'Invalid Date' ? temp / 1000 : tempMoment / 1000);\n      var tempDate = new Date((timestamp + parseInt(selected === null || selected === void 0 ? void 0 : selected.LimitMinutes) * 60) * 1000);\n      setEndTime(tempDate);\n    }\n  }, [startTime, selected]);\n  useEffect(() => {\n    setErrorText('');\n  }, [selected, startTime]);\n\n  const _createEvent = async () => {\n    setLoading(true);\n\n    if (!(selected !== null && selected !== void 0 && selected.VideoCourseID)) {\n      setErrorText('Vui lòng chọn khóa học');\n    } else {\n      if (!startTime) {\n        setErrorText('Vui lòng chọn ngày bắt đầu');\n      } else {\n        let sTemp = moment(startTime).format('HH:mm');\n        let oDate = moment(date === null || date === void 0 ? void 0 : date.start).format('YYYY/MM/DD');\n        let temp = {\n          VideoCourseID: selected === null || selected === void 0 ? void 0 : selected.VideoCourseID,\n          OpenDate: !!oDate && oDate != 'Invalid date' && oDate != 'Invalid Date' ? oDate : moment(details === null || details === void 0 ? void 0 : details.OpenDate).format('YYYY/MM/DD'),\n          sTime: !!sTemp && sTemp != 'Invalid date' && sTemp != 'Invalid Date' ? sTemp : startTime,\n          eTime: moment(endTime).format('HH:mm')\n        };\n\n        try {\n          const res = await (!(event !== null && event !== void 0 && event.start) ? CalendarApi.add(temp) : CalendarApi.update(_objectSpread(_objectSpread({}, temp), {}, {\n            ID: event === null || event === void 0 ? void 0 : event.id,\n            Status: details === null || details === void 0 ? void 0 : details.Status\n          })));\n\n          if (res.status == 200 || res.status == 204) {\n            showNoti('success', 'Thành công');\n            getData();\n            setVisible(false);\n            teacherChangeData({\n              Teacher: userInformation.UserInformationID\n            });\n          }\n        } catch (error) {\n          showNoti('danger', error === null || error === void 0 ? void 0 : error.message);\n        } finally {\n          setLoading(false);\n        }\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Modal, {\n      className: \"wrap-calendar-x\",\n      title: !(event !== null && event !== void 0 && event.start) ? 'Thêm lịch ngày: ' + moment(date === null || date === void 0 ? void 0 : date.start).format('DD-MM-YYYY') : 'Sửa lịch ngày: ' + moment(event === null || event === void 0 ? void 0 : event.start).format('DD-MM-YYYY'),\n      visible: visible,\n      onCancel: () => setVisible(false),\n      onOk: () => _createEvent(),\n      cancelText: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"\",\n        children: \"Hu\\u1EF7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }, this),\n      okText: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"btn-primary save\",\n        children: [\"L\\u01B0u l\\u1EA1i \", loading && /*#__PURE__*/_jsxDEV(Spin, {\n          className: \"ml-2\",\n          size: \"small\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 67\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 13\n      }, this),\n      centered: true,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-12 col-12\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-2\",\n          children: [\"Ch\\u1ECDn kh\\xF3a h\\u1ECDc \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: 'red'\n            },\n            children: \" *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          disabled: loading,\n          className: \"w-100\",\n          showSearch: true,\n          value: (selected === null || selected === void 0 ? void 0 : selected.VideoCourseID) || null,\n          placeholder: \"Ch\\u1ECDn kh\\xF3a h\\u1ECDc\",\n          optionFilterProp: \"children\",\n          onChange: onChange,\n          filterOption: (input, option) => option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0,\n          children: !!courses && courses.map(item => /*#__PURE__*/_jsxDEV(Option, {\n            value: item === null || item === void 0 ? void 0 : item.VideoCourseID,\n            children: item === null || item === void 0 ? void 0 : item.VideoCourseName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 48\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row col-12 m-0 p-0\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-6 col-12\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-2 mt-4\",\n            children: [\"Ch\\u1ECDn gi\\u1EDD b\\u1EAFt \\u0111\\u1EA7u \", /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: 'red'\n              },\n              children: \" *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(TimePicker, {\n            disabled: loading,\n            value: !!startTime ? moment(startTime, 'HH:mm') : null,\n            onChange: e => setStartTime(e === null || e === void 0 ? void 0 : e._d),\n            className: \"ant-input\",\n            placeholder: \"B\\u1EAFt \\u0111\\u1EA7u\",\n            format: 'HH:mm'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-6 col-12\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-2 mt-4\",\n            children: \"Gi\\u1EDD k\\u1EBFt th\\xFAc\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(TimePicker, {\n            value: !!endTime && endTime != 'Invalid Date' ? moment(endTime, 'HH:mm') : null,\n            disabled: true,\n            className: \"ant-input\",\n            placeholder: \"H\\xE3y ch\\u1ECDn gi\\u1EDD b\\u1EAFt \\u0111\\u1EA7u\",\n            format: 'HH:mm'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 5\n      }, this), !!errorText && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-6 col-12 mt-3\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: 'red'\n          },\n          children: errorText\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 3\n  }, this);\n};\n\nexport default ModalCreateEvent;","map":{"version":3,"sources":["D:/MonaMedia/Project/CodingMentor/CodingMentor-FE/src/components/CourseCalendar/modal-create-event.tsx"],"names":["Modal","Select","Spin","TimePicker","moment","React","useState","useEffect","useWrap","CalendarApi","Option","locale","ModalCreateEvent","props","visible","setVisible","date","courses","getData","event","teacherChangeData","showNoti","userInformation","console","log","selected","setSelected","startTime","setStartTime","endTime","setEndTime","loading","setLoading","errorText","setErrorText","onChange","value","indexSelected","findIndex","e","VideoCourseID","id","getDataDetails","details","setDetails","res","getByID","status","data","sTime","index","error","message","tempMoment","temp","Date","timestamp","Math","floor","tempDate","parseInt","LimitMinutes","_createEvent","sTemp","format","oDate","start","OpenDate","eTime","add","update","ID","Status","Teacher","UserInformationID","color","input","option","children","toLowerCase","indexOf","map","item","VideoCourseName","_d"],"mappings":"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","sourcesContent":["import { Modal, Select, Spin, TimePicker } from 'antd'\r\nimport moment, { Moment } from 'moment'\r\nimport React, { useState, useEffect } from 'react'\r\nimport 'react-big-calendar/lib/css/react-big-calendar.css'\r\nimport { useWrap } from '~/context/wrap'\r\nimport _ from '~/appConfig'\r\nimport { CalendarApi } from '~/apiBase/Calendar/calendar'\r\n\r\nconst { Option } = Select\r\nmoment.locale('vi')\r\n\r\nconst ModalCreateEvent = (props: any) => {\r\n\tconst { visible, setVisible, date, courses, getData, event, teacherChangeData } = props\r\n\tconst { showNoti, userInformation } = useWrap()\r\n\r\n\tconsole.log('date: ', date)\r\n\r\n\tconst [selected, setSelected] = useState<any>({})\r\n\tconst [startTime, setStartTime] = useState<any>('')\r\n\tconst [endTime, setEndTime] = useState<any>('')\r\n\tconst [loading, setLoading] = useState<boolean>(true)\r\n\r\n\tconst [errorText, setErrorText] = useState<any>('')\r\n\r\n\tuseEffect(() => {\r\n\t\t!visible && setSelected({}), setStartTime(''), setEndTime('')\r\n\t}, [visible])\r\n\r\n\tconst onChange = (value: string) => {\r\n\t\tlet indexSelected = courses.findIndex((e: any) => e?.VideoCourseID == value)\r\n\t\tsetSelected(courses[indexSelected])\r\n\t\treturn null\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (visible && !!event?.id) {\r\n\t\t\tgetDataDetails()\r\n\t\t} else {\r\n\t\t\tsetLoading(false)\r\n\t\t}\r\n\t}, [visible])\r\n\r\n\tconst [details, setDetails] = useState<any>('')\r\n\r\n\tconst getDataDetails = async () => {\r\n\t\ttry {\r\n\t\t\tconst res: any = await CalendarApi.getByID(event?.id)\r\n\t\t\tif (res.status == 200) {\r\n\t\t\t\tsetDetails(res.data.data)\r\n\t\t\t\tsetStartTime(res.data.data?.sTime)\r\n\t\t\t\tlet index = courses.findIndex((e) => e.VideoCourseID == res.data.data?.VideoCourseID)\r\n\t\t\t\tindex !== -1 && setSelected(courses[index])\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error?.message)\r\n\t\t} finally {\r\n\t\t\tsetLoading(false)\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!!startTime) {\r\n\t\t\tconst tempMoment: any = moment(startTime, 'HH:mm')\r\n\t\t\tconst temp: any = new Date(startTime)\r\n\t\t\tconst timestamp = Math.floor(!!temp && temp != 'Invalid date' && temp != 'Invalid Date' ? temp / 1000 : tempMoment / 1000)\r\n\t\t\tvar tempDate = new Date((timestamp + parseInt(selected?.LimitMinutes) * 60) * 1000)\r\n\t\t\tsetEndTime(tempDate)\r\n\t\t}\r\n\t}, [startTime, selected])\r\n\r\n\tuseEffect(() => {\r\n\t\tsetErrorText('')\r\n\t}, [selected, startTime])\r\n\r\n\tconst _createEvent = async () => {\r\n\t\tsetLoading(true)\r\n\t\tif (!selected?.VideoCourseID) {\r\n\t\t\tsetErrorText('Vui lòng chọn khóa học')\r\n\t\t} else {\r\n\t\t\tif (!startTime) {\r\n\t\t\t\tsetErrorText('Vui lòng chọn ngày bắt đầu')\r\n\t\t\t} else {\r\n\t\t\t\tlet sTemp = moment(startTime).format('HH:mm')\r\n\t\t\t\tlet oDate = moment(date?.start).format('YYYY/MM/DD')\r\n\r\n\t\t\t\tlet temp = {\r\n\t\t\t\t\tVideoCourseID: selected?.VideoCourseID,\r\n\t\t\t\t\tOpenDate: !!oDate && oDate != 'Invalid date' && oDate != 'Invalid Date' ? oDate : moment(details?.OpenDate).format('YYYY/MM/DD'),\r\n\t\t\t\t\tsTime: !!sTemp && sTemp != 'Invalid date' && sTemp != 'Invalid Date' ? sTemp : startTime,\r\n\t\t\t\t\teTime: moment(endTime).format('HH:mm')\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst res: any = await (!event?.start\r\n\t\t\t\t\t\t? CalendarApi.add(temp)\r\n\t\t\t\t\t\t: CalendarApi.update({ ...temp, ID: event?.id, Status: details?.Status }))\r\n\t\t\t\t\tif (res.status == 200 || res.status == 204) {\r\n\t\t\t\t\t\tshowNoti('success', 'Thành công')\r\n\t\t\t\t\t\tgetData()\r\n\t\t\t\t\t\tsetVisible(false)\r\n\t\t\t\t\t\tteacherChangeData({ Teacher: userInformation.UserInformationID })\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tshowNoti('danger', error?.message)\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tsetLoading(false)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Modal\r\n\t\t\t\tclassName=\"wrap-calendar-x\"\r\n\t\t\t\ttitle={\r\n\t\t\t\t\t!event?.start\r\n\t\t\t\t\t\t? 'Thêm lịch ngày: ' + moment(date?.start).format('DD-MM-YYYY')\r\n\t\t\t\t\t\t: 'Sửa lịch ngày: ' + moment(event?.start).format('DD-MM-YYYY')\r\n\t\t\t\t}\r\n\t\t\t\tvisible={visible}\r\n\t\t\t\tonCancel={() => setVisible(false)}\r\n\t\t\t\tonOk={() => _createEvent()}\r\n\t\t\t\tcancelText={<div className=\"\">Huỷ</div>}\r\n\t\t\t\tokText={<div className=\"btn-primary save\">Lưu lại {loading && <Spin className=\"ml-2\" size=\"small\" />}</div>}\r\n\t\t\t\tcentered\r\n\t\t\t>\r\n\t\t\t\t<div className=\"col-md-12 col-12\">\r\n\t\t\t\t\t<div className=\"mb-2\">\r\n\t\t\t\t\t\tChọn khóa học <span style={{ color: 'red' }}> *</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Select\r\n\t\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\t\tclassName=\"w-100\"\r\n\t\t\t\t\t\tshowSearch\r\n\t\t\t\t\t\tvalue={selected?.VideoCourseID || null}\r\n\t\t\t\t\t\tplaceholder=\"Chọn khóa học\"\r\n\t\t\t\t\t\toptionFilterProp=\"children\"\r\n\t\t\t\t\t\tonChange={onChange}\r\n\t\t\t\t\t\tfilterOption={(input, option: any) => option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{!!courses && courses.map((item: any) => <Option value={item?.VideoCourseID}>{item?.VideoCourseName}</Option>)}\r\n\t\t\t\t\t</Select>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"row col-12 m-0 p-0\">\r\n\t\t\t\t\t<div className=\"col-md-6 col-12\">\r\n\t\t\t\t\t\t<div className=\"mb-2 mt-4\">\r\n\t\t\t\t\t\t\tChọn giờ bắt đầu <span style={{ color: 'red' }}> *</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<TimePicker\r\n\t\t\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\t\t\tvalue={!!startTime ? moment(startTime, 'HH:mm') : null}\r\n\t\t\t\t\t\t\tonChange={(e: any) => setStartTime(e?._d)}\r\n\t\t\t\t\t\t\tclassName=\"ant-input\"\r\n\t\t\t\t\t\t\tplaceholder=\"Bắt đầu\"\r\n\t\t\t\t\t\t\tformat={'HH:mm'}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"col-md-6 col-12\">\r\n\t\t\t\t\t\t<div className=\"mb-2 mt-4\">Giờ kết thúc</div>\r\n\t\t\t\t\t\t<TimePicker\r\n\t\t\t\t\t\t\tvalue={!!endTime && endTime != 'Invalid Date' ? moment(endTime, 'HH:mm') : null}\r\n\t\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\t\tclassName=\"ant-input\"\r\n\t\t\t\t\t\t\tplaceholder=\"Hãy chọn giờ bắt đầu\"\r\n\t\t\t\t\t\t\tformat={'HH:mm'}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{!!errorText && (\r\n\t\t\t\t\t<div className=\"col-md-6 col-12 mt-3\">\r\n\t\t\t\t\t\t<div style={{ color: 'red' }}>{errorText}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default ModalCreateEvent\r\n"]},"metadata":{},"sourceType":"module"}