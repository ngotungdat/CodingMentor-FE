{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Profile\\\\ProfileCustomer\\\\InfoPaymentCard\\\\RefundsTable.tsx\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Check } from 'react-feather';\nimport { refundsApi, voucherApi } from '~/apiBase';\nimport { ExpandRefundRow } from '~/components/Elements/ExpandBox';\nimport ExpandTable from '~/components/ExpandTable';\nimport { useWrap } from '~/context/wrap';\nimport { numberWithCommas } from '~/utils/functions';\nRefundsTable.propTypes = {\n  studentID: PropTypes.number\n};\nRefundsTable.defaultProps = {\n  studentID: 0\n};\n\nfunction RefundsTable(props) {\n  _s();\n\n  var _this = this;\n\n  var studentID = props.studentID;\n\n  var _useWrap = useWrap(),\n      showNoti = _useWrap.showNoti,\n      pageSize = _useWrap.pageSize;\n\n  var _useState = useState({\n    type: null,\n    status: false\n  }),\n      isLoading = _useState[0],\n      setIsLoading = _useState[1];\n\n  var _useState2 = useState([]),\n      refundList = _useState2[0],\n      setRefundList = _useState2[1];\n\n  var _useState3 = useState(null),\n      totalPage = _useState3[0],\n      setTotalPage = _useState3[1];\n\n  var _useState4 = useState([]),\n      infoVoucherList = _useState4[0],\n      setInfoVoucherList = _useState4[1];\n\n  var listFieldInit = {\n    pageIndex: 1,\n    pageSize: pageSize,\n    sort: -1,\n    sortType: false,\n    UserInformationID: studentID\n  };\n  var refValue = useRef({\n    pageIndex: 1,\n    pageSize: 10,\n    sort: -1,\n    sortType: false\n  });\n\n  var _useState5 = useState(listFieldInit),\n      filters = _useState5[0],\n      setFilters = _useState5[1]; // PAGINATION\n\n\n  var getPagination = function getPagination(pageIndex, pageSize) {\n    if (!pageSize) pageSize = 10;\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      pageSize: pageSize,\n      pageIndex: pageIndex\n    });\n    setFilters(_objectSpread(_objectSpread({}, filters), refValue.current));\n  };\n\n  var getRefundList = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              setIsLoading({\n                type: 'GET_ALL',\n                status: true\n              });\n              _context.next = 4;\n              return refundsApi.getAll(filters);\n\n            case 4:\n              res = _context.sent;\n\n              if (res.status === 200) {\n                setRefundList(res.data.data);\n                setTotalPage(res.data.totalRow);\n              }\n\n              if (res.status == 204) {\n                setRefundList([]);\n              }\n\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              showNoti('danger', _context.t0.message);\n\n            case 12:\n              _context.prev = 12;\n              setIsLoading({\n                type: 'GET_ALL',\n                status: false\n              });\n              return _context.finish(12);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 9, 12, 15]]);\n    }));\n\n    return function getRefundList() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    getRefundList();\n  }, [filters]);\n  var columns = [{\n    title: 'Ngày tạo',\n    dataIndex: 'CreatedOn',\n    render: function render(date) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"font-weight-black\",\n        children: moment(date).format('DD/MM/YYYY')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 22\n      }, _this);\n    }\n  }, {\n    title: 'Trung tâm',\n    dataIndex: 'BranchName'\n  }, {\n    title: 'Số tiền',\n    dataIndex: 'Price',\n    render: function render(price) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"font-weight-primary\",\n        children: numberWithCommas(price)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 12\n      }, _this);\n    }\n  }, {\n    title: 'Trạng thái',\n    dataIndex: 'StatusName',\n    align: 'center',\n    render: function render(fnStatus) {\n      switch (fnStatus) {\n        case 'Chờ duyệt':\n          return /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag green\",\n            children: fnStatus\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 14\n          }, _this);\n\n        case 'Không duyệt':\n          return /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag red\",\n            children: fnStatus\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 14\n          }, _this);\n\n        case 'Đã duyệt':\n          return /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag yellow\",\n            children: fnStatus\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 14\n          }, _this);\n          break;\n      }\n    }\n  }, {\n    title: 'Xóa khỏi lớp',\n    dataIndex: 'isExpulsion',\n    align: 'center',\n    render: function render(isExpulsion) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        children: isExpulsion ? /*#__PURE__*/_jsxDEV(Check, {\n          color: \"#0da779\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 30\n        }, _this) : ''\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 12\n      }, _this);\n    }\n  }]; //\n\n  var fetchInfoVoucherList = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(ID) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              setIsLoading({\n                type: 'FETCH_INFO_VOUCHER',\n                status: true\n              });\n              _context2.next = 4;\n              return voucherApi.getAll({\n                RefundsID: ID\n              });\n\n            case 4:\n              res = _context2.sent;\n\n              if (res.status === 200) {\n                setInfoVoucherList(res.data.data);\n              }\n\n              if (res.status === 204) {\n                setInfoVoucherList(null);\n              }\n\n              _context2.next = 12;\n              break;\n\n            case 9:\n              _context2.prev = 9;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(fetchInfoVoucherList, _context2.t0.message);\n\n            case 12:\n              _context2.prev = 12;\n              setIsLoading({\n                type: 'FETCH_INFO_VOUCHER',\n                status: false\n              });\n              return _context2.finish(12);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 9, 12, 15]]);\n    }));\n\n    return function fetchInfoVoucherList(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var expandableObj = {\n    expandedRowRender: function expandedRowRender(record) {\n      return /*#__PURE__*/_jsxDEV(ExpandRefundRow, {\n        isLoading: isLoading,\n        dataRow: record,\n        infoVoucherList: infoVoucherList\n      }, record.ID, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 4\n      }, _this);\n    },\n    onExpand: function onExpand(expanded, record) {\n      if (expanded) {\n        fetchInfoVoucherList(record.ID);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(ExpandTable, {\n    loading: isLoading,\n    currentPage: filters.pageIndex,\n    totalPage: totalPage,\n    getPagination: getPagination,\n    noScroll: true,\n    dataSource: refundList,\n    columns: columns,\n    Extra: /*#__PURE__*/_jsxDEV(\"h5\", {\n      children: \"L\\u1ECBch s\\u1EED ho\\xE0n ti\\u1EC1n\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 11\n    }, this),\n    expandable: expandableObj\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 166,\n    columnNumber: 3\n  }, this);\n}\n\n_s(RefundsTable, \"IfzW5w07OJWOKrHcv56UGQMEEM4=\", false, function () {\n  return [useWrap];\n});\n\n_c = RefundsTable;\nexport default RefundsTable;\n\nvar _c;\n\n$RefreshReg$(_c, \"RefundsTable\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Profile/ProfileCustomer/InfoPaymentCard/RefundsTable.tsx"],"names":["moment","PropTypes","React","useEffect","useRef","useState","Check","refundsApi","voucherApi","ExpandRefundRow","ExpandTable","useWrap","numberWithCommas","RefundsTable","propTypes","studentID","number","defaultProps","props","showNoti","pageSize","type","status","isLoading","setIsLoading","refundList","setRefundList","totalPage","setTotalPage","infoVoucherList","setInfoVoucherList","listFieldInit","pageIndex","sort","sortType","UserInformationID","refValue","filters","setFilters","getPagination","current","getRefundList","getAll","res","data","totalRow","message","columns","title","dataIndex","render","date","format","price","align","fnStatus","isExpulsion","fetchInfoVoucherList","ID","RefundsID","console","log","expandableObj","expandedRowRender","record","onExpand","expanded"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,MAAP,MAAmB,QAAnB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,EAAmCC,QAAnC,QAAmD,OAAnD;AACA,SAASC,KAAT,QAAsB,eAAtB;AACA,SAASC,UAAT,EAAqBC,UAArB,QAAuC,WAAvC;AACA,SAASC,eAAT,QAAgC,iCAAhC;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,SAASC,OAAT,QAAwB,gBAAxB;AACA,SAASC,gBAAT,QAAiC,mBAAjC;AAEAC,YAAY,CAACC,SAAb,GAAyB;AACxBC,EAAAA,SAAS,EAAEd,SAAS,CAACe;AADG,CAAzB;AAGAH,YAAY,CAACI,YAAb,GAA4B;AAC3BF,EAAAA,SAAS,EAAE;AADgB,CAA5B;;AAGA,SAASF,YAAT,CAAsBK,KAAtB,EAA6B;AAAA;;AAAA;;AAAA,MACpBH,SADoB,GACNG,KADM,CACpBH,SADoB;;AAAA,iBAEGJ,OAAO,EAFV;AAAA,MAEpBQ,QAFoB,YAEpBA,QAFoB;AAAA,MAEVC,QAFU,YAEVA,QAFU;;AAAA,kBAGMf,QAAQ,CAAC;AAC1CgB,IAAAA,IAAI,EAAE,IADoC;AAE1CC,IAAAA,MAAM,EAAE;AAFkC,GAAD,CAHd;AAAA,MAGrBC,SAHqB;AAAA,MAGVC,YAHU;;AAAA,mBAOQnB,QAAQ,CAAa,EAAb,CAPhB;AAAA,MAOrBoB,UAPqB;AAAA,MAOTC,aAPS;;AAAA,mBAQMrB,QAAQ,CAAC,IAAD,CARd;AAAA,MAQrBsB,SARqB;AAAA,MAQVC,YARU;;AAAA,mBASkBvB,QAAQ,CAAa,EAAb,CAT1B;AAAA,MASrBwB,eATqB;AAAA,MASJC,kBATI;;AAW5B,MAAMC,aAAa,GAAG;AACrBC,IAAAA,SAAS,EAAE,CADU;AAErBZ,IAAAA,QAAQ,EAAEA,QAFW;AAGrBa,IAAAA,IAAI,EAAE,CAAC,CAHc;AAIrBC,IAAAA,QAAQ,EAAE,KAJW;AAKrBC,IAAAA,iBAAiB,EAAEpB;AALE,GAAtB;AAOA,MAAIqB,QAAQ,GAAGhC,MAAM,CAAC;AACrB4B,IAAAA,SAAS,EAAE,CADU;AAErBZ,IAAAA,QAAQ,EAAE,EAFW;AAGrBa,IAAAA,IAAI,EAAE,CAAC,CAHc;AAIrBC,IAAAA,QAAQ,EAAE;AAJW,GAAD,CAArB;;AAlB4B,mBAwBE7B,QAAQ,CAAC0B,aAAD,CAxBV;AAAA,MAwBrBM,OAxBqB;AAAA,MAwBZC,UAxBY,kBA0B5B;;;AACA,MAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACP,SAAD,EAAoBZ,QAApB,EAAyC;AAC9D,QAAI,CAACA,QAAL,EAAeA,QAAQ,GAAG,EAAX;AACfgB,IAAAA,QAAQ,CAACI,OAAT,mCACIJ,QAAQ,CAACI,OADb;AAECpB,MAAAA,QAAQ,EAARA,QAFD;AAGCY,MAAAA,SAAS,EAATA;AAHD;AAKAM,IAAAA,UAAU,iCACND,OADM,GAEND,QAAQ,CAACI,OAFH,EAAV;AAIA,GAXD;;AAaA,MAAMC,aAAa;AAAA,wEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEpBjB,cAAAA,YAAY,CAAC;AACZH,gBAAAA,IAAI,EAAE,SADM;AAEZC,gBAAAA,MAAM,EAAE;AAFI,eAAD,CAAZ;AAFoB;AAAA,qBAMFf,UAAU,CAACmC,MAAX,CAAkBL,OAAlB,CANE;;AAAA;AAMdM,cAAAA,GANc;;AAOpB,kBAAIA,GAAG,CAACrB,MAAJ,KAAe,GAAnB,EAAwB;AACvBI,gBAAAA,aAAa,CAACiB,GAAG,CAACC,IAAJ,CAASA,IAAV,CAAb;AACAhB,gBAAAA,YAAY,CAACe,GAAG,CAACC,IAAJ,CAASC,QAAV,CAAZ;AACA;;AACD,kBAAIF,GAAG,CAACrB,MAAJ,IAAc,GAAlB,EAAuB;AACtBI,gBAAAA,aAAa,CAAC,EAAD,CAAb;AACA;;AAbmB;AAAA;;AAAA;AAAA;AAAA;AAepBP,cAAAA,QAAQ,CAAC,QAAD,EAAW,YAAM2B,OAAjB,CAAR;;AAfoB;AAAA;AAiBpBtB,cAAAA,YAAY,CAAC;AACZH,gBAAAA,IAAI,EAAE,SADM;AAEZC,gBAAAA,MAAM,EAAE;AAFI,eAAD,CAAZ;AAjBoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAbmB,aAAa;AAAA;AAAA;AAAA,KAAnB;;AAwBAtC,EAAAA,SAAS,CAAC,YAAM;AACfsC,IAAAA,aAAa;AACb,GAFQ,EAEN,CAACJ,OAAD,CAFM,CAAT;AAIA,MAAMU,OAAO,GAAG,CACf;AACCC,IAAAA,KAAK,EAAE,UADR;AAECC,IAAAA,SAAS,EAAE,WAFZ;AAGCC,IAAAA,MAAM,EAAE,gBAACC,IAAD;AAAA,0BAAU;AAAG,QAAA,SAAS,EAAC,mBAAb;AAAA,kBAAkCnD,MAAM,CAACmD,IAAD,CAAN,CAAaC,MAAb,CAAoB,YAApB;AAAlC;AAAA;AAAA;AAAA;AAAA,eAAV;AAAA;AAHT,GADe,EAMf;AACCJ,IAAAA,KAAK,EAAE,WADR;AAECC,IAAAA,SAAS,EAAE;AAFZ,GANe,EAUf;AACCD,IAAAA,KAAK,EAAE,SADR;AAECC,IAAAA,SAAS,EAAE,OAFZ;AAGCC,IAAAA,MAAM,EAAE,gBAACG,KAAD,EAAW;AAClB,0BAAO;AAAG,QAAA,SAAS,EAAC,qBAAb;AAAA,kBAAoCzC,gBAAgB,CAACyC,KAAD;AAApD;AAAA;AAAA;AAAA;AAAA,eAAP;AACA;AALF,GAVe,EAiBf;AACCL,IAAAA,KAAK,EAAE,YADR;AAECC,IAAAA,SAAS,EAAE,YAFZ;AAGCK,IAAAA,KAAK,EAAE,QAHR;AAICJ,IAAAA,MAAM,EAAE,gBAACK,QAAD,EAAc;AACrB,cAAQA,QAAR;AACC,aAAK,WAAL;AACC,8BAAO;AAAM,YAAA,SAAS,EAAC,WAAhB;AAAA,sBAA6BA;AAA7B;AAAA;AAAA;AAAA;AAAA,mBAAP;;AACD,aAAK,aAAL;AACC,8BAAO;AAAM,YAAA,SAAS,EAAC,SAAhB;AAAA,sBAA2BA;AAA3B;AAAA;AAAA;AAAA;AAAA,mBAAP;;AACD,aAAK,UAAL;AACC,8BAAO;AAAM,YAAA,SAAS,EAAC,YAAhB;AAAA,sBAA8BA;AAA9B;AAAA;AAAA;AAAA;AAAA,mBAAP;AACA;AAPF;AASA;AAdF,GAjBe,EAiCf;AACCP,IAAAA,KAAK,EAAE,cADR;AAECC,IAAAA,SAAS,EAAE,aAFZ;AAGCK,IAAAA,KAAK,EAAE,QAHR;AAICJ,IAAAA,MAAM,EAAE,gBAACM,WAAD,EAAiB;AACxB,0BAAO;AAAA,kBAAIA,WAAW,gBAAG,QAAC,KAAD;AAAO,UAAA,KAAK,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,iBAAH,GAA+B;AAA9C;AAAA;AAAA;AAAA;AAAA,eAAP;AACA;AANF,GAjCe,CAAhB,CApE4B,CA+G5B;;AACA,MAAMC,oBAAoB;AAAA,yEAAG,kBAAOC,EAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAE3BlC,cAAAA,YAAY,CAAC;AACZH,gBAAAA,IAAI,EAAE,oBADM;AAEZC,gBAAAA,MAAM,EAAE;AAFI,eAAD,CAAZ;AAF2B;AAAA,qBAMTd,UAAU,CAACkC,MAAX,CAAkB;AACnCiB,gBAAAA,SAAS,EAAED;AADwB,eAAlB,CANS;;AAAA;AAMrBf,cAAAA,GANqB;;AAS3B,kBAAIA,GAAG,CAACrB,MAAJ,KAAe,GAAnB,EAAwB;AACvBQ,gBAAAA,kBAAkB,CAACa,GAAG,CAACC,IAAJ,CAASA,IAAV,CAAlB;AACA;;AACD,kBAAID,GAAG,CAACrB,MAAJ,KAAe,GAAnB,EAAwB;AACvBQ,gBAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACA;;AAd0B;AAAA;;AAAA;AAAA;AAAA;AAgB3B8B,cAAAA,OAAO,CAACC,GAAR,CAAYJ,oBAAZ,EAAkC,aAAMX,OAAxC;;AAhB2B;AAAA;AAkB3BtB,cAAAA,YAAY,CAAC;AACZH,gBAAAA,IAAI,EAAE,oBADM;AAEZC,gBAAAA,MAAM,EAAE;AAFI,eAAD,CAAZ;AAlB2B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAApBmC,oBAAoB;AAAA;AAAA;AAAA,KAA1B;;AAyBA,MAAMK,aAAa,GAAG;AACrBC,IAAAA,iBAAiB,EAAE,2BAACC,MAAD;AAAA,0BAClB,QAAC,eAAD;AAAiB,QAAA,SAAS,EAAEzC,SAA5B;AAAuD,QAAA,OAAO,EAAEyC,MAAhE;AAAwE,QAAA,eAAe,EAAEnC;AAAzF,SAA4CmC,MAAM,CAACN,EAAnD;AAAA;AAAA;AAAA;AAAA,eADkB;AAAA,KADE;AAIrBO,IAAAA,QAAQ,EAAE,kBAACC,QAAD,EAAWF,MAAX,EAAsB;AAC/B,UAAIE,QAAJ,EAAc;AACbT,QAAAA,oBAAoB,CAACO,MAAM,CAACN,EAAR,CAApB;AACA;AACD;AARoB,GAAtB;AAWA,sBACC,QAAC,WAAD;AACC,IAAA,OAAO,EAAEnC,SADV;AAEC,IAAA,WAAW,EAAEc,OAAO,CAACL,SAFtB;AAGC,IAAA,SAAS,EAAEL,SAHZ;AAIC,IAAA,aAAa,EAAEY,aAJhB;AAKC,IAAA,QAAQ,MALT;AAMC,IAAA,UAAU,EAAEd,UANb;AAOC,IAAA,OAAO,EAAEsB,OAPV;AAQC,IAAA,KAAK,eAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YARR;AASC,IAAA,UAAU,EAAEe;AATb;AAAA;AAAA;AAAA;AAAA,UADD;AAaA;;GAjKQjD,Y;UAEuBF,O;;;KAFvBE,Y;AAkKT,eAAeA,YAAf","sourcesContent":["import moment from 'moment';\r\nimport PropTypes from 'prop-types';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { Check } from 'react-feather';\r\nimport { refundsApi, voucherApi } from '~/apiBase';\r\nimport { ExpandRefundRow } from '~/components/Elements/ExpandBox';\r\nimport ExpandTable from '~/components/ExpandTable';\r\nimport { useWrap } from '~/context/wrap';\r\nimport { numberWithCommas } from '~/utils/functions';\r\n\r\nRefundsTable.propTypes = {\r\n\tstudentID: PropTypes.number\r\n};\r\nRefundsTable.defaultProps = {\r\n\tstudentID: 0\r\n};\r\nfunction RefundsTable(props) {\r\n\tconst { studentID } = props;\r\n\tconst { showNoti, pageSize } = useWrap();\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: null,\r\n\t\tstatus: false\r\n\t});\r\n\tconst [refundList, setRefundList] = useState<IRefunds[]>([]);\r\n\tconst [totalPage, setTotalPage] = useState(null);\r\n\tconst [infoVoucherList, setInfoVoucherList] = useState<IVoucher[]>([]);\r\n\r\n\tconst listFieldInit = {\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: pageSize,\r\n\t\tsort: -1,\r\n\t\tsortType: false,\r\n\t\tUserInformationID: studentID\r\n\t};\r\n\tlet refValue = useRef({\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: 10,\r\n\t\tsort: -1,\r\n\t\tsortType: false\r\n\t});\r\n\tconst [filters, setFilters] = useState(listFieldInit);\r\n\r\n\t// PAGINATION\r\n\tconst getPagination = (pageIndex: number, pageSize: number) => {\r\n\t\tif (!pageSize) pageSize = 10;\r\n\t\trefValue.current = {\r\n\t\t\t...refValue.current,\r\n\t\t\tpageSize,\r\n\t\t\tpageIndex\r\n\t\t};\r\n\t\tsetFilters({\r\n\t\t\t...filters,\r\n\t\t\t...refValue.current\r\n\t\t});\r\n\t};\r\n\r\n\tconst getRefundList = async () => {\r\n\t\ttry {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: true\r\n\t\t\t});\r\n\t\t\tconst res = await refundsApi.getAll(filters);\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tsetRefundList(res.data.data);\r\n\t\t\t\tsetTotalPage(res.data.totalRow);\r\n\t\t\t}\r\n\t\t\tif (res.status == 204) {\r\n\t\t\t\tsetRefundList([]);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tgetRefundList();\r\n\t}, [filters]);\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Ngày tạo',\r\n\t\t\tdataIndex: 'CreatedOn',\r\n\t\t\trender: (date) => <p className=\"font-weight-black\">{moment(date).format('DD/MM/YYYY')}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Trung tâm',\r\n\t\t\tdataIndex: 'BranchName'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Số tiền',\r\n\t\t\tdataIndex: 'Price',\r\n\t\t\trender: (price) => {\r\n\t\t\t\treturn <p className=\"font-weight-primary\">{numberWithCommas(price)}</p>;\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Trạng thái',\r\n\t\t\tdataIndex: 'StatusName',\r\n\t\t\talign: 'center',\r\n\t\t\trender: (fnStatus) => {\r\n\t\t\t\tswitch (fnStatus) {\r\n\t\t\t\t\tcase 'Chờ duyệt':\r\n\t\t\t\t\t\treturn <span className=\"tag green\">{fnStatus}</span>;\r\n\t\t\t\t\tcase 'Không duyệt':\r\n\t\t\t\t\t\treturn <span className=\"tag red\">{fnStatus}</span>;\r\n\t\t\t\t\tcase 'Đã duyệt':\r\n\t\t\t\t\t\treturn <span className=\"tag yellow\">{fnStatus}</span>;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Xóa khỏi lớp',\r\n\t\t\tdataIndex: 'isExpulsion',\r\n\t\t\talign: 'center',\r\n\t\t\trender: (isExpulsion) => {\r\n\t\t\t\treturn <p>{isExpulsion ? <Check color=\"#0da779\" /> : ''}</p>;\r\n\t\t\t}\r\n\t\t}\r\n\t];\r\n\r\n\t//\r\n\tconst fetchInfoVoucherList = async (ID: number) => {\r\n\t\ttry {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'FETCH_INFO_VOUCHER',\r\n\t\t\t\tstatus: true\r\n\t\t\t});\r\n\t\t\tconst res = await voucherApi.getAll({\r\n\t\t\t\tRefundsID: ID\r\n\t\t\t});\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tsetInfoVoucherList(res.data.data);\r\n\t\t\t}\r\n\t\t\tif (res.status === 204) {\r\n\t\t\t\tsetInfoVoucherList(null);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(fetchInfoVoucherList, error.message);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'FETCH_INFO_VOUCHER',\r\n\t\t\t\tstatus: false\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tconst expandableObj = {\r\n\t\texpandedRowRender: (record) => (\r\n\t\t\t<ExpandRefundRow isLoading={isLoading} key={record.ID} dataRow={record} infoVoucherList={infoVoucherList} />\r\n\t\t),\r\n\t\tonExpand: (expanded, record) => {\r\n\t\t\tif (expanded) {\r\n\t\t\t\tfetchInfoVoucherList(record.ID);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<ExpandTable\r\n\t\t\tloading={isLoading}\r\n\t\t\tcurrentPage={filters.pageIndex}\r\n\t\t\ttotalPage={totalPage}\r\n\t\t\tgetPagination={getPagination}\r\n\t\t\tnoScroll\r\n\t\t\tdataSource={refundList}\r\n\t\t\tcolumns={columns}\r\n\t\t\tExtra={<h5>Lịch sử hoàn tiền</h5>}\r\n\t\t\texpandable={expandableObj}\r\n\t\t/>\r\n\t);\r\n}\r\nexport default RefundsTable;\r\n"]},"metadata":{},"sourceType":"module"}