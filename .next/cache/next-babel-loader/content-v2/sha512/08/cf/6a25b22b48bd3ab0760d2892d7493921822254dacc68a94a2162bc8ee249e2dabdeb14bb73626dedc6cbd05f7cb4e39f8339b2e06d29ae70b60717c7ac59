{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\Package\\\\Package\\\\Package.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Image, Switch, Tooltip } from 'antd';\nimport moment from 'moment';\nimport Link from 'next/link';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Eye } from 'react-feather';\nimport { packageApi } from '~/apiBase';\nimport SortBox from '~/components/Elements/SortBox';\nimport PowerTable from '~/components/PowerTable';\nimport FilterColumn from '~/components/Tables/FilterColumn';\nimport { useWrap } from '~/context/wrap';\nimport { numberWithCommas } from '~/utils/functions';\nimport PackageForm from './PackageForm/PackageForm';\nimport PackageFormFilterForm from './PackageForm/PakageFormFilterForm';\n\nfunction Package() {\n  const {\n    0: packageList,\n    1: setPackageList\n  } = useState([]);\n  const levelOptionList = useRef([]);\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState({\n    type: '',\n    status: false\n  });\n  const {\n    0: totalPage,\n    1: setTotalPage\n  } = useState(null);\n  const {\n    showNoti,\n    pageSize\n  } = useWrap();\n  const {\n    0: activeColumnSearch,\n    1: setActiveColumnSearch\n  } = useState(''); // FILTER\n\n  const listFieldInit = {\n    pageIndex: 1,\n    pageSize: pageSize,\n    sort: -1,\n    sortType: false,\n    Type: null,\n    Level: null,\n    fromDate: '',\n    toDate: ''\n  };\n  let refValue = useRef({\n    pageIndex: 1,\n    pageSize: 10,\n    sort: -1,\n    sortType: false\n  });\n  const {\n    0: filters,\n    1: setFilters\n  } = useState(listFieldInit);\n  const paymentMethodOptionList = [{\n    label: 'Miễn phí',\n    value: 1\n  }, {\n    label: 'Cao cấp',\n    value: 2\n  }];\n  const typeFilterList = [{\n    value: 1,\n    title: 'Miễn phí'\n  }, {\n    value: 2,\n    title: 'Cao cấp'\n  }];\n  const levelFilterList = [{\n    value: 1,\n    title: 'HSK 1'\n  }, {\n    value: 2,\n    title: 'HSK 2'\n  }, {\n    value: 3,\n    title: 'HSK 3'\n  }, {\n    value: 4,\n    title: 'HSK 4'\n  }, {\n    value: 5,\n    title: 'HSK 5'\n  }, {\n    value: 6,\n    title: 'HSK 6'\n  }]; // SORT OPTION\n\n  const sortOptionList = [{\n    dataSort: {\n      sort: 0,\n      sortType: true\n    },\n    value: 1,\n    text: 'Level tăng dần'\n  }, {\n    dataSort: {\n      sort: 0,\n      sortType: false\n    },\n    value: 2,\n    text: 'Level giảm dần'\n  }, {\n    dataSort: {\n      sort: 1,\n      sortType: true\n    },\n    value: 3,\n    text: 'Giá tăng dần'\n  }, {\n    dataSort: {\n      sort: 1,\n      sortType: false\n    },\n    value: 4,\n    text: 'Giá giảm dần'\n  }]; // PAGINATION\n\n  const getPagination = (pageIndex, pageSize) => {\n    if (!pageSize) pageSize = 10;\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      pageSize,\n      pageIndex\n    });\n    setFilters(_objectSpread(_objectSpread({}, filters), refValue.current));\n  }; // SORT\n\n\n  const onSort = option => {\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      sort: option.title.sort,\n      sortType: option.title.sortType\n    });\n    setFilters(_objectSpread(_objectSpread({}, listFieldInit), refValue.current));\n  }; // FILTER\n\n\n  const onFilter = obj => {\n    setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, {\n      pageIndex: 1\n    }, obj));\n  }; // RESET SEARCH\n\n\n  const onResetSearch = () => {\n    setActiveColumnSearch('');\n    setFilters(_objectSpread(_objectSpread({}, listFieldInit), {}, {\n      pageSize: refValue.current.pageSize\n    }));\n  }; // ACTION SEARCH\n\n\n  const onSearch = (valueSearch, dataIndex) => {\n    setActiveColumnSearch(dataIndex);\n\n    if (dataIndex === 'CreatedOn') {\n      setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, {\n        pageIndex: 1\n      }, valueSearch));\n    } else {\n      setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, {\n        pageIndex: 1,\n        [dataIndex]: valueSearch\n      }));\n    }\n  }; // GET DATA IN FIRST TIME\n\n\n  const formatLevelPackage = arr => {\n    if (arr && arr.length) {\n      const fmLevelOptionList = arr.map(l => ({\n        title: `Level ${l}`,\n        value: l\n      }));\n      levelOptionList.current = fmLevelOptionList;\n    }\n  };\n\n  const fetchPackageList = async () => {\n    setIsLoading({\n      type: 'GET_ALL',\n      status: true\n    });\n\n    try {\n      let res = await packageApi.getAll(filters);\n\n      if (res.status === 200) {\n        if (res.data.totalRow && res.data.data.length) {\n          formatLevelPackage(res.data['ListLevel']);\n          setPackageList(res.data.data);\n          setTotalPage(res.data.totalRow);\n        }\n      } else if (res.status === 204) {\n        showNoti('danger', 'Không tìm thấy');\n        setPackageList([]);\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: false\n      });\n    }\n  };\n\n  const fetchLevelPackageList = async () => {\n    try {\n      let res = await packageApi.getAll(filters);\n\n      if (res.status === 200) {\n        formatLevelPackage(res.data['ListLevel']);\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    }\n  };\n\n  useEffect(() => {\n    fetchPackageList();\n  }, [filters]);\n\n  const onChangeStatus = async (checked, idRow, idx) => {\n    setIsLoading({\n      type: 'GET_ALL',\n      status: true\n    });\n\n    try {\n      let dataChange = {\n        ID: idRow,\n        Enable: checked\n      };\n      let res = await packageApi.update(dataChange);\n\n      if (res.status === 200) {\n        const newPackageList = [...packageList];\n\n        const newPackage = _objectSpread(_objectSpread({}, packageList[idx]), {}, {\n          Enable: checked\n        });\n\n        newPackageList.splice(idx, 1, newPackage);\n        setPackageList(newPackageList);\n      }\n    } catch (error) {\n      showNoti('danger', error.Message);\n    } finally {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: false\n      });\n    }\n  }; // CREATE\n\n\n  const onCreatePackage = async (packageItem) => {\n    setIsLoading({\n      type: 'ADD_DATA',\n      status: true\n    });\n\n    try {\n      const {\n        Type,\n        Price\n      } = packageItem;\n\n      const newPackageItem = _objectSpread(_objectSpread({}, packageItem), {}, {\n        Price: Type === 1 ? 0 : parseInt(Price.replace(/\\D/g, ''))\n      });\n\n      const res = await packageApi.add(newPackageItem);\n\n      if (res.status === 200) {\n        showNoti('success', res.data.message);\n        onResetSearch(); // <== khi tạo xong r reset search để trở về trang đầu tiên\n      }\n\n      return res;\n    } catch (error) {\n      showNoti('danger', error.Message);\n    } finally {\n      setIsLoading({\n        type: 'ADD_DATA',\n        status: false\n      });\n    }\n  }; // UPDATE\n\n\n  const onUpdatePackage = idx => {\n    return async packageItem => {\n      setIsLoading({\n        type: 'ADD_DATA',\n        status: true\n      });\n\n      try {\n        const {\n          Type,\n          Price,\n          Level\n        } = packageItem;\n\n        const newPackageUpdate = _objectSpread(_objectSpread({}, packageItem), {}, {\n          Price: Type === 1 ? 0 : parseInt(Price.toString().replace(/\\D/g, '')),\n          TypeName: typeFilterList.find(t => t.value === Type).title || ''\n        });\n\n        const res = await packageApi.update(newPackageUpdate);\n\n        if (res.status === 200) {\n          const newPackageList = [...packageList];\n          newPackageList.splice(idx, 1, newPackageUpdate);\n          setPackageList(newPackageList);\n          fetchLevelPackageList();\n          showNoti('success', res.data.message);\n        }\n\n        return res;\n      } catch (error) {\n        showNoti('danger', error.message);\n      } finally {\n        setIsLoading({\n          type: 'ADD_DATA',\n          status: false\n        });\n      }\n    };\n  };\n\n  const columns = [{\n    title: 'Ảnh bìa',\n    dataIndex: 'Avatar',\n    render: url => {\n      console.log(url);\n      return /*#__PURE__*/_jsxDEV(Image, {\n        width: 70,\n        height: 70,\n        src: url === '' ? '/images/default-book.jpeg' : url,\n        title: \"\\u1EA2nh b\\xECa b\\u1ED9 \\u0111\\u1EC1\",\n        alt: \"\\u1EA2nh b\\xECa b\\u1ED9 \\u0111\\u1EC1\",\n        style: {\n          objectFit: 'cover'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 6\n      }, this);\n    }\n  }, {\n    title: 'Tên bộ đề',\n    dataIndex: 'Name'\n  }, _objectSpread(_objectSpread({\n    title: 'Level',\n    dataIndex: 'Level',\n    render: level => `HSK ${level}`\n  }, FilterColumn('Level', onSearch, onResetSearch, 'select', levelOptionList.current)), {}, {\n    className: activeColumnSearch === 'Level' ? 'active-column-search' : ''\n  }), _objectSpread(_objectSpread({\n    title: 'Loại',\n    dataIndex: 'TypeName'\n  }, FilterColumn('Type', onSearch, onResetSearch, 'select', typeFilterList)), {}, {\n    className: activeColumnSearch === 'Type' ? 'active-column-search' : ''\n  }), {\n    title: 'Giá',\n    dataIndex: 'Price',\n    render: price => !price ? 0 : numberWithCommas(price)\n  }, _objectSpread(_objectSpread({\n    title: 'Ngày tạo bộ đề',\n    dataIndex: 'CreatedOn'\n  }, FilterColumn('CreatedOn', onSearch, onResetSearch, 'date-range')), {}, {\n    render: date => moment(date).format('DD/MM/YYYY'),\n    className: activeColumnSearch === 'CreatedOn' ? 'active-column-search' : ''\n  }), {\n    title: 'Trạng thái',\n    dataIndex: 'Enable',\n    align: 'center',\n    render: (Enable, record, idx) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Switch, {\n        checkedChildren: \"Hi\\u1EC7n\",\n        unCheckedChildren: \"\\u1EA8n\",\n        checked: Enable,\n        size: \"default\",\n        onChange: checked => onChangeStatus(checked, record.ID, idx)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 379,\n        columnNumber: 6\n      }, this)\n    }, void 0, false)\n  }, {\n    align: 'center',\n    render: (packageItem, record, idx) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        href: {\n          pathname: '/package/package-list/package-list-detail/[slug]',\n          query: {\n            slug: packageItem.ID\n          }\n        },\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          title: \"Chi ti\\u1EBFt\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            className: \"btn btn-icon\",\n            children: /*#__PURE__*/_jsxDEV(Eye, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(PackageForm, {\n        isLoading: isLoading,\n        isUpdate: true,\n        updateObj: packageItem,\n        handleUpdatePackage: onUpdatePackage(idx),\n        paymentMethodOptionList: paymentMethodOptionList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true)\n  }];\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(PowerTable, {\n      currentPage: filters.pageIndex,\n      totalPage: totalPage,\n      getPagination: getPagination,\n      loading: isLoading,\n      Size: \"package-list-table\",\n      addClass: \"basic-header\",\n      dataSource: packageList,\n      columns: columns,\n      TitlePage: \"Danh s\\xE1ch b\\u1ED9 \\u0111\\u1EC1\",\n      Extra: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"extra-table\",\n        children: [/*#__PURE__*/_jsxDEV(PackageFormFilterForm, {\n          handleFilter: onFilter,\n          handleResetFilter: onResetSearch,\n          optionListForFilter: {\n            levelFilterList: levelFilterList,\n            typeFilterList: typeFilterList\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(SortBox, {\n          dataOption: sortOptionList,\n          handleSort: onSort\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 439,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 6\n      }, this),\n      TitleCard: /*#__PURE__*/_jsxDEV(PackageForm, {\n        isLoading: isLoading,\n        handleCreatePackage: onCreatePackage,\n        paymentMethodOptionList: paymentMethodOptionList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 443,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 4\n    }, this)\n  }, void 0, false);\n}\n\nexport default Package;","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/Package/Package/Package.tsx"],"names":["Image","Switch","Tooltip","moment","Link","React","useEffect","useRef","useState","Eye","packageApi","SortBox","PowerTable","FilterColumn","useWrap","numberWithCommas","PackageForm","PackageFormFilterForm","Package","packageList","setPackageList","levelOptionList","isLoading","setIsLoading","type","status","totalPage","setTotalPage","showNoti","pageSize","activeColumnSearch","setActiveColumnSearch","listFieldInit","pageIndex","sort","sortType","Type","Level","fromDate","toDate","refValue","filters","setFilters","paymentMethodOptionList","label","value","typeFilterList","title","levelFilterList","sortOptionList","dataSort","text","getPagination","current","onSort","option","onFilter","obj","onResetSearch","onSearch","valueSearch","dataIndex","formatLevelPackage","arr","length","fmLevelOptionList","map","l","fetchPackageList","res","getAll","data","totalRow","error","message","fetchLevelPackageList","onChangeStatus","checked","idRow","idx","dataChange","ID","Enable","update","newPackageList","newPackage","splice","Message","onCreatePackage","packageItem","Price","newPackageItem","parseInt","replace","add","onUpdatePackage","newPackageUpdate","toString","TypeName","find","t","columns","render","url","console","log","objectFit","level","className","price","date","format","align","record","pathname","query","slug"],"mappings":"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","sourcesContent":["import { Image, Switch, Tooltip } from 'antd'\r\nimport moment from 'moment'\r\nimport Link from 'next/link'\r\nimport React, { useEffect, useRef, useState } from 'react'\r\nimport { Eye } from 'react-feather'\r\nimport { packageApi } from '~/apiBase'\r\nimport SortBox from '~/components/Elements/SortBox'\r\nimport PowerTable from '~/components/PowerTable'\r\nimport FilterColumn from '~/components/Tables/FilterColumn'\r\nimport { useWrap } from '~/context/wrap'\r\nimport { numberWithCommas } from '~/utils/functions'\r\nimport PackageForm from './PackageForm/PackageForm'\r\nimport PackageFormFilterForm from './PackageForm/PakageFormFilterForm'\r\n\r\nfunction Package() {\r\n\tconst [packageList, setPackageList] = useState<IPackage[]>([])\r\n\tconst levelOptionList = useRef<IOptionCommon[]>([])\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: '',\r\n\t\tstatus: false\r\n\t})\r\n\tconst [totalPage, setTotalPage] = useState(null)\r\n\tconst { showNoti, pageSize } = useWrap()\r\n\tconst [activeColumnSearch, setActiveColumnSearch] = useState('')\r\n\t// FILTER\r\n\tconst listFieldInit = {\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: pageSize,\r\n\t\tsort: -1,\r\n\t\tsortType: false,\r\n\r\n\t\tType: null,\r\n\t\tLevel: null,\r\n\t\tfromDate: '',\r\n\t\ttoDate: ''\r\n\t}\r\n\tlet refValue = useRef({\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: 10,\r\n\t\tsort: -1,\r\n\t\tsortType: false\r\n\t})\r\n\tconst [filters, setFilters] = useState(listFieldInit)\r\n\tconst paymentMethodOptionList = [\r\n\t\t{ label: 'Miễn phí', value: 1 },\r\n\t\t{ label: 'Cao cấp', value: 2 }\r\n\t]\r\n\tconst typeFilterList = [\r\n\t\t{\r\n\t\t\tvalue: 1,\r\n\t\t\ttitle: 'Miễn phí'\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: 2,\r\n\t\t\ttitle: 'Cao cấp'\r\n\t\t}\r\n\t]\r\n\tconst levelFilterList = [\r\n\t\t{\r\n\t\t\tvalue: 1,\r\n\t\t\ttitle: 'HSK 1'\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: 2,\r\n\t\t\ttitle: 'HSK 2'\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: 3,\r\n\t\t\ttitle: 'HSK 3'\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: 4,\r\n\t\t\ttitle: 'HSK 4'\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: 5,\r\n\t\t\ttitle: 'HSK 5'\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: 6,\r\n\t\t\ttitle: 'HSK 6'\r\n\t\t}\r\n\t]\r\n\t// SORT OPTION\r\n\tconst sortOptionList = [\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 0,\r\n\t\t\t\tsortType: true\r\n\t\t\t},\r\n\t\t\tvalue: 1,\r\n\t\t\ttext: 'Level tăng dần'\r\n\t\t},\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 0,\r\n\t\t\t\tsortType: false\r\n\t\t\t},\r\n\t\t\tvalue: 2,\r\n\t\t\ttext: 'Level giảm dần'\r\n\t\t},\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 1,\r\n\t\t\t\tsortType: true\r\n\t\t\t},\r\n\t\t\tvalue: 3,\r\n\t\t\ttext: 'Giá tăng dần'\r\n\t\t},\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 1,\r\n\t\t\t\tsortType: false\r\n\t\t\t},\r\n\t\t\tvalue: 4,\r\n\t\t\ttext: 'Giá giảm dần'\r\n\t\t}\r\n\t]\r\n\t// PAGINATION\r\n\tconst getPagination = (pageIndex: number, pageSize: number) => {\r\n\t\tif (!pageSize) pageSize = 10\r\n\t\trefValue.current = {\r\n\t\t\t...refValue.current,\r\n\t\t\tpageSize,\r\n\t\t\tpageIndex\r\n\t\t}\r\n\t\tsetFilters({\r\n\t\t\t...filters,\r\n\t\t\t...refValue.current\r\n\t\t})\r\n\t}\r\n\t// SORT\r\n\tconst onSort = (option) => {\r\n\t\trefValue.current = {\r\n\t\t\t...refValue.current,\r\n\t\t\tsort: option.title.sort,\r\n\t\t\tsortType: option.title.sortType\r\n\t\t}\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\t...refValue.current\r\n\t\t})\r\n\t}\r\n\r\n\t// FILTER\r\n\tconst onFilter = (obj) => {\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\t...refValue.current,\r\n\t\t\tpageIndex: 1,\r\n\t\t\t...obj\r\n\t\t})\r\n\t}\r\n\t// RESET SEARCH\r\n\tconst onResetSearch = () => {\r\n\t\tsetActiveColumnSearch('')\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\tpageSize: refValue.current.pageSize\r\n\t\t})\r\n\t}\r\n\t// ACTION SEARCH\r\n\tconst onSearch = (valueSearch, dataIndex) => {\r\n\t\tsetActiveColumnSearch(dataIndex)\r\n\t\tif (dataIndex === 'CreatedOn') {\r\n\t\t\tsetFilters({\r\n\t\t\t\t...listFieldInit,\r\n\t\t\t\t...refValue.current,\r\n\t\t\t\tpageIndex: 1,\r\n\t\t\t\t...valueSearch\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tsetFilters({\r\n\t\t\t\t...listFieldInit,\r\n\t\t\t\t...refValue.current,\r\n\t\t\t\tpageIndex: 1,\r\n\t\t\t\t[dataIndex]: valueSearch\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t// GET DATA IN FIRST TIME\r\n\tconst formatLevelPackage = (arr: number[]) => {\r\n\t\tif (arr && arr.length) {\r\n\t\t\tconst fmLevelOptionList = arr.map((l) => ({\r\n\t\t\t\ttitle: `Level ${l}`,\r\n\t\t\t\tvalue: l\r\n\t\t\t}))\r\n\t\t\tlevelOptionList.current = fmLevelOptionList\r\n\t\t}\r\n\t}\r\n\tconst fetchPackageList = async () => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'GET_ALL',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\t\ttry {\r\n\t\t\tlet res = await packageApi.getAll(filters)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tif (res.data.totalRow && res.data.data.length) {\r\n\t\t\t\t\tformatLevelPackage(res.data['ListLevel'])\r\n\t\t\t\t\tsetPackageList(res.data.data)\r\n\t\t\t\t\tsetTotalPage(res.data.totalRow)\r\n\t\t\t\t}\r\n\t\t\t} else if (res.status === 204) {\r\n\t\t\t\tshowNoti('danger', 'Không tìm thấy')\r\n\t\t\t\tsetPackageList([])\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst fetchLevelPackageList = async () => {\r\n\t\ttry {\r\n\t\t\tlet res = await packageApi.getAll(filters)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tformatLevelPackage(res.data['ListLevel'])\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t}\r\n\t}\r\n\tuseEffect(() => {\r\n\t\tfetchPackageList()\r\n\t}, [filters])\r\n\r\n\tconst onChangeStatus = async (checked: boolean, idRow: number, idx: number) => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'GET_ALL',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\t\ttry {\r\n\t\t\tlet dataChange = {\r\n\t\t\t\tID: idRow,\r\n\t\t\t\tEnable: checked\r\n\t\t\t}\r\n\t\t\tlet res = await packageApi.update(dataChange)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tconst newPackageList = [...packageList]\r\n\t\t\t\tconst newPackage = { ...packageList[idx], Enable: checked }\r\n\t\t\t\tnewPackageList.splice(idx, 1, newPackage)\r\n\t\t\t\tsetPackageList(newPackageList)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.Message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t// CREATE\r\n\tconst onCreatePackage = async (packageItem: {\r\n\t\tName: string\r\n\t\tLevel: number\r\n\t\tType: number\r\n\t\tAvatar: string\r\n\t\tPrice: string\r\n\t\tDescription: string\r\n\t}) => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'ADD_DATA',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\t\ttry {\r\n\t\t\tconst { Type, Price } = packageItem\r\n\t\t\tconst newPackageItem = {\r\n\t\t\t\t...packageItem,\r\n\t\t\t\tPrice: Type === 1 ? 0 : parseInt(Price.replace(/\\D/g, ''))\r\n\t\t\t}\r\n\t\t\tconst res = await packageApi.add(newPackageItem)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tshowNoti('success', res.data.message)\r\n\t\t\t\tonResetSearch() // <== khi tạo xong r reset search để trở về trang đầu tiên\r\n\t\t\t}\r\n\t\t\treturn res\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.Message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t// UPDATE\r\n\tconst onUpdatePackage = (idx: number) => {\r\n\t\treturn async (packageItem: IPackage) => {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: true\r\n\t\t\t})\r\n\t\t\ttry {\r\n\t\t\t\tconst { Type, Price, Level } = packageItem\r\n\t\t\t\tconst newPackageUpdate: IPackage = {\r\n\t\t\t\t\t...packageItem,\r\n\t\t\t\t\tPrice: Type === 1 ? 0 : parseInt(Price.toString().replace(/\\D/g, '')),\r\n\t\t\t\t\tTypeName: typeFilterList.find((t) => t.value === Type).title || ''\r\n\t\t\t\t}\r\n\t\t\t\tconst res = await packageApi.update(newPackageUpdate)\r\n\t\t\t\tif (res.status === 200) {\r\n\t\t\t\t\tconst newPackageList = [...packageList]\r\n\t\t\t\t\tnewPackageList.splice(idx, 1, newPackageUpdate)\r\n\t\t\t\t\tsetPackageList(newPackageList)\r\n\t\t\t\t\tfetchLevelPackageList()\r\n\t\t\t\t\tshowNoti('success', res.data.message)\r\n\t\t\t\t}\r\n\t\t\t\treturn res\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\t\tstatus: false\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Ảnh bìa',\r\n\t\t\tdataIndex: 'Avatar',\r\n\t\t\trender: (url) => {\r\n\t\t\t\tconsole.log(url)\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Image\r\n\t\t\t\t\t\twidth={70}\r\n\t\t\t\t\t\theight={70}\r\n\t\t\t\t\t\tsrc={url === '' ? '/images/default-book.jpeg' : url}\r\n\t\t\t\t\t\ttitle=\"Ảnh bìa bộ đề\"\r\n\t\t\t\t\t\talt=\"Ảnh bìa bộ đề\"\r\n\t\t\t\t\t\tstyle={{ objectFit: 'cover' }}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Tên bộ đề',\r\n\t\t\tdataIndex: 'Name'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Level',\r\n\t\t\tdataIndex: 'Level',\r\n\t\t\trender: (level) => `HSK ${level}`,\r\n\t\t\t...FilterColumn('Level', onSearch, onResetSearch, 'select', levelOptionList.current),\r\n\t\t\tclassName: activeColumnSearch === 'Level' ? 'active-column-search' : ''\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Loại',\r\n\t\t\tdataIndex: 'TypeName',\r\n\t\t\t...FilterColumn('Type', onSearch, onResetSearch, 'select', typeFilterList),\r\n\t\t\tclassName: activeColumnSearch === 'Type' ? 'active-column-search' : ''\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Giá',\r\n\t\t\tdataIndex: 'Price',\r\n\t\t\trender: (price) => (!price ? 0 : numberWithCommas(price))\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Ngày tạo bộ đề',\r\n\t\t\tdataIndex: 'CreatedOn',\r\n\t\t\t...FilterColumn('CreatedOn', onSearch, onResetSearch, 'date-range'),\r\n\t\t\trender: (date) => moment(date).format('DD/MM/YYYY'),\r\n\t\t\tclassName: activeColumnSearch === 'CreatedOn' ? 'active-column-search' : ''\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Trạng thái',\r\n\t\t\tdataIndex: 'Enable',\r\n\t\t\talign: 'center',\r\n\t\t\trender: (Enable: boolean, record: IPackage, idx: number) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<Switch\r\n\t\t\t\t\t\tcheckedChildren=\"Hiện\"\r\n\t\t\t\t\t\tunCheckedChildren=\"Ẩn\"\r\n\t\t\t\t\t\tchecked={Enable}\r\n\t\t\t\t\t\tsize=\"default\"\r\n\t\t\t\t\t\tonChange={(checked) => onChangeStatus(checked, record.ID, idx)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</>\r\n\t\t\t)\r\n\t\t},\r\n\t\t{\r\n\t\t\talign: 'center',\r\n\t\t\trender: (packageItem: IPackage, record, idx) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\thref={{\r\n\t\t\t\t\t\t\tpathname: '/package/package-list/package-list-detail/[slug]',\r\n\t\t\t\t\t\t\tquery: { slug: packageItem.ID }\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Tooltip title=\"Chi tiết\">\r\n\t\t\t\t\t\t\t<a className=\"btn btn-icon\">\r\n\t\t\t\t\t\t\t\t<Eye />\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t<PackageForm\r\n\t\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t\t\tisUpdate={true}\r\n\t\t\t\t\t\tupdateObj={packageItem}\r\n\t\t\t\t\t\thandleUpdatePackage={onUpdatePackage(idx)}\r\n\t\t\t\t\t\tpaymentMethodOptionList={paymentMethodOptionList}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</>\r\n\t\t\t)\r\n\t\t}\r\n\t]\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<PowerTable\r\n\t\t\t\tcurrentPage={filters.pageIndex}\r\n\t\t\t\ttotalPage={totalPage}\r\n\t\t\t\tgetPagination={getPagination}\r\n\t\t\t\tloading={isLoading}\r\n\t\t\t\tSize=\"package-list-table\"\r\n\t\t\t\taddClass=\"basic-header\"\r\n\t\t\t\tdataSource={packageList}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tTitlePage=\"Danh sách bộ đề\"\r\n\t\t\t\tExtra={\r\n\t\t\t\t\t<div className=\"extra-table\">\r\n\t\t\t\t\t\t<PackageFormFilterForm\r\n\t\t\t\t\t\t\thandleFilter={onFilter}\r\n\t\t\t\t\t\t\thandleResetFilter={onResetSearch}\r\n\t\t\t\t\t\t\toptionListForFilter={{\r\n\t\t\t\t\t\t\t\tlevelFilterList: levelFilterList,\r\n\t\t\t\t\t\t\t\ttypeFilterList: typeFilterList\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<SortBox dataOption={sortOptionList} handleSort={onSort} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t\tTitleCard={\r\n\t\t\t\t\t<PackageForm isLoading={isLoading} handleCreatePackage={onCreatePackage} paymentMethodOptionList={paymentMethodOptionList} />\r\n\t\t\t\t}\r\n\t\t\t/>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default Package\r\n"]},"metadata":{},"sourceType":"module"}