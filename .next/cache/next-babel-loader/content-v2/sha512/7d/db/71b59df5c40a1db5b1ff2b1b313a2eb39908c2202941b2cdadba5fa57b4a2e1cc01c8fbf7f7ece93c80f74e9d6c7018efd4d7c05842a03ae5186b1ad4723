{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\Package\\\\Package\\\\Package.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Image, Switch, Tooltip } from 'antd';\nimport moment from 'moment';\nimport Link from 'next/link';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Eye } from 'react-feather';\nimport { packageApi } from '~/apiBase';\nimport SortBox from '~/components/Elements/SortBox';\nimport PowerTable from '~/components/PowerTable';\nimport FilterColumn from '~/components/Tables/FilterColumn';\nimport { useWrap } from '~/context/wrap';\nimport { numberWithCommas } from '~/utils/functions';\nimport PackageForm from './PackageForm/PackageForm';\nimport PackageFormFilterForm from './PackageForm/PakageFormFilterForm';\nconst paymentMethodOptionList = [{\n  label: 'Miễn phí',\n  value: 1\n}, {\n  label: 'Cao cấp',\n  value: 2\n}];\nconst typeFilterList = [{\n  value: 1,\n  title: 'Miễn phí'\n}, {\n  value: 2,\n  title: 'Cao cấp'\n}];\nconst levelFilterList = [{\n  value: 1,\n  title: 'HSK 1'\n}, {\n  value: 2,\n  title: 'HSK 2'\n}, {\n  value: 3,\n  title: 'HSK 3'\n}, {\n  value: 4,\n  title: 'HSK 4'\n}, {\n  value: 5,\n  title: 'HSK 5'\n}, {\n  value: 6,\n  title: 'HSK 6'\n}];\nconst sortOptionList = [{\n  dataSort: {\n    sort: 0,\n    sortType: true\n  },\n  value: 1,\n  text: 'Level tăng dần'\n}, {\n  dataSort: {\n    sort: 0,\n    sortType: false\n  },\n  value: 2,\n  text: 'Level giảm dần'\n}, {\n  dataSort: {\n    sort: 1,\n    sortType: true\n  },\n  value: 3,\n  text: 'Giá tăng dần'\n}, {\n  dataSort: {\n    sort: 1,\n    sortType: false\n  },\n  value: 4,\n  text: 'Giá giảm dần'\n}];\nconst defaultRefValue = {\n  pageIndex: 1,\n  pageSize: 10,\n  sort: -1,\n  sortType: false\n};\n\nfunction Package() {\n  const {\n    showNoti,\n    pageSize\n  } = useWrap();\n  const levelOptionList = useRef([]);\n  const {\n    0: packageList,\n    1: setPackageList\n  } = useState([]);\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState({\n    type: '',\n    status: false\n  });\n  const {\n    0: totalPage,\n    1: setTotalPage\n  } = useState(null);\n  const {\n    0: activeColumnSearch,\n    1: setActiveColumnSearch\n  } = useState('');\n  const listFieldInit = {\n    pageIndex: 1,\n    pageSize: pageSize,\n    sort: -1,\n    sortType: false,\n    Type: null,\n    Level: null,\n    fromDate: '',\n    toDate: ''\n  };\n  let refValue = useRef(defaultRefValue);\n  const {\n    0: filters,\n    1: setFilters\n  } = useState(listFieldInit); // PAGINATION\n\n  const getPagination = (pageIndex, pageSize) => {\n    if (!pageSize) pageSize = 10;\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      pageSize,\n      pageIndex\n    });\n    setFilters(_objectSpread(_objectSpread({}, filters), refValue.current));\n  }; // SORT\n\n\n  const onSort = option => {\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      sort: option.title.sort,\n      sortType: option.title.sortType\n    });\n    setFilters(_objectSpread(_objectSpread({}, listFieldInit), refValue.current));\n  }; // FILTER\n\n\n  const onFilter = obj => {\n    setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, {\n      pageIndex: 1\n    }, obj));\n  }; // RESET SEARCH\n\n\n  const onResetSearch = () => {\n    setActiveColumnSearch('');\n    setFilters(_objectSpread(_objectSpread({}, listFieldInit), {}, {\n      pageSize: refValue.current.pageSize\n    }));\n  }; // ACTION SEARCH\n\n\n  const onSearch = (valueSearch, dataIndex) => {\n    setActiveColumnSearch(dataIndex);\n\n    if (dataIndex === 'CreatedOn') {\n      setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, {\n        pageIndex: 1\n      }, valueSearch));\n    } else {\n      setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, {\n        pageIndex: 1,\n        [dataIndex]: valueSearch\n      }));\n    }\n  }; // GET DATA IN FIRST TIME\n\n\n  const formatLevelPackage = arr => {\n    if (arr && arr.length) {\n      const fmLevelOptionList = arr.map(l => ({\n        title: `Level ${l}`,\n        value: l\n      }));\n      levelOptionList.current = fmLevelOptionList;\n    }\n  };\n\n  const fetchPackageList = async () => {\n    setIsLoading({\n      type: 'GET_ALL',\n      status: true\n    });\n\n    try {\n      let res = await packageApi.getAll(filters);\n\n      if (res.status === 200) {\n        if (res.data.totalRow && res.data.data.length) {\n          formatLevelPackage(res.data['ListLevel']);\n          setPackageList(res.data.data);\n          setTotalPage(res.data.totalRow);\n        }\n      } else if (res.status === 204) {\n        showNoti('danger', 'Không tìm thấy');\n        setPackageList([]);\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: false\n      });\n    }\n  };\n\n  const fetchLevelPackageList = async () => {\n    try {\n      let res = await packageApi.getAll(filters);\n\n      if (res.status === 200) {\n        formatLevelPackage(res.data['ListLevel']);\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    }\n  };\n\n  useEffect(() => {\n    fetchPackageList();\n  }, [filters]);\n\n  const onChangeStatus = async (checked, idRow, idx) => {\n    setIsLoading({\n      type: 'GET_ALL',\n      status: true\n    });\n\n    try {\n      let res = await packageApi.update({\n        ID: idRow,\n        Enable: checked\n      });\n\n      if (res.status === 200) {\n        const newPackageList = [...packageList];\n\n        const newPackage = _objectSpread(_objectSpread({}, packageList[idx]), {}, {\n          Enable: checked\n        });\n\n        newPackageList.splice(idx, 1, newPackage);\n        setPackageList(newPackageList);\n      }\n    } catch (error) {\n      showNoti('danger', error.Message);\n    } finally {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: false\n      });\n    }\n  }; // CREATE\n\n\n  const onCreatePackage = async packageItem => {\n    setIsLoading({\n      type: 'ADD_DATA',\n      status: true\n    });\n\n    try {\n      const {\n        Type,\n        Price\n      } = packageItem;\n\n      const newPackageItem = _objectSpread(_objectSpread({}, packageItem), {}, {\n        Price: Type === 1 ? 0 : parseInt(Price.replace(/\\D/g, ''))\n      });\n\n      const res = await packageApi.add(newPackageItem);\n\n      if (res.status === 200) {\n        showNoti('success', res.data.message);\n        onResetSearch();\n      }\n\n      return res;\n    } catch (error) {\n      showNoti('danger', error.Message);\n    } finally {\n      setIsLoading({\n        type: 'ADD_DATA',\n        status: false\n      });\n    }\n  }; // UPDATE\n\n\n  const onUpdatePackage = idx => {\n    return async packageItem => {\n      setIsLoading({\n        type: 'ADD_DATA',\n        status: true\n      });\n\n      try {\n        const {\n          Type,\n          Price,\n          Level\n        } = packageItem;\n\n        const newPackageUpdate = _objectSpread(_objectSpread({}, packageItem), {}, {\n          Price: Type === 1 ? 0 : parseInt(Price.toString().replace(/\\D/g, '')),\n          TypeName: typeFilterList.find(t => t.value === Type).title || ''\n        });\n\n        const res = await packageApi.update(newPackageUpdate);\n\n        if (res.status === 200) {\n          const newPackageList = [...packageList];\n          newPackageList.splice(idx, 1, newPackageUpdate);\n          setPackageList(newPackageList);\n          fetchLevelPackageList();\n          showNoti('success', res.data.message);\n        }\n\n        return res;\n      } catch (error) {\n        showNoti('danger', error.message);\n      } finally {\n        setIsLoading({\n          type: 'ADD_DATA',\n          status: false\n        });\n      }\n    };\n  };\n\n  const columns = [{\n    title: 'Ảnh bìa',\n    dataIndex: 'Avatar',\n    render: url => {\n      return /*#__PURE__*/_jsxDEV(Image, {\n        width: 70,\n        height: 70,\n        src: url === '' ? '/images/default-book.jpeg' : url,\n        title: \"\\u1EA2nh b\\xECa b\\u1ED9 \\u0111\\u1EC1\",\n        alt: \"\\u1EA2nh b\\xECa b\\u1ED9 \\u0111\\u1EC1\",\n        style: {\n          objectFit: 'cover'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 6\n      }, this);\n    }\n  }, {\n    title: 'Tên bộ đề',\n    dataIndex: 'Name'\n  }, _objectSpread(_objectSpread({\n    title: 'Loại',\n    dataIndex: 'TypeName'\n  }, FilterColumn('Type', onSearch, onResetSearch, 'select', typeFilterList)), {}, {\n    className: activeColumnSearch === 'Type' ? 'active-column-search' : ''\n  }), {\n    title: 'Giá',\n    dataIndex: 'Price',\n    render: price => !price ? 0 : numberWithCommas(price)\n  }, _objectSpread(_objectSpread({\n    title: 'Ngày tạo bộ đề',\n    dataIndex: 'CreatedOn'\n  }, FilterColumn('CreatedOn', onSearch, onResetSearch, 'date-range')), {}, {\n    render: date => moment(date).format('DD/MM/YYYY'),\n    className: activeColumnSearch === 'CreatedOn' ? 'active-column-search' : ''\n  }), {\n    title: 'Trạng thái',\n    dataIndex: 'Enable',\n    align: 'center',\n    render: (Enable, record, idx) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Switch, {\n        checkedChildren: \"Hi\\u1EC7n\",\n        unCheckedChildren: \"\\u1EA8n\",\n        checked: Enable,\n        size: \"default\",\n        onChange: checked => onChangeStatus(checked, record.ID, idx)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 6\n      }, this)\n    }, void 0, false)\n  }, {\n    align: 'center',\n    render: (packageItem, record, idx) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        href: {\n          pathname: '/package/package-list/package-list-detail/[slug]',\n          query: {\n            slug: packageItem.ID\n          }\n        },\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          title: \"Chi ti\\u1EBFt\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            className: \"btn btn-icon\",\n            children: /*#__PURE__*/_jsxDEV(Eye, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 344,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(PackageForm, {\n        isLoading: isLoading,\n        isUpdate: true,\n        updateObj: packageItem,\n        handleUpdatePackage: onUpdatePackage(idx),\n        paymentMethodOptionList: paymentMethodOptionList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true)\n  }];\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(PowerTable, {\n      currentPage: filters.pageIndex,\n      totalPage: totalPage,\n      getPagination: getPagination,\n      loading: isLoading,\n      Size: \"package-list-table\",\n      addClass: \"basic-header\",\n      dataSource: packageList,\n      columns: columns,\n      TitlePage: \"Danh s\\xE1ch b\\u1ED9 \\u0111\\u1EC1\",\n      Extra: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"extra-table\",\n        children: [/*#__PURE__*/_jsxDEV(PackageFormFilterForm, {\n          handleFilter: onFilter,\n          handleResetFilter: onResetSearch,\n          optionListForFilter: {\n            levelFilterList: levelFilterList,\n            typeFilterList: typeFilterList\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(SortBox, {\n          dataOption: sortOptionList,\n          handleSort: onSort\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 6\n      }, this),\n      TitleCard: /*#__PURE__*/_jsxDEV(PackageForm, {\n        isLoading: isLoading,\n        handleCreatePackage: onCreatePackage,\n        paymentMethodOptionList: paymentMethodOptionList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 362,\n      columnNumber: 4\n    }, this)\n  }, void 0, false);\n}\n\nexport default Package;","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/Package/Package/Package.tsx"],"names":["Image","Switch","Tooltip","moment","Link","React","useEffect","useRef","useState","Eye","packageApi","SortBox","PowerTable","FilterColumn","useWrap","numberWithCommas","PackageForm","PackageFormFilterForm","paymentMethodOptionList","label","value","typeFilterList","title","levelFilterList","sortOptionList","dataSort","sort","sortType","text","defaultRefValue","pageIndex","pageSize","Package","showNoti","levelOptionList","packageList","setPackageList","isLoading","setIsLoading","type","status","totalPage","setTotalPage","activeColumnSearch","setActiveColumnSearch","listFieldInit","Type","Level","fromDate","toDate","refValue","filters","setFilters","getPagination","current","onSort","option","onFilter","obj","onResetSearch","onSearch","valueSearch","dataIndex","formatLevelPackage","arr","length","fmLevelOptionList","map","l","fetchPackageList","res","getAll","data","totalRow","error","message","fetchLevelPackageList","onChangeStatus","checked","idRow","idx","update","ID","Enable","newPackageList","newPackage","splice","Message","onCreatePackage","packageItem","Price","newPackageItem","parseInt","replace","add","onUpdatePackage","newPackageUpdate","toString","TypeName","find","t","columns","render","url","objectFit","className","price","date","format","align","record","pathname","query","slug"],"mappings":"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","sourcesContent":["import { Image, Switch, Tooltip } from 'antd'\r\nimport moment from 'moment'\r\nimport Link from 'next/link'\r\nimport React, { useEffect, useRef, useState } from 'react'\r\nimport { Eye } from 'react-feather'\r\nimport { packageApi } from '~/apiBase'\r\nimport SortBox from '~/components/Elements/SortBox'\r\nimport PowerTable from '~/components/PowerTable'\r\nimport FilterColumn from '~/components/Tables/FilterColumn'\r\nimport { useWrap } from '~/context/wrap'\r\nimport { numberWithCommas } from '~/utils/functions'\r\nimport PackageForm from './PackageForm/PackageForm'\r\nimport PackageFormFilterForm from './PackageForm/PakageFormFilterForm'\r\n\r\nconst paymentMethodOptionList = [\r\n\t{ label: 'Miễn phí', value: 1 },\r\n\t{ label: 'Cao cấp', value: 2 }\r\n]\r\n\r\nconst typeFilterList = [\r\n\t{\r\n\t\tvalue: 1,\r\n\t\ttitle: 'Miễn phí'\r\n\t},\r\n\t{\r\n\t\tvalue: 2,\r\n\t\ttitle: 'Cao cấp'\r\n\t}\r\n]\r\n\r\nconst levelFilterList = [\r\n\t{\r\n\t\tvalue: 1,\r\n\t\ttitle: 'HSK 1'\r\n\t},\r\n\t{\r\n\t\tvalue: 2,\r\n\t\ttitle: 'HSK 2'\r\n\t},\r\n\t{\r\n\t\tvalue: 3,\r\n\t\ttitle: 'HSK 3'\r\n\t},\r\n\t{\r\n\t\tvalue: 4,\r\n\t\ttitle: 'HSK 4'\r\n\t},\r\n\t{\r\n\t\tvalue: 5,\r\n\t\ttitle: 'HSK 5'\r\n\t},\r\n\t{\r\n\t\tvalue: 6,\r\n\t\ttitle: 'HSK 6'\r\n\t}\r\n]\r\n\r\nconst sortOptionList = [\r\n\t{\r\n\t\tdataSort: {\r\n\t\t\tsort: 0,\r\n\t\t\tsortType: true\r\n\t\t},\r\n\t\tvalue: 1,\r\n\t\ttext: 'Level tăng dần'\r\n\t},\r\n\t{\r\n\t\tdataSort: {\r\n\t\t\tsort: 0,\r\n\t\t\tsortType: false\r\n\t\t},\r\n\t\tvalue: 2,\r\n\t\ttext: 'Level giảm dần'\r\n\t},\r\n\t{\r\n\t\tdataSort: {\r\n\t\t\tsort: 1,\r\n\t\t\tsortType: true\r\n\t\t},\r\n\t\tvalue: 3,\r\n\t\ttext: 'Giá tăng dần'\r\n\t},\r\n\t{\r\n\t\tdataSort: {\r\n\t\t\tsort: 1,\r\n\t\t\tsortType: false\r\n\t\t},\r\n\t\tvalue: 4,\r\n\t\ttext: 'Giá giảm dần'\r\n\t}\r\n]\r\n\r\nconst defaultRefValue = {\r\n\tpageIndex: 1,\r\n\tpageSize: 10,\r\n\tsort: -1,\r\n\tsortType: false\r\n}\r\n\r\ntype IPackageItem = {\r\n\tName: string\r\n\tLevel: number\r\n\tType: number\r\n\tAvatar: string\r\n\tPrice: string\r\n\tDescription: string\r\n}\r\n\r\nfunction Package() {\r\n\tconst { showNoti, pageSize } = useWrap()\r\n\r\n\tconst levelOptionList = useRef<IOptionCommon[]>([])\r\n\tconst [packageList, setPackageList] = useState<IPackage[]>([])\r\n\tconst [isLoading, setIsLoading] = useState({ type: '', status: false })\r\n\tconst [totalPage, setTotalPage] = useState(null)\r\n\tconst [activeColumnSearch, setActiveColumnSearch] = useState('')\r\n\r\n\tconst listFieldInit = {\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: pageSize,\r\n\t\tsort: -1,\r\n\t\tsortType: false,\r\n\t\tType: null,\r\n\t\tLevel: null,\r\n\t\tfromDate: '',\r\n\t\ttoDate: ''\r\n\t}\r\n\r\n\tlet refValue = useRef(defaultRefValue)\r\n\r\n\tconst [filters, setFilters] = useState(listFieldInit)\r\n\r\n\t// PAGINATION\r\n\tconst getPagination = (pageIndex: number, pageSize: number) => {\r\n\t\tif (!pageSize) pageSize = 10\r\n\t\trefValue.current = { ...refValue.current, pageSize, pageIndex }\r\n\t\tsetFilters({ ...filters, ...refValue.current })\r\n\t}\r\n\t// SORT\r\n\tconst onSort = (option) => {\r\n\t\trefValue.current = { ...refValue.current, sort: option.title.sort, sortType: option.title.sortType }\r\n\t\tsetFilters({ ...listFieldInit, ...refValue.current })\r\n\t}\r\n\r\n\t// FILTER\r\n\tconst onFilter = (obj) => {\r\n\t\tsetFilters({ ...listFieldInit, ...refValue.current, pageIndex: 1, ...obj })\r\n\t}\r\n\r\n\t// RESET SEARCH\r\n\tconst onResetSearch = () => {\r\n\t\tsetActiveColumnSearch('')\r\n\t\tsetFilters({ ...listFieldInit, pageSize: refValue.current.pageSize })\r\n\t}\r\n\r\n\t// ACTION SEARCH\r\n\tconst onSearch = (valueSearch, dataIndex) => {\r\n\t\tsetActiveColumnSearch(dataIndex)\r\n\t\tif (dataIndex === 'CreatedOn') {\r\n\t\t\tsetFilters({ ...listFieldInit, ...refValue.current, pageIndex: 1, ...valueSearch })\r\n\t\t} else {\r\n\t\t\tsetFilters({ ...listFieldInit, ...refValue.current, pageIndex: 1, [dataIndex]: valueSearch })\r\n\t\t}\r\n\t}\r\n\r\n\t// GET DATA IN FIRST TIME\r\n\tconst formatLevelPackage = (arr: number[]) => {\r\n\t\tif (arr && arr.length) {\r\n\t\t\tconst fmLevelOptionList = arr.map((l) => ({\r\n\t\t\t\ttitle: `Level ${l}`,\r\n\t\t\t\tvalue: l\r\n\t\t\t}))\r\n\t\t\tlevelOptionList.current = fmLevelOptionList\r\n\t\t}\r\n\t}\r\n\r\n\tconst fetchPackageList = async () => {\r\n\t\tsetIsLoading({ type: 'GET_ALL', status: true })\r\n\t\ttry {\r\n\t\t\tlet res = await packageApi.getAll(filters)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tif (res.data.totalRow && res.data.data.length) {\r\n\t\t\t\t\tformatLevelPackage(res.data['ListLevel'])\r\n\t\t\t\t\tsetPackageList(res.data.data)\r\n\t\t\t\t\tsetTotalPage(res.data.totalRow)\r\n\t\t\t\t}\r\n\t\t\t} else if (res.status === 204) {\r\n\t\t\t\tshowNoti('danger', 'Không tìm thấy')\r\n\t\t\t\tsetPackageList([])\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({ type: 'GET_ALL', status: false })\r\n\t\t}\r\n\t}\r\n\r\n\tconst fetchLevelPackageList = async () => {\r\n\t\ttry {\r\n\t\t\tlet res = await packageApi.getAll(filters)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tformatLevelPackage(res.data['ListLevel'])\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tfetchPackageList()\r\n\t}, [filters])\r\n\r\n\tconst onChangeStatus = async (checked: boolean, idRow: number, idx: number) => {\r\n\t\tsetIsLoading({ type: 'GET_ALL', status: true })\r\n\t\ttry {\r\n\t\t\tlet res = await packageApi.update({ ID: idRow, Enable: checked })\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tconst newPackageList = [...packageList]\r\n\t\t\t\tconst newPackage = { ...packageList[idx], Enable: checked }\r\n\t\t\t\tnewPackageList.splice(idx, 1, newPackage)\r\n\t\t\t\tsetPackageList(newPackageList)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.Message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({ type: 'GET_ALL', status: false })\r\n\t\t}\r\n\t}\r\n\r\n\t// CREATE\r\n\tconst onCreatePackage = async (packageItem: IPackageItem) => {\r\n\t\tsetIsLoading({ type: 'ADD_DATA', status: true })\r\n\t\ttry {\r\n\t\t\tconst { Type, Price } = packageItem\r\n\t\t\tconst newPackageItem = { ...packageItem, Price: Type === 1 ? 0 : parseInt(Price.replace(/\\D/g, '')) }\r\n\t\t\tconst res = await packageApi.add(newPackageItem)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tshowNoti('success', res.data.message)\r\n\t\t\t\tonResetSearch()\r\n\t\t\t}\r\n\t\t\treturn res\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.Message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({ type: 'ADD_DATA', status: false })\r\n\t\t}\r\n\t}\r\n\r\n\t// UPDATE\r\n\tconst onUpdatePackage = (idx: number) => {\r\n\t\treturn async (packageItem: IPackage) => {\r\n\t\t\tsetIsLoading({ type: 'ADD_DATA', status: true })\r\n\t\t\ttry {\r\n\t\t\t\tconst { Type, Price, Level } = packageItem\r\n\t\t\t\tconst newPackageUpdate: IPackage = {\r\n\t\t\t\t\t...packageItem,\r\n\t\t\t\t\tPrice: Type === 1 ? 0 : parseInt(Price.toString().replace(/\\D/g, '')),\r\n\t\t\t\t\tTypeName: typeFilterList.find((t) => t.value === Type).title || ''\r\n\t\t\t\t}\r\n\t\t\t\tconst res = await packageApi.update(newPackageUpdate)\r\n\t\t\t\tif (res.status === 200) {\r\n\t\t\t\t\tconst newPackageList = [...packageList]\r\n\t\t\t\t\tnewPackageList.splice(idx, 1, newPackageUpdate)\r\n\t\t\t\t\tsetPackageList(newPackageList)\r\n\t\t\t\t\tfetchLevelPackageList()\r\n\t\t\t\t\tshowNoti('success', res.data.message)\r\n\t\t\t\t}\r\n\t\t\t\treturn res\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({ type: 'ADD_DATA', status: false })\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Ảnh bìa',\r\n\t\t\tdataIndex: 'Avatar',\r\n\t\t\trender: (url) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Image\r\n\t\t\t\t\t\twidth={70}\r\n\t\t\t\t\t\theight={70}\r\n\t\t\t\t\t\tsrc={url === '' ? '/images/default-book.jpeg' : url}\r\n\t\t\t\t\t\ttitle=\"Ảnh bìa bộ đề\"\r\n\t\t\t\t\t\talt=\"Ảnh bìa bộ đề\"\r\n\t\t\t\t\t\tstyle={{ objectFit: 'cover' }}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Tên bộ đề',\r\n\t\t\tdataIndex: 'Name'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Loại',\r\n\t\t\tdataIndex: 'TypeName',\r\n\t\t\t...FilterColumn('Type', onSearch, onResetSearch, 'select', typeFilterList),\r\n\t\t\tclassName: activeColumnSearch === 'Type' ? 'active-column-search' : ''\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Giá',\r\n\t\t\tdataIndex: 'Price',\r\n\t\t\trender: (price) => (!price ? 0 : numberWithCommas(price))\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Ngày tạo bộ đề',\r\n\t\t\tdataIndex: 'CreatedOn',\r\n\t\t\t...FilterColumn('CreatedOn', onSearch, onResetSearch, 'date-range'),\r\n\t\t\trender: (date) => moment(date).format('DD/MM/YYYY'),\r\n\t\t\tclassName: activeColumnSearch === 'CreatedOn' ? 'active-column-search' : ''\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Trạng thái',\r\n\t\t\tdataIndex: 'Enable',\r\n\t\t\talign: 'center',\r\n\t\t\trender: (Enable: boolean, record: IPackage, idx: number) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<Switch\r\n\t\t\t\t\t\tcheckedChildren=\"Hiện\"\r\n\t\t\t\t\t\tunCheckedChildren=\"Ẩn\"\r\n\t\t\t\t\t\tchecked={Enable}\r\n\t\t\t\t\t\tsize=\"default\"\r\n\t\t\t\t\t\tonChange={(checked) => onChangeStatus(checked, record.ID, idx)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</>\r\n\t\t\t)\r\n\t\t},\r\n\t\t{\r\n\t\t\talign: 'center',\r\n\t\t\trender: (packageItem: IPackage, record, idx) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\thref={{\r\n\t\t\t\t\t\t\tpathname: '/package/package-list/package-list-detail/[slug]',\r\n\t\t\t\t\t\t\tquery: { slug: packageItem.ID }\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Tooltip title=\"Chi tiết\">\r\n\t\t\t\t\t\t\t<a className=\"btn btn-icon\">\r\n\t\t\t\t\t\t\t\t<Eye />\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t<PackageForm\r\n\t\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t\t\tisUpdate={true}\r\n\t\t\t\t\t\tupdateObj={packageItem}\r\n\t\t\t\t\t\thandleUpdatePackage={onUpdatePackage(idx)}\r\n\t\t\t\t\t\tpaymentMethodOptionList={paymentMethodOptionList}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</>\r\n\t\t\t)\r\n\t\t}\r\n\t]\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<PowerTable\r\n\t\t\t\tcurrentPage={filters.pageIndex}\r\n\t\t\t\ttotalPage={totalPage}\r\n\t\t\t\tgetPagination={getPagination}\r\n\t\t\t\tloading={isLoading}\r\n\t\t\t\tSize=\"package-list-table\"\r\n\t\t\t\taddClass=\"basic-header\"\r\n\t\t\t\tdataSource={packageList}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tTitlePage=\"Danh sách bộ đề\"\r\n\t\t\t\tExtra={\r\n\t\t\t\t\t<div className=\"extra-table\">\r\n\t\t\t\t\t\t<PackageFormFilterForm\r\n\t\t\t\t\t\t\thandleFilter={onFilter}\r\n\t\t\t\t\t\t\thandleResetFilter={onResetSearch}\r\n\t\t\t\t\t\t\toptionListForFilter={{\r\n\t\t\t\t\t\t\t\tlevelFilterList: levelFilterList,\r\n\t\t\t\t\t\t\t\ttypeFilterList: typeFilterList\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<SortBox dataOption={sortOptionList} handleSort={onSort} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t\tTitleCard={\r\n\t\t\t\t\t<PackageForm isLoading={isLoading} handleCreatePackage={onCreatePackage} paymentMethodOptionList={paymentMethodOptionList} />\r\n\t\t\t\t}\r\n\t\t\t/>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default Package\r\n"]},"metadata":{},"sourceType":"module"}