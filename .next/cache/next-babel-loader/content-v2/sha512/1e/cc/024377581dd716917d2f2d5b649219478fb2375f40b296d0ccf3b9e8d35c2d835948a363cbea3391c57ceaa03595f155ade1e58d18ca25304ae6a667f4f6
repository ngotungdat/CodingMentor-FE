{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\Option\\\\District\\\\District.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport moment from 'moment';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { areaApi, districtApi } from '~/apiBase';\nimport DeleteTableRow from '~/components/Elements/DeleteTableRow/DeleteTableRow';\nimport SortBox from '~/components/Elements/SortBox';\nimport PowerTable from '~/components/PowerTable';\nimport FilterColumn from '~/components/Tables/FilterColumn';\nimport { useWrap } from '~/context/wrap';\nimport { fmSelectArr } from '~/utils/functions';\nimport DistrictForm from './DistrictForm';\n\nvar District = function District() {\n  _s();\n\n  var _useState = useState([]),\n      districtList = _useState[0],\n      setDistrictList = _useState[1];\n\n  var _useState2 = useState({\n    type: '',\n    status: false\n  }),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(null),\n      totalPage = _useState3[0],\n      setTotalPage = _useState3[1];\n\n  var _useWrap = useWrap(),\n      showNoti = _useWrap.showNoti,\n      pageSize = _useWrap.pageSize;\n\n  var _useState4 = useState([]),\n      areaList = _useState4[0],\n      setAreaList = _useState4[1];\n\n  var _useState5 = useState(''),\n      activeColumnSearch = _useState5[0],\n      setActiveColumnSearch = _useState5[1]; // FILTER\n\n\n  var listFieldInit = {\n    pageIndex: 1,\n    pageSize: pageSize,\n    sort: -1,\n    sortType: false,\n    AreaName: '',\n    AreaID: null,\n    DistrictName: ''\n  };\n  var refValue = useRef({\n    pageIndex: 1,\n    pageSize: 10,\n    sort: -1,\n    sortType: false\n  });\n\n  var _useState6 = useState(listFieldInit),\n      filters = _useState6[0],\n      setFilters = _useState6[1]; // SORT OPTION\n\n\n  var sortOptionList = [{\n    dataSort: {\n      sort: 0,\n      sortType: true\n    },\n    value: 1,\n    text: 'Tỉnh/tp tăng dần'\n  }, {\n    dataSort: {\n      sort: 0,\n      sortType: false\n    },\n    value: 2,\n    text: 'Tỉnh/tp giảm dần'\n  }, {\n    dataSort: {\n      sort: 1,\n      sortType: true\n    },\n    value: 3,\n    text: 'Quận tăng dần'\n  }, {\n    dataSort: {\n      sort: 1,\n      sortType: false\n    },\n    value: 4,\n    text: 'Quận giảm dần'\n  }]; // PAGINATION\n\n  var getPagination = function getPagination(pageIndex, pageSize) {\n    if (!pageSize) pageSize = 10;\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      pageSize: pageSize,\n      pageIndex: pageIndex\n    });\n    setFilters(_objectSpread(_objectSpread({}, filters), refValue.current));\n  }; // SORT\n\n\n  var onSort = function onSort(option) {\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      sort: option.title.sort,\n      sortType: option.title.sortType\n    });\n    setFilters(_objectSpread(_objectSpread({}, listFieldInit), refValue.current));\n  }; // RESET SEARCH\n\n\n  var onResetSearch = function onResetSearch() {\n    setActiveColumnSearch('');\n    setFilters(_objectSpread(_objectSpread({}, listFieldInit), {}, {\n      pageSize: refValue.current.pageSize\n    }));\n  }; // ACTION SEARCH\n\n\n  var onSearch = function onSearch(valueSearch, dataIndex) {\n    setActiveColumnSearch(dataIndex);\n    setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, _defineProperty({\n      pageIndex: 1\n    }, dataIndex, valueSearch)));\n  }; // GET DATA IN FIRST TIME\n\n\n  var fetchDistrictList = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setIsLoading({\n                type: 'GET_ALL',\n                status: true\n              });\n              _context.prev = 1;\n              _context.next = 4;\n              return districtApi.getAll(filters);\n\n            case 4:\n              res = _context.sent;\n\n              if (res.status === 200) {\n                if (res.data.totalRow && res.data.data.length) {\n                  setDistrictList(res.data.data);\n                  setTotalPage(res.data.totalRow);\n                }\n              } else if (res.status === 204) {\n                showNoti('danger', 'Không tìm thấy');\n                setDistrictList([]);\n              }\n\n              _context.next = 11;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](1);\n              showNoti('danger', _context.t0.message);\n\n            case 11:\n              _context.prev = 11;\n              setIsLoading({\n                type: 'GET_ALL',\n                status: false\n              });\n              return _context.finish(11);\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 8, 11, 14]]);\n    }));\n\n    return function fetchDistrictList() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    fetchDistrictList();\n  }, [filters]);\n\n  var fetchAreaList = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var res, newAreaList;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setIsLoading({\n                type: 'GET_ALL',\n                status: true\n              });\n              _context2.prev = 1;\n              _context2.next = 4;\n              return areaApi.getAll({\n                selectall: true\n              });\n\n            case 4:\n              res = _context2.sent;\n\n              if (res.status === 200) {\n                newAreaList = fmSelectArr(res.data.data, 'AreaName', 'AreaID');\n                setAreaList(newAreaList);\n              }\n\n              _context2.next = 11;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](1);\n              showNoti('danger', _context2.t0.message);\n\n            case 11:\n              _context2.prev = 11;\n              setIsLoading({\n                type: 'GET_ALL',\n                status: false\n              });\n              return _context2.finish(11);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 8, 11, 14]]);\n    }));\n\n    return function fetchAreaList() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    fetchAreaList();\n  }, []); // CREATE\n\n  var onCreateDistrict = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(data) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: true\n              });\n              _context3.prev = 1;\n              _context3.next = 4;\n              return districtApi.add(_objectSpread(_objectSpread({}, data), {}, {\n                Enable: true\n              }));\n\n            case 4:\n              res = _context3.sent;\n              res.status === 200 && showNoti('success', res.data.message);\n              onResetSearch(); // <== khi tạo xong r trở về trang đầu tiên\n\n              _context3.next = 12;\n              break;\n\n            case 9:\n              _context3.prev = 9;\n              _context3.t0 = _context3[\"catch\"](1);\n              showNoti('danger', _context3.t0.message);\n\n            case 12:\n              _context3.prev = 12;\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: false\n              });\n              return _context3.finish(12);\n\n            case 15:\n              return _context3.abrupt(\"return\", res);\n\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[1, 9, 12, 15]]);\n    }));\n\n    return function onCreateDistrict(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }(); // UPDATE\n\n\n  var onUpdateDistrict = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(newObj, idx) {\n      var res, newDistrictList;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: true\n              });\n              _context4.prev = 1;\n              _context4.next = 4;\n              return districtApi.update(newObj);\n\n            case 4:\n              res = _context4.sent;\n\n              if (res.status === 200) {\n                newDistrictList = _toConsumableArray(districtList);\n                newDistrictList.splice(idx, 1, _objectSpread(_objectSpread({}, newObj), {}, {\n                  AreaName: areaList.find(function (a) {\n                    return a.value === newObj.AreaID;\n                  }).title\n                }));\n                setDistrictList(newDistrictList);\n                showNoti('success', res.data.message);\n              }\n\n              _context4.next = 11;\n              break;\n\n            case 8:\n              _context4.prev = 8;\n              _context4.t0 = _context4[\"catch\"](1);\n              showNoti('danger', _context4.t0.message);\n\n            case 11:\n              _context4.prev = 11;\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: false\n              });\n              return _context4.finish(11);\n\n            case 14:\n              return _context4.abrupt(\"return\", res);\n\n            case 15:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[1, 8, 11, 14]]);\n    }));\n\n    return function onUpdateDistrict(_x2, _x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }(); // DELETE\n\n\n  var onDeleteDistrict = function onDeleteDistrict(idx) {\n    return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var delObj, res;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              setIsLoading({\n                type: 'GET_ALL',\n                status: true\n              });\n              _context5.prev = 1;\n              delObj = districtList[idx];\n              _context5.next = 5;\n              return districtApi[\"delete\"](_objectSpread(_objectSpread({}, delObj), {}, {\n                Enable: false\n              }));\n\n            case 5:\n              res = _context5.sent;\n              res.status === 200 && showNoti('success', res.data.message);\n\n              if (!(districtList.length === 1)) {\n                _context5.next = 10;\n                break;\n              }\n\n              filters.pageIndex === 1 ? (setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, {\n                pageIndex: 1\n              })), setDistrictList([])) : setFilters(_objectSpread(_objectSpread(_objectSpread({}, filters), refValue.current), {}, {\n                pageIndex: filters.pageIndex - 1\n              }));\n              return _context5.abrupt(\"return\");\n\n            case 10:\n              fetchDistrictList();\n              _context5.next = 16;\n              break;\n\n            case 13:\n              _context5.prev = 13;\n              _context5.t0 = _context5[\"catch\"](1);\n              showNoti('danger', _context5.t0.message);\n\n            case 16:\n              _context5.prev = 16;\n              setIsLoading({\n                type: 'GET_ALL',\n                status: false\n              });\n              return _context5.finish(16);\n\n            case 19:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[1, 13, 16, 19]]);\n    }));\n  }; // COLUMN FOR TABLE\n\n\n  var columns = [_objectSpread(_objectSpread({\n    title: 'Tên tỉnh/thành phố',\n    dataIndex: 'AreaName'\n  }, FilterColumn('AreaID', onSearch, onResetSearch, 'select', areaList)), {}, {\n    className: activeColumnSearch === 'AreaID' ? 'active-column-search' : ''\n  }), _objectSpread(_objectSpread({\n    title: 'Tên quận',\n    dataIndex: 'DistrictName'\n  }, FilterColumn('DistrictName', onSearch, onResetSearch, 'text')), {}, {\n    className: activeColumnSearch === 'DistrictName' ? 'active-column-search' : ''\n  }), {\n    title: 'Ngày khởi tạo',\n    dataIndex: 'ModifiedOn',\n    render: function render(date) {\n      return moment(date).format('DD/MM/YYYY');\n    }\n  }, {\n    title: 'Được tạo bởi',\n    dataIndex: 'ModifiedBy'\n  }, {\n    align: 'center',\n    render: function render(value, _, idx) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: function onClick(e) {\n          return e.stopPropagation();\n        },\n        children: [/*#__PURE__*/_jsxDEV(DistrictForm, {\n          optionAreaList: areaList,\n          isLoading: isLoading,\n          isUpdate: true,\n          updateObj: value,\n          indexUpdateObj: idx,\n          handleUpdateDistrict: onUpdateDistrict\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 6\n        }, _this), /*#__PURE__*/_jsxDEV(DeleteTableRow, {\n          handleDelete: onDeleteDistrict(idx)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 6\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 5\n      }, _this);\n    }\n  }]; // RETURN\n\n  return /*#__PURE__*/_jsxDEV(PowerTable, {\n    currentPage: filters.pageIndex,\n    totalPage: totalPage,\n    getPagination: getPagination,\n    loading: isLoading,\n    addClass: \"basic-header\",\n    TitlePage: \"Danh s\\xE1ch qu\\u1EADn - huy\\u1EC7n\",\n    TitleCard: /*#__PURE__*/_jsxDEV(DistrictForm, {\n      optionAreaList: areaList,\n      isLoading: isLoading,\n      isUpdate: false,\n      handleCreateDistrict: onCreateDistrict\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 5\n    }, _this),\n    dataSource: districtList,\n    columns: columns,\n    Extra: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"extra-table\",\n      children: /*#__PURE__*/_jsxDEV(SortBox, {\n        handleSort: onSort,\n        dataOption: sortOptionList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 6\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 5\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 307,\n    columnNumber: 3\n  }, _this);\n};\n\n_s(District, \"TfgzuGKJVznejxmjVfHOEsHf8rI=\", false, function () {\n  return [useWrap];\n});\n\n_c = District;\nexport default District;\n\nvar _c;\n\n$RefreshReg$(_c, \"District\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/Option/District/District.tsx"],"names":["moment","React","useEffect","useRef","useState","areaApi","districtApi","DeleteTableRow","SortBox","PowerTable","FilterColumn","useWrap","fmSelectArr","DistrictForm","District","districtList","setDistrictList","type","status","isLoading","setIsLoading","totalPage","setTotalPage","showNoti","pageSize","areaList","setAreaList","activeColumnSearch","setActiveColumnSearch","listFieldInit","pageIndex","sort","sortType","AreaName","AreaID","DistrictName","refValue","filters","setFilters","sortOptionList","dataSort","value","text","getPagination","current","onSort","option","title","onResetSearch","onSearch","valueSearch","dataIndex","fetchDistrictList","getAll","res","data","totalRow","length","message","fetchAreaList","selectall","newAreaList","onCreateDistrict","add","Enable","onUpdateDistrict","newObj","idx","update","newDistrictList","splice","find","a","onDeleteDistrict","delObj","columns","className","render","date","format","align","_","e","stopPropagation"],"mappings":"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","sourcesContent":["import moment from 'moment';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { areaApi, districtApi } from '~/apiBase';\r\nimport DeleteTableRow from '~/components/Elements/DeleteTableRow/DeleteTableRow';\r\nimport SortBox from '~/components/Elements/SortBox';\r\nimport PowerTable from '~/components/PowerTable';\r\nimport FilterColumn from '~/components/Tables/FilterColumn';\r\nimport { useWrap } from '~/context/wrap';\r\nimport { fmSelectArr } from '~/utils/functions';\r\nimport DistrictForm from './DistrictForm';\r\n\r\nconst District = () => {\r\n\tconst [districtList, setDistrictList] = useState<IDistrict[]>([]);\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: '',\r\n\t\tstatus: false\r\n\t});\r\n\tconst [totalPage, setTotalPage] = useState(null);\r\n\tconst { showNoti, pageSize } = useWrap();\r\n\tconst [areaList, setAreaList] = useState([]);\r\n\tconst [activeColumnSearch, setActiveColumnSearch] = useState('');\r\n\t// FILTER\r\n\tconst listFieldInit = {\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: pageSize,\r\n\t\tsort: -1,\r\n\t\tsortType: false,\r\n\t\tAreaName: '',\r\n\t\tAreaID: null,\r\n\t\tDistrictName: ''\r\n\t};\r\n\tlet refValue = useRef({\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: 10,\r\n\t\tsort: -1,\r\n\t\tsortType: false\r\n\t});\r\n\tconst [filters, setFilters] = useState(listFieldInit);\r\n\t// SORT OPTION\r\n\tconst sortOptionList = [\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 0,\r\n\t\t\t\tsortType: true\r\n\t\t\t},\r\n\t\t\tvalue: 1,\r\n\t\t\ttext: 'Tỉnh/tp tăng dần'\r\n\t\t},\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 0,\r\n\t\t\t\tsortType: false\r\n\t\t\t},\r\n\t\t\tvalue: 2,\r\n\t\t\ttext: 'Tỉnh/tp giảm dần'\r\n\t\t},\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 1,\r\n\t\t\t\tsortType: true\r\n\t\t\t},\r\n\t\t\tvalue: 3,\r\n\t\t\ttext: 'Quận tăng dần'\r\n\t\t},\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 1,\r\n\t\t\t\tsortType: false\r\n\t\t\t},\r\n\t\t\tvalue: 4,\r\n\t\t\ttext: 'Quận giảm dần'\r\n\t\t}\r\n\t];\r\n\t// PAGINATION\r\n\tconst getPagination = (pageIndex: number, pageSize: number) => {\r\n\t\tif (!pageSize) pageSize = 10;\r\n\t\trefValue.current = {\r\n\t\t\t...refValue.current,\r\n\t\t\tpageSize,\r\n\t\t\tpageIndex\r\n\t\t};\r\n\t\tsetFilters({\r\n\t\t\t...filters,\r\n\t\t\t...refValue.current\r\n\t\t});\r\n\t};\r\n\t// SORT\r\n\tconst onSort = (option) => {\r\n\t\trefValue.current = {\r\n\t\t\t...refValue.current,\r\n\t\t\tsort: option.title.sort,\r\n\t\t\tsortType: option.title.sortType\r\n\t\t};\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\t...refValue.current\r\n\t\t});\r\n\t};\r\n\t// RESET SEARCH\r\n\tconst onResetSearch = () => {\r\n\t\tsetActiveColumnSearch('');\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\tpageSize: refValue.current.pageSize\r\n\t\t});\r\n\t};\r\n\t// ACTION SEARCH\r\n\tconst onSearch = (valueSearch, dataIndex) => {\r\n\t\tsetActiveColumnSearch(dataIndex);\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\t...refValue.current,\r\n\t\t\tpageIndex: 1,\r\n\t\t\t[dataIndex]: valueSearch\r\n\t\t});\r\n\t};\r\n\t// GET DATA IN FIRST TIME\r\n\tconst fetchDistrictList = async () => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'GET_ALL',\r\n\t\t\tstatus: true\r\n\t\t});\r\n\t\ttry {\r\n\t\t\tlet res = await districtApi.getAll(filters);\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tif (res.data.totalRow && res.data.data.length) {\r\n\t\t\t\t\tsetDistrictList(res.data.data);\r\n\t\t\t\t\tsetTotalPage(res.data.totalRow);\r\n\t\t\t\t}\r\n\t\t\t} else if (res.status === 204) {\r\n\t\t\t\tshowNoti('danger', 'Không tìm thấy');\r\n\t\t\t\tsetDistrictList([]);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\tuseEffect(() => {\r\n\t\tfetchDistrictList();\r\n\t}, [filters]);\r\n\tconst fetchAreaList = async () => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'GET_ALL',\r\n\t\t\tstatus: true\r\n\t\t});\r\n\t\ttry {\r\n\t\t\tlet res = await areaApi.getAll({\r\n\t\t\t\tselectall: true\r\n\t\t\t});\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tconst newAreaList = fmSelectArr(res.data.data, 'AreaName', 'AreaID');\r\n\t\t\t\tsetAreaList(newAreaList);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\tuseEffect(() => {\r\n\t\tfetchAreaList();\r\n\t}, []);\r\n\r\n\t// CREATE\r\n\tconst onCreateDistrict = async (data: any) => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'ADD_DATA',\r\n\t\t\tstatus: true\r\n\t\t});\r\n\t\tlet res;\r\n\t\ttry {\r\n\t\t\tres = await districtApi.add({\r\n\t\t\t\t...data,\r\n\t\t\t\tEnable: true\r\n\t\t\t});\r\n\t\t\tres.status === 200 && showNoti('success', res.data.message);\r\n\t\t\tonResetSearch(); // <== khi tạo xong r trở về trang đầu tiên\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: false\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\t// UPDATE\r\n\tconst onUpdateDistrict = async (newObj: any, idx: number) => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'ADD_DATA',\r\n\t\t\tstatus: true\r\n\t\t});\r\n\t\tlet res;\r\n\t\ttry {\r\n\t\t\tres = await districtApi.update(newObj);\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tconst newDistrictList = [...districtList];\r\n\t\t\t\tnewDistrictList.splice(idx, 1, {\r\n\t\t\t\t\t...newObj,\r\n\t\t\t\t\tAreaName: areaList.find((a) => a.value === newObj.AreaID).title\r\n\t\t\t\t});\r\n\t\t\t\tsetDistrictList(newDistrictList);\r\n\t\t\t\tshowNoti('success', res.data.message);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: false\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\t// DELETE\r\n\tconst onDeleteDistrict = (idx: number) => {\r\n\t\treturn async () => {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: true\r\n\t\t\t});\r\n\t\t\ttry {\r\n\t\t\t\tconst delObj = districtList[idx];\r\n\t\t\t\tconst res = await districtApi.delete({\r\n\t\t\t\t\t...delObj,\r\n\t\t\t\t\tEnable: false\r\n\t\t\t\t});\r\n\t\t\t\tres.status === 200 && showNoti('success', res.data.message);\r\n\t\t\t\tif (districtList.length === 1) {\r\n\t\t\t\t\tfilters.pageIndex === 1\r\n\t\t\t\t\t\t? (setFilters({\r\n\t\t\t\t\t\t\t\t...listFieldInit,\r\n\t\t\t\t\t\t\t\t...refValue.current,\r\n\t\t\t\t\t\t\t\tpageIndex: 1\r\n\t\t\t\t\t\t  }),\r\n\t\t\t\t\t\t  setDistrictList([]))\r\n\t\t\t\t\t\t: setFilters({\r\n\t\t\t\t\t\t\t\t...filters,\r\n\t\t\t\t\t\t\t\t...refValue.current,\r\n\t\t\t\t\t\t\t\tpageIndex: filters.pageIndex - 1\r\n\t\t\t\t\t\t  });\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tfetchDistrictList();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message);\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\t\tstatus: false\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\t// COLUMN FOR TABLE\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Tên tỉnh/thành phố',\r\n\t\t\tdataIndex: 'AreaName',\r\n\t\t\t...FilterColumn('AreaID', onSearch, onResetSearch, 'select', areaList),\r\n\t\t\tclassName: activeColumnSearch === 'AreaID' ? 'active-column-search' : ''\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Tên quận',\r\n\t\t\tdataIndex: 'DistrictName',\r\n\t\t\t...FilterColumn('DistrictName', onSearch, onResetSearch, 'text'),\r\n\t\t\tclassName: activeColumnSearch === 'DistrictName' ? 'active-column-search' : ''\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Ngày khởi tạo',\r\n\t\t\tdataIndex: 'ModifiedOn',\r\n\t\t\trender: (date) => moment(date).format('DD/MM/YYYY')\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Được tạo bởi',\r\n\t\t\tdataIndex: 'ModifiedBy'\r\n\t\t},\r\n\r\n\t\t{\r\n\t\t\talign: 'center',\r\n\t\t\trender: (value, _, idx) => (\r\n\t\t\t\t<div onClick={(e) => e.stopPropagation()}>\r\n\t\t\t\t\t<DistrictForm\r\n\t\t\t\t\t\toptionAreaList={areaList}\r\n\t\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t\t\tisUpdate={true}\r\n\t\t\t\t\t\tupdateObj={value}\r\n\t\t\t\t\t\tindexUpdateObj={idx}\r\n\t\t\t\t\t\thandleUpdateDistrict={onUpdateDistrict}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<DeleteTableRow handleDelete={onDeleteDistrict(idx)} />\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t\t}\r\n\t];\r\n\t// RETURN\r\n\treturn (\r\n\t\t<PowerTable\r\n\t\t\tcurrentPage={filters.pageIndex}\r\n\t\t\ttotalPage={totalPage}\r\n\t\t\tgetPagination={getPagination}\r\n\t\t\tloading={isLoading}\r\n\t\t\taddClass=\"basic-header\"\r\n\t\t\tTitlePage=\"Danh sách quận - huyện\"\r\n\t\t\tTitleCard={\r\n\t\t\t\t<DistrictForm optionAreaList={areaList} isLoading={isLoading} isUpdate={false} handleCreateDistrict={onCreateDistrict} />\r\n\t\t\t}\r\n\t\t\tdataSource={districtList}\r\n\t\t\tcolumns={columns}\r\n\t\t\tExtra={\r\n\t\t\t\t<div className=\"extra-table\">\r\n\t\t\t\t\t<SortBox handleSort={onSort} dataOption={sortOptionList} />\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t/>\r\n\t);\r\n};\r\n\r\nexport default District;\r\n"]},"metadata":{},"sourceType":"module"}