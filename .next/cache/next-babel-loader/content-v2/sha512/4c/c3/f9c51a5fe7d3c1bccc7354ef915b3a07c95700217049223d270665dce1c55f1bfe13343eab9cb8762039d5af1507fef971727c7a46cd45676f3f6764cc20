{"ast":null,"code":"import _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\Customer\\\\Student\\\\StudentAdvisory\\\\StudentAdvisoryNote.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport NestedTable from '~/components/Elements/NestedTable';\nimport moment from 'moment';\nimport { FormOutlined } from '@ant-design/icons';\nimport { Modal, Tooltip, Input, Spin } from 'antd';\nimport { studentAdviseApi } from '~/apiBase';\nimport { useWrap } from '~/context/wrap';\nvar TextArea = Input.TextArea;\n\nvar StudentAdvisoryNote = function StudentAdvisoryNote(props) {\n  _s();\n\n  var _useWrap = useWrap(),\n      showNoti = _useWrap.showNoti;\n\n  var dataSource = props.dataSource,\n      userID = props.userID,\n      onFetchData = props.onFetchData;\n\n  var _useState = useState(false),\n      isModalVisible = _useState[0],\n      setIsModalVisible = _useState[1];\n\n  var _useState2 = useState(null),\n      valueNote = _useState2[0],\n      setValueNote = _useState2[1];\n\n  var _useState3 = useState(false),\n      loading = _useState3[0],\n      setLoading = _useState3[1];\n\n  var _useState4 = useState(null),\n      activeData = _useState4[0],\n      setActiveData = _useState4[1];\n\n  var columns = [{\n    title: 'Ghi chú',\n    dataIndex: 'Note'\n  }, {\n    title: 'Tạo ngày',\n    dataIndex: 'CreatedOn',\n    render: function render(date) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        children: moment(date).format('DD/MM/YYYY HH:mm')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 22\n      }, _this);\n    }\n  }, {\n    title: 'Người tạo',\n    dataIndex: 'CreatedBy'\n  }, {\n    render: function render(data) {\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-icon edit\",\n        onClick: function onClick() {\n          return showModal(data);\n        },\n        children: /*#__PURE__*/_jsxDEV(FormOutlined, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 6\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 5\n      }, _this);\n    }\n  }];\n\n  var addNote = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              res = null;\n              _context.prev = 2;\n\n              if (!activeData) {\n                _context.next = 9;\n                break;\n              }\n\n              _context.next = 6;\n              return studentAdviseApi.updateNote({\n                ID: activeData.ID,\n                Note: valueNote\n              });\n\n            case 6:\n              res = _context.sent;\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.next = 11;\n              return studentAdviseApi.addNote({\n                CustomerConsultationID: userID,\n                Note: valueNote\n              });\n\n            case 11:\n              res = _context.sent;\n\n            case 12:\n              if (res.status == 200) {\n                showNoti('success', activeData ? 'Cập nhật ghi chú thành công' : 'Thêm ghi chú thành công');\n                setIsModalVisible(false);\n                onFetchData && onFetchData();\n                setActiveData(null);\n              }\n\n              _context.next = 18;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](2);\n              showNoti('danger', _context.t0.message);\n\n            case 18:\n              _context.prev = 18;\n              setLoading(false);\n              return _context.finish(18);\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 15, 18, 21]]);\n    }));\n\n    return function addNote() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var showModal = function showModal(dataRow) {\n    setIsModalVisible(true);\n\n    if (dataRow) {\n      setActiveData(dataRow);\n      setValueNote(dataRow.Note);\n    } else {\n      setActiveData(null);\n    }\n  };\n\n  var handleOk = function handleOk() {\n    setIsModalVisible(false);\n  };\n\n  var handleCancel = function handleCancel() {\n    setIsModalVisible(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mt-2\",\n    children: [/*#__PURE__*/_jsxDEV(Modal, {\n      footer: null,\n      title: \"Th\\xEAm ghi ch\\xFA\",\n      visible: isModalVisible,\n      onOk: handleOk,\n      onCancel: handleCancel,\n      children: [/*#__PURE__*/_jsxDEV(TextArea, {\n        value: valueNote,\n        onChange: function onChange(e) {\n          return setValueNote(e.target.value);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 5\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center mt-3\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary w-100\",\n          onClick: addNote,\n          children: [\"L\\u01B0u \", loading && /*#__PURE__*/_jsxDEV(Spin, {\n            className: \"loading-base\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 23\n          }, _this), ' ']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 6\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 5\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 4\n    }, _this), /*#__PURE__*/_jsxDEV(Tooltip, {\n      title: \"Th\\xEAm ghi ch\\xFA\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-warning\",\n        onClick: function onClick() {\n          return showModal(null);\n        },\n        children: \"Th\\xEAm ghi ch\\xFA\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 5\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 4\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-7\",\n        children: /*#__PURE__*/_jsxDEV(NestedTable, {\n          onFetchData: onFetchData,\n          addClass: \"basic-header\",\n          dataSource: dataSource,\n          columns: columns,\n          haveBorder: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 6\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 5\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 4\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 3\n  }, _this);\n};\n\n_s(StudentAdvisoryNote, \"JF8HDIYWJFu9v8k1gsN/bEseoTs=\", false, function () {\n  return [useWrap];\n});\n\n_c = StudentAdvisoryNote;\nexport default StudentAdvisoryNote;\n\nvar _c;\n\n$RefreshReg$(_c, \"StudentAdvisoryNote\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/Customer/Student/StudentAdvisory/StudentAdvisoryNote.tsx"],"names":["React","useState","NestedTable","moment","FormOutlined","Modal","Tooltip","Input","Spin","studentAdviseApi","useWrap","TextArea","StudentAdvisoryNote","props","showNoti","dataSource","userID","onFetchData","isModalVisible","setIsModalVisible","valueNote","setValueNote","loading","setLoading","activeData","setActiveData","columns","title","dataIndex","render","date","format","data","showModal","addNote","res","updateNote","ID","Note","CustomerConsultationID","status","message","dataRow","handleOk","handleCancel","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport NestedTable from '~/components/Elements/NestedTable';\r\nimport moment from 'moment';\r\nimport { FormOutlined, PlusOutlined } from '@ant-design/icons';\r\nimport { Modal, Tooltip, Input, Spin } from 'antd';\r\nimport { studentAdviseApi } from '~/apiBase';\r\nimport { useWrap } from '~/context/wrap';\r\n\r\nconst { TextArea } = Input;\r\n\r\nconst StudentAdvisoryNote = (props) => {\r\n\tconst { showNoti } = useWrap();\r\n\tconst { dataSource, userID, onFetchData } = props;\r\n\tconst [isModalVisible, setIsModalVisible] = useState(false);\r\n\tconst [valueNote, setValueNote] = useState(null);\r\n\tconst [loading, setLoading] = useState(false);\r\n\tconst [activeData, setActiveData] = useState(null);\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Ghi chú',\r\n\t\t\tdataIndex: 'Note'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Tạo ngày',\r\n\t\t\tdataIndex: 'CreatedOn',\r\n\t\t\trender: (date) => <p>{moment(date).format('DD/MM/YYYY HH:mm')}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Người tạo',\r\n\t\t\tdataIndex: 'CreatedBy'\r\n\t\t},\r\n\t\t{\r\n\t\t\trender: (data) => (\r\n\t\t\t\t<button className=\"btn btn-icon edit\" onClick={() => showModal(data)}>\r\n\t\t\t\t\t<FormOutlined />\r\n\t\t\t\t</button>\r\n\t\t\t)\r\n\t\t}\r\n\t];\r\n\r\n\tconst addNote = async () => {\r\n\t\tsetLoading(true);\r\n\t\tlet res = null;\r\n\t\ttry {\r\n\t\t\tif (activeData) {\r\n\t\t\t\tres = await studentAdviseApi.updateNote({\r\n\t\t\t\t\tID: activeData.ID,\r\n\t\t\t\t\tNote: valueNote\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tres = await studentAdviseApi.addNote({\r\n\t\t\t\t\tCustomerConsultationID: userID,\r\n\t\t\t\t\tNote: valueNote\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (res.status == 200) {\r\n\t\t\t\tshowNoti('success', activeData ? 'Cập nhật ghi chú thành công' : 'Thêm ghi chú thành công');\r\n\t\t\t\tsetIsModalVisible(false);\r\n\t\t\t\tonFetchData && onFetchData();\r\n\t\t\t\tsetActiveData(null);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst showModal = (dataRow) => {\r\n\t\tsetIsModalVisible(true);\r\n\t\tif (dataRow) {\r\n\t\t\tsetActiveData(dataRow);\r\n\t\t\tsetValueNote(dataRow.Note);\r\n\t\t} else {\r\n\t\t\tsetActiveData(null);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleOk = () => {\r\n\t\tsetIsModalVisible(false);\r\n\t};\r\n\r\n\tconst handleCancel = () => {\r\n\t\tsetIsModalVisible(false);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"mt-2\">\r\n\t\t\t<Modal footer={null} title=\"Thêm ghi chú\" visible={isModalVisible} onOk={handleOk} onCancel={handleCancel}>\r\n\t\t\t\t<TextArea value={valueNote} onChange={(e) => setValueNote(e.target.value)} />\r\n\t\t\t\t<div className=\"text-center mt-3\">\r\n\t\t\t\t\t<button className=\"btn btn-primary w-100\" onClick={addNote}>\r\n\t\t\t\t\t\tLưu {loading && <Spin className=\"loading-base\" />}{' '}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t\t<Tooltip title=\"Thêm ghi chú\">\r\n\t\t\t\t<button className=\"btn btn-warning\" onClick={() => showModal(null)}>\r\n\t\t\t\t\tThêm ghi chú\r\n\t\t\t\t</button>\r\n\t\t\t</Tooltip>\r\n\t\t\t<div className=\"row\">\r\n\t\t\t\t<div className=\"col-md-7\">\r\n\t\t\t\t\t<NestedTable\r\n\t\t\t\t\t\tonFetchData={onFetchData}\r\n\t\t\t\t\t\taddClass=\"basic-header\"\r\n\t\t\t\t\t\tdataSource={dataSource}\r\n\t\t\t\t\t\tcolumns={columns}\r\n\t\t\t\t\t\thaveBorder={true}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default StudentAdvisoryNote;\r\n"]},"metadata":{},"sourceType":"module"}