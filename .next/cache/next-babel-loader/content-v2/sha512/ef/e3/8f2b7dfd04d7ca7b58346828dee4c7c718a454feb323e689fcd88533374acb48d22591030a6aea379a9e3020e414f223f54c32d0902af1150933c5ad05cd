{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\Sales\\\\SalesCampaign\\\\SalesCampaign.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Tooltip } from 'antd';\nimport moment from 'moment';\nimport Link from 'next/link';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Eye } from 'react-feather';\nimport { saleCampaignApi } from '~/apiBase';\nimport SortBox from '~/components/Elements/SortBox';\nimport ExpandTable from '~/components/ExpandTable';\nimport FilterColumn from '~/components/Tables/FilterColumn';\nimport { useWrap } from '~/context/wrap';\nimport { numberWithCommas, parsePriceStrToNumber } from '~/utils/functions';\nimport SalesCampaignFilter from './SalesCampaignFilter';\nimport SalesCampaignForm from './SalesCampaignForm';\n\nconst SalesCampaign = () => {\n  const {\n    0: saleCampaignList,\n    1: setSaleCampaignList\n  } = useState([]);\n  const {\n    showNoti,\n    isAdmin\n  } = useWrap();\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState({\n    type: '',\n    status: false\n  });\n  const {\n    0: totalPage,\n    1: setTotalPage\n  } = useState(null);\n  const optionStatusList = [//2-Đang hoạt động 3-Tạm ngưng 4-Kết thúc\n  {\n    title: 'Đang hoạt động',\n    value: 2\n  }, {\n    title: 'Tạm ngưng',\n    value: 3\n  }];\n  const sortOptionList = [{\n    dataSort: {\n      sort: 0,\n      sortType: true\n    },\n    value: 1,\n    text: 'Ngày bắt đầu tăng dần'\n  }, {\n    dataSort: {\n      sort: 0,\n      sortType: false\n    },\n    value: 2,\n    text: 'Ngày bắt đầu giảm dần'\n  }, {\n    dataSort: {\n      sort: 1,\n      sortType: true\n    },\n    value: 3,\n    text: 'Ngày kết thúc tăng dần'\n  }, {\n    dataSort: {\n      sort: 1,\n      sortType: false\n    },\n    value: 4,\n    text: 'Ngày kết thúc giảm dần'\n  }]; // FILTER\n\n  const listFieldInit = {\n    pageIndex: 1,\n    pageSize: 10,\n    sort: -1,\n    sortType: false,\n    StatusID: null,\n    Time: ''\n  };\n  let refValue = useRef({\n    pageIndex: 1,\n    pageSize: 10,\n    sort: -1,\n    sortType: false\n  });\n  const {\n    0: filters,\n    1: setFilters\n  } = useState(listFieldInit); // FILTER\n\n  const onFilter = obj => {\n    setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, {\n      pageIndex: 1,\n      Time: moment(obj.Time).format('YYYY/MM/DD')\n    }));\n  }; // PAGINATION\n\n\n  const getPagination = (pageIndex, pageSize) => {\n    if (!pageSize) pageSize = 10;\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      pageSize,\n      pageIndex\n    });\n    setFilters(_objectSpread(_objectSpread({}, filters), refValue.current));\n  }; // SORT\n\n\n  const onSort = option => {\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      sort: option.title.sort,\n      sortType: option.title.sortType\n    });\n    setFilters(_objectSpread(_objectSpread({}, listFieldInit), refValue.current));\n  }; // RESET SEARCH\n\n\n  const onResetSearch = () => {\n    setFilters(_objectSpread(_objectSpread({}, listFieldInit), {}, {\n      pageSize: refValue.current.pageSize\n    }));\n  }; // ACTION SEARCH\n\n\n  const onSearch = (valueSearch, dataIndex) => {\n    setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, {\n      pageIndex: 1,\n      [dataIndex]: valueSearch\n    }));\n  }; // GET DATA TABLE\n\n\n  const fetchSaleCampaignList = async () => {\n    try {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: true\n      });\n      const res = await saleCampaignApi.getAll(filters);\n\n      if (res.status === 200) {\n        setSaleCampaignList(res.data.data);\n        setTotalPage(res.data.totalRow);\n      }\n\n      if (res.status === 204) {\n        setSaleCampaignList([]);\n        setTotalPage(0);\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: false\n      });\n    }\n  };\n\n  useEffect(() => {\n    fetchSaleCampaignList();\n  }, [filters]); // CREATE\n\n  const onCreateSaleCampaign = async (data) => {\n    try {\n      setIsLoading({\n        type: 'ADD_DATA',\n        status: true\n      });\n\n      const newData = _objectSpread(_objectSpread({}, data), {}, {\n        StartTime: moment(data.StartTime).format('YYYY/MM/DD'),\n        EndTime: moment(data.EndTime).format('YYYY/MM/DD'),\n        SaleBonusList: data.SaleBonusList.map(s => _objectSpread(_objectSpread({}, s), {}, {\n          MoneyCollected: parsePriceStrToNumber(s.MoneyCollected)\n        }))\n      });\n\n      const res = await saleCampaignApi.add(newData);\n\n      if (res.status === 200) {\n        showNoti('success', res.data.message);\n        onResetSearch(); // <== khi tạo xong r reset search để trở về trang đầu tiên\n\n        return true;\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {\n      setIsLoading({\n        type: 'ADD_DATA',\n        status: false\n      });\n    }\n  }; // UPDATE\n\n\n  const onUpdateSaleCampaign = idx => {\n    return async data => {\n      try {\n        setIsLoading({\n          type: 'ADD_DATA',\n          status: true\n        });\n        const {\n          StartTime,\n          EndTime,\n          SaleBonusList: newSaleBonusList,\n          StatusID\n        } = data; // GET OLD SALE CAMPAIGN\n\n        const newSaleCampaignList = [...saleCampaignList];\n        const saleCampaign = newSaleCampaignList[idx];\n        const {\n          SaleBonusList: oldSaleBonusList\n        } = saleCampaign; // FORMAT BONUS LIST FOLLOW API\n\n        const formatSaleBonusList = [...newSaleBonusList, ...oldSaleBonusList].reduce((arr, saleBonus) => {\n          // CLEAR DUPLICATE OLD BONUS\n          if (arr.some(newBonusArr => newBonusArr.ID && newBonusArr.ID === saleBonus.ID)) {\n            return arr;\n          }\n\n          if (newSaleBonusList.some(newSaleBonus => newSaleBonus.ID && newSaleBonus.ID === saleBonus.ID)) {\n            arr.push(_objectSpread(_objectSpread({}, saleBonus), {}, {\n              MoneyCollected: parsePriceStrToNumber(saleBonus.MoneyCollected)\n            }));\n          } else if (!saleBonus.hasOwnProperty('ID')) {\n            // DO NOT HAVE PROPERTY ID => NEW BONUS\n            arr.push(_objectSpread(_objectSpread({}, saleBonus), {}, {\n              MoneyCollected: parsePriceStrToNumber(saleBonus.MoneyCollected)\n            }));\n          } else {\n            // CAN NOT FIND ID BONUS IN SALE BONUS LIST => BONUS REMOVED\n            arr.push(_objectSpread(_objectSpread({}, saleBonus), {}, {\n              Enable: false\n            }));\n          }\n\n          return arr;\n        }, []); //\n\n        const newSaleCampaign = _objectSpread(_objectSpread(_objectSpread({}, saleCampaign), data), {}, {\n          StatusName: [2, 3].includes(StatusID) ? optionStatusList.find(o => o.value === data.StatusID).title : saleCampaign.StatusName,\n          StartTime: moment(StartTime).format('YYYY/MM/DD'),\n          EndTime: moment(EndTime).format('YYYY/MM/DD'),\n          SaleBonusList: formatSaleBonusList\n        });\n\n        const res = await saleCampaignApi.update(newSaleCampaign);\n\n        if (res.status === 200) {\n          newSaleCampaignList.splice(idx, 1, _objectSpread(_objectSpread({}, newSaleCampaign), {}, {\n            SaleBonusList: newSaleBonusList.map(s => _objectSpread(_objectSpread({}, s), {}, {\n              MoneyCollected: parsePriceStrToNumber(s.MoneyCollected)\n            }))\n          }));\n          setSaleCampaignList(newSaleCampaignList);\n          showNoti('success', res.data.message);\n          return true;\n        }\n      } catch (error) {\n        showNoti('danger', error.message);\n      } finally {\n        setIsLoading({\n          type: 'ADD_DATA',\n          status: false\n        });\n      }\n    };\n  };\n\n  const columns = [{\n    title: 'Tên chiến dịch',\n    width: 150,\n    dataIndex: 'Name',\n    render: text => /*#__PURE__*/_jsxDEV(Tooltip, {\n      title: text,\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"limit-text\",\n        children: text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 5\n    }, this)\n  }, {\n    title: 'Bắt đầu',\n    width: 150,\n    dataIndex: 'StartTime',\n    render: date => /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-weight-black\",\n      children: moment(date).format('DD/MM/YYYY')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 22\n    }, this)\n  }, {\n    title: 'Kết thúc',\n    width: 150,\n    dataIndex: 'EndTime',\n    render: date => /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-weight-black\",\n      children: moment(date).format('DD/MM/YYYY')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 22\n    }, this)\n  }, {\n    title: 'Số ngày',\n    width: 100,\n    dataIndex: 'TotalDay'\n  }, {\n    title: 'Doanh thu',\n    width: 100,\n    dataIndex: 'TotalRevenue',\n    render: text => numberWithCommas(text)\n  }, _objectSpread({\n    title: 'Trạng thái',\n    width: 100,\n    dataIndex: 'StatusID',\n    align: 'left',\n    render: (statusID, record) => {\n      let cls = 'tag';\n\n      switch (statusID) {\n        //1-Chưa hoạt động 2-Đang hoạt động 3-Tạm ngưng 4-Kết thúc\n        case 1:\n          cls += ' black';\n          break;\n\n        case 2:\n          cls += ' green';\n          break;\n\n        case 3:\n          cls += ' yellow';\n\n        case 4:\n          cls += ' gray';\n          break;\n      }\n\n      return /*#__PURE__*/_jsxDEV(\"span\", {\n        className: cls,\n        children: record.StatusName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 12\n      }, this);\n    }\n  }, FilterColumn('StatusID', onSearch, onResetSearch, 'select', [{\n    title: 'Chưa hoạt động',\n    value: 1\n  }, {\n    title: 'Đang hoạt động',\n    value: 2\n  }, {\n    title: 'Tạm ngưng',\n    value: 3\n  }, {\n    title: 'Kết thúc',\n    value: 4\n  }])), {\n    align: 'right',\n    width: 100,\n    render: (record, _, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        href: {\n          pathname: '/staff/sales-campaign/sales-campaign-detail/[slug]',\n          query: {\n            slug: record.ID\n          }\n        },\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          className: \"btn btn-icon\",\n          children: /*#__PURE__*/_jsxDEV(Tooltip, {\n            title: \"Chi ti\\u1EBFt chi\\u1EBFn d\\u1ECBch\",\n            children: /*#__PURE__*/_jsxDEV(Eye, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 6\n      }, this), isAdmin && /*#__PURE__*/_jsxDEV(SalesCampaignForm, {\n        isUpdate: true,\n        updateObj: record,\n        isLoading: isLoading,\n        handleSubmit: onUpdateSaleCampaign(idx),\n        optionStatusList: optionStatusList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 5\n    }, this)\n  }];\n\n  const expandedRowRender = item => {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n        className: \"mt-2\",\n        children: \"Ghi ch\\xFA\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"note\",\n        children: item.Note\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"tb-expand mt-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"M\\u1ED1c doanh thu\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 389,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Th\\u01B0\\u1EDFng (%)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: item.SaleBonusList.map(s => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"font-weight-black\",\n                children: numberWithCommas(s.MoneyCollected)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 397,\n                columnNumber: 10\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 396,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"font-weight-black\",\n                children: [s.PercentBonus, \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 400,\n                columnNumber: 10\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 399,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 8\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 393,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true);\n  };\n\n  return /*#__PURE__*/_jsxDEV(ExpandTable, {\n    loading: isLoading,\n    currentPage: filters.pageIndex,\n    totalPage: totalPage,\n    getPagination: getPagination,\n    addClass: \"basic-header\",\n    TitlePage: \"Danh s\\xE1ch chi\\u1EBFn d\\u1ECBch\",\n    dataSource: saleCampaignList,\n    columns: columns,\n    TitleCard: /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-weight-primary\",\n      children: \"L\\u01B0u \\xFD: Chi\\u1EBFn d\\u1ECBch s\\u1EBD t\\u1EF1 \\u0111\\u1ED9ng t\\u1EA1o v\\xE0o \\u0111\\u1EA7u th\\xE1ng\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 15\n    }, this),\n    Extra: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"extra-table\",\n      children: [/*#__PURE__*/_jsxDEV(SalesCampaignFilter, {\n        handleFilter: onFilter,\n        handleResetFilter: onResetSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(SortBox, {\n        handleSort: onSort,\n        dataOption: sortOptionList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 5\n    }, this),\n    expandable: {\n      expandedRowRender\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 410,\n    columnNumber: 3\n  }, this);\n};\n\nexport default SalesCampaign;","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/Sales/SalesCampaign/SalesCampaign.tsx"],"names":["Tooltip","moment","Link","React","useEffect","useRef","useState","Eye","saleCampaignApi","SortBox","ExpandTable","FilterColumn","useWrap","numberWithCommas","parsePriceStrToNumber","SalesCampaignFilter","SalesCampaignForm","SalesCampaign","saleCampaignList","setSaleCampaignList","showNoti","isAdmin","isLoading","setIsLoading","type","status","totalPage","setTotalPage","optionStatusList","title","value","sortOptionList","dataSort","sort","sortType","text","listFieldInit","pageIndex","pageSize","StatusID","Time","refValue","filters","setFilters","onFilter","obj","current","format","getPagination","onSort","option","onResetSearch","onSearch","valueSearch","dataIndex","fetchSaleCampaignList","res","getAll","data","totalRow","error","message","onCreateSaleCampaign","newData","StartTime","EndTime","SaleBonusList","map","s","MoneyCollected","add","onUpdateSaleCampaign","idx","newSaleBonusList","newSaleCampaignList","saleCampaign","oldSaleBonusList","formatSaleBonusList","reduce","arr","saleBonus","some","newBonusArr","ID","newSaleBonus","push","hasOwnProperty","Enable","newSaleCampaign","StatusName","includes","find","o","update","splice","columns","width","render","date","align","statusID","record","cls","_","e","stopPropagation","pathname","query","slug","expandedRowRender","item","Note","PercentBonus"],"mappings":"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","sourcesContent":["import { Tooltip } from 'antd'\r\nimport moment from 'moment'\r\nimport Link from 'next/link'\r\nimport React, { useEffect, useRef, useState } from 'react'\r\nimport { Eye } from 'react-feather'\r\nimport { saleCampaignApi } from '~/apiBase'\r\nimport SortBox from '~/components/Elements/SortBox'\r\nimport ExpandTable from '~/components/ExpandTable'\r\nimport FilterColumn from '~/components/Tables/FilterColumn'\r\nimport { useWrap } from '~/context/wrap'\r\nimport { numberWithCommas, parsePriceStrToNumber } from '~/utils/functions'\r\nimport SalesCampaignFilter from './SalesCampaignFilter'\r\nimport SalesCampaignForm from './SalesCampaignForm'\r\nconst SalesCampaign = () => {\r\n\tconst [saleCampaignList, setSaleCampaignList] = useState<ISaleCampaign[]>([])\r\n\tconst { showNoti, isAdmin } = useWrap()\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: '',\r\n\t\tstatus: false\r\n\t})\r\n\tconst [totalPage, setTotalPage] = useState(null)\r\n\tconst optionStatusList = [\r\n\t\t//2-Đang hoạt động 3-Tạm ngưng 4-Kết thúc\r\n\t\t{\r\n\t\t\ttitle: 'Đang hoạt động',\r\n\t\t\tvalue: 2\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Tạm ngưng',\r\n\t\t\tvalue: 3\r\n\t\t}\r\n\t]\r\n\tconst sortOptionList = [\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 0,\r\n\t\t\t\tsortType: true\r\n\t\t\t},\r\n\t\t\tvalue: 1,\r\n\t\t\ttext: 'Ngày bắt đầu tăng dần'\r\n\t\t},\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 0,\r\n\t\t\t\tsortType: false\r\n\t\t\t},\r\n\t\t\tvalue: 2,\r\n\t\t\ttext: 'Ngày bắt đầu giảm dần'\r\n\t\t},\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 1,\r\n\t\t\t\tsortType: true\r\n\t\t\t},\r\n\t\t\tvalue: 3,\r\n\t\t\ttext: 'Ngày kết thúc tăng dần'\r\n\t\t},\r\n\t\t{\r\n\t\t\tdataSort: {\r\n\t\t\t\tsort: 1,\r\n\t\t\t\tsortType: false\r\n\t\t\t},\r\n\t\t\tvalue: 4,\r\n\t\t\ttext: 'Ngày kết thúc giảm dần'\r\n\t\t}\r\n\t]\r\n\t// FILTER\r\n\tconst listFieldInit = {\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: 10,\r\n\t\tsort: -1,\r\n\t\tsortType: false,\r\n\r\n\t\tStatusID: null,\r\n\t\tTime: ''\r\n\t}\r\n\tlet refValue = useRef({\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: 10,\r\n\t\tsort: -1,\r\n\t\tsortType: false\r\n\t})\r\n\tconst [filters, setFilters] = useState(listFieldInit)\r\n\r\n\t// FILTER\r\n\tconst onFilter = (obj) => {\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\t...refValue.current,\r\n\t\t\tpageIndex: 1,\r\n\t\t\tTime: moment(obj.Time).format('YYYY/MM/DD')\r\n\t\t})\r\n\t}\r\n\t// PAGINATION\r\n\tconst getPagination = (pageIndex: number, pageSize: number) => {\r\n\t\tif (!pageSize) pageSize = 10\r\n\t\trefValue.current = {\r\n\t\t\t...refValue.current,\r\n\t\t\tpageSize,\r\n\t\t\tpageIndex\r\n\t\t}\r\n\t\tsetFilters({\r\n\t\t\t...filters,\r\n\t\t\t...refValue.current\r\n\t\t})\r\n\t}\r\n\t// SORT\r\n\tconst onSort = (option) => {\r\n\t\trefValue.current = {\r\n\t\t\t...refValue.current,\r\n\t\t\tsort: option.title.sort,\r\n\t\t\tsortType: option.title.sortType\r\n\t\t}\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\t...refValue.current\r\n\t\t})\r\n\t}\r\n\t// RESET SEARCH\r\n\tconst onResetSearch = () => {\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\tpageSize: refValue.current.pageSize\r\n\t\t})\r\n\t}\r\n\t// ACTION SEARCH\r\n\tconst onSearch = (valueSearch, dataIndex) => {\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\t...refValue.current,\r\n\t\t\tpageIndex: 1,\r\n\t\t\t[dataIndex]: valueSearch\r\n\t\t})\r\n\t}\r\n\r\n\t// GET DATA TABLE\r\n\tconst fetchSaleCampaignList = async () => {\r\n\t\ttry {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: true\r\n\t\t\t})\r\n\t\t\tconst res = await saleCampaignApi.getAll(filters)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tsetSaleCampaignList(res.data.data)\r\n\t\t\t\tsetTotalPage(res.data.totalRow)\r\n\t\t\t}\r\n\t\t\tif (res.status === 204) {\r\n\t\t\t\tsetSaleCampaignList([])\r\n\t\t\t\tsetTotalPage(0)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tuseEffect(() => {\r\n\t\tfetchSaleCampaignList()\r\n\t}, [filters])\r\n\t// CREATE\r\n\tconst onCreateSaleCampaign = async (data: {\r\n\t\tName: string\r\n\t\tStartTime: string\r\n\t\tEndTime: string\r\n\t\tNote?: string\r\n\t\tSaleBonusList?: { MoneyCollected: string; PercentBonus: number }[]\r\n\t}) => {\r\n\t\ttry {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: true\r\n\t\t\t})\r\n\t\t\tconst newData = {\r\n\t\t\t\t...data,\r\n\t\t\t\tStartTime: moment(data.StartTime).format('YYYY/MM/DD'),\r\n\t\t\t\tEndTime: moment(data.EndTime).format('YYYY/MM/DD'),\r\n\t\t\t\tSaleBonusList: data.SaleBonusList.map((s) => ({\r\n\t\t\t\t\t...s,\r\n\t\t\t\t\tMoneyCollected: parsePriceStrToNumber(s.MoneyCollected)\r\n\t\t\t\t}))\r\n\t\t\t}\r\n\t\t\tconst res = await saleCampaignApi.add(newData)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tshowNoti('success', res.data.message)\r\n\t\t\t\tonResetSearch() // <== khi tạo xong r reset search để trở về trang đầu tiên\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t// UPDATE\r\n\tconst onUpdateSaleCampaign = (idx: number) => {\r\n\t\treturn async (data: ISaleCampaign) => {\r\n\t\t\ttry {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\t\tstatus: true\r\n\t\t\t\t})\r\n\t\t\t\tconst { StartTime, EndTime, SaleBonusList: newSaleBonusList, StatusID } = data\r\n\t\t\t\t// GET OLD SALE CAMPAIGN\r\n\t\t\t\tconst newSaleCampaignList = [...saleCampaignList]\r\n\t\t\t\tconst saleCampaign = newSaleCampaignList[idx]\r\n\t\t\t\tconst { SaleBonusList: oldSaleBonusList } = saleCampaign\r\n\t\t\t\t// FORMAT BONUS LIST FOLLOW API\r\n\t\t\t\tconst formatSaleBonusList = [...newSaleBonusList, ...oldSaleBonusList].reduce((arr, saleBonus) => {\r\n\t\t\t\t\t// CLEAR DUPLICATE OLD BONUS\r\n\t\t\t\t\tif (arr.some((newBonusArr) => newBonusArr.ID && newBonusArr.ID === saleBonus.ID)) {\r\n\t\t\t\t\t\treturn arr\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (newSaleBonusList.some((newSaleBonus) => newSaleBonus.ID && newSaleBonus.ID === saleBonus.ID)) {\r\n\t\t\t\t\t\tarr.push({\r\n\t\t\t\t\t\t\t...saleBonus,\r\n\t\t\t\t\t\t\tMoneyCollected: parsePriceStrToNumber(saleBonus.MoneyCollected)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else if (!saleBonus.hasOwnProperty('ID')) {\r\n\t\t\t\t\t\t// DO NOT HAVE PROPERTY ID => NEW BONUS\r\n\t\t\t\t\t\tarr.push({\r\n\t\t\t\t\t\t\t...saleBonus,\r\n\t\t\t\t\t\t\tMoneyCollected: parsePriceStrToNumber(saleBonus.MoneyCollected)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// CAN NOT FIND ID BONUS IN SALE BONUS LIST => BONUS REMOVED\r\n\t\t\t\t\t\tarr.push({\r\n\t\t\t\t\t\t\t...saleBonus,\r\n\t\t\t\t\t\t\tEnable: false\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn arr\r\n\t\t\t\t}, [])\r\n\t\t\t\t//\r\n\t\t\t\tconst newSaleCampaign: ISaleCampaign = {\r\n\t\t\t\t\t...saleCampaign,\r\n\t\t\t\t\t...data,\r\n\t\t\t\t\tStatusName: [2, 3].includes(StatusID) ? optionStatusList.find((o) => o.value === data.StatusID).title : saleCampaign.StatusName,\r\n\t\t\t\t\tStartTime: moment(StartTime).format('YYYY/MM/DD'),\r\n\t\t\t\t\tEndTime: moment(EndTime).format('YYYY/MM/DD'),\r\n\t\t\t\t\tSaleBonusList: formatSaleBonusList\r\n\t\t\t\t}\r\n\t\t\t\tconst res = await saleCampaignApi.update(newSaleCampaign)\r\n\t\t\t\tif (res.status === 200) {\r\n\t\t\t\t\tnewSaleCampaignList.splice(idx, 1, {\r\n\t\t\t\t\t\t...newSaleCampaign,\r\n\t\t\t\t\t\tSaleBonusList: newSaleBonusList.map((s) => ({\r\n\t\t\t\t\t\t\t...s,\r\n\t\t\t\t\t\t\tMoneyCollected: parsePriceStrToNumber(s.MoneyCollected)\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t})\r\n\t\t\t\t\tsetSaleCampaignList(newSaleCampaignList)\r\n\t\t\t\t\tshowNoti('success', res.data.message)\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\t\tstatus: false\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Tên chiến dịch',\r\n\t\t\twidth: 150,\r\n\t\t\tdataIndex: 'Name',\r\n\t\t\trender: (text) => (\r\n\t\t\t\t<Tooltip title={text}>\r\n\t\t\t\t\t<p className=\"limit-text\">{text}</p>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t)\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Bắt đầu',\r\n\t\t\twidth: 150,\r\n\t\t\tdataIndex: 'StartTime',\r\n\t\t\trender: (date) => <p className=\"font-weight-black\">{moment(date).format('DD/MM/YYYY')}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Kết thúc',\r\n\t\t\twidth: 150,\r\n\t\t\tdataIndex: 'EndTime',\r\n\t\t\trender: (date) => <p className=\"font-weight-black\">{moment(date).format('DD/MM/YYYY')}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Số ngày',\r\n\t\t\twidth: 100,\r\n\t\t\tdataIndex: 'TotalDay'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Doanh thu',\r\n\t\t\twidth: 100,\r\n\t\t\tdataIndex: 'TotalRevenue',\r\n\t\t\trender: (text) => numberWithCommas(text)\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Trạng thái',\r\n\t\t\twidth: 100,\r\n\t\t\tdataIndex: 'StatusID',\r\n\t\t\talign: 'left',\r\n\t\t\trender: (statusID, record: ISaleCampaign) => {\r\n\t\t\t\tlet cls = 'tag'\r\n\t\t\t\tswitch (statusID) {\r\n\t\t\t\t\t//1-Chưa hoạt động 2-Đang hoạt động 3-Tạm ngưng 4-Kết thúc\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tcls += ' black'\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\tcls += ' green'\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\tcls += ' yellow'\r\n\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\tcls += ' gray'\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\treturn <span className={cls}>{record.StatusName}</span>\r\n\t\t\t},\r\n\t\t\t...FilterColumn('StatusID', onSearch, onResetSearch, 'select', [\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Chưa hoạt động',\r\n\t\t\t\t\tvalue: 1\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Đang hoạt động',\r\n\t\t\t\t\tvalue: 2\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Tạm ngưng',\r\n\t\t\t\t\tvalue: 3\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Kết thúc',\r\n\t\t\t\t\tvalue: 4\r\n\t\t\t\t}\r\n\t\t\t])\r\n\t\t},\r\n\r\n\t\t{\r\n\t\t\talign: 'right',\r\n\t\t\twidth: 100,\r\n\t\t\trender: (record: ISaleCampaign, _, idx) => (\r\n\t\t\t\t<div onClick={(e) => e.stopPropagation()}>\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\thref={{\r\n\t\t\t\t\t\t\tpathname: '/staff/sales-campaign/sales-campaign-detail/[slug]',\r\n\t\t\t\t\t\t\tquery: { slug: record.ID }\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<a className=\"btn btn-icon\">\r\n\t\t\t\t\t\t\t<Tooltip title=\"Chi tiết chiến dịch\">\r\n\t\t\t\t\t\t\t\t<Eye />\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t{isAdmin && (\r\n\t\t\t\t\t\t<SalesCampaignForm\r\n\t\t\t\t\t\t\tisUpdate={true}\r\n\t\t\t\t\t\t\tupdateObj={record}\r\n\t\t\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t\t\t\thandleSubmit={onUpdateSaleCampaign(idx)}\r\n\t\t\t\t\t\t\toptionStatusList={optionStatusList}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t\t}\r\n\t]\r\n\tconst expandedRowRender = (item: ISaleCampaign) => {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<h6 className=\"mt-2\">Ghi chú</h6>\r\n\t\t\t\t<div className=\"note\">{item.Note}</div>\r\n\r\n\t\t\t\t<table className=\"tb-expand mt-3\">\r\n\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<th>Mốc doanh thu</th>\r\n\t\t\t\t\t\t\t<th>Thưởng (%)</th>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</thead>\r\n\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t{item.SaleBonusList.map((s) => (\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<p className=\"font-weight-black\">{numberWithCommas(s.MoneyCollected)}</p>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<p className=\"font-weight-black\">{s.PercentBonus}%</p>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</tbody>\r\n\t\t\t\t</table>\r\n\t\t\t</>\r\n\t\t)\r\n\t}\r\n\treturn (\r\n\t\t<ExpandTable\r\n\t\t\tloading={isLoading}\r\n\t\t\tcurrentPage={filters.pageIndex}\r\n\t\t\ttotalPage={totalPage}\r\n\t\t\tgetPagination={getPagination}\r\n\t\t\taddClass=\"basic-header\"\r\n\t\t\tTitlePage=\"Danh sách chiến dịch\"\r\n\t\t\tdataSource={saleCampaignList}\r\n\t\t\tcolumns={columns}\r\n\t\t\tTitleCard={<p className=\"font-weight-primary\">Lưu ý: Chiến dịch sẽ tự động tạo vào đầu tháng</p>}\r\n\t\t\tExtra={\r\n\t\t\t\t<div className=\"extra-table\">\r\n\t\t\t\t\t<SalesCampaignFilter handleFilter={onFilter} handleResetFilter={onResetSearch} />\r\n\t\t\t\t\t<SortBox handleSort={onSort} dataOption={sortOptionList} />\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\texpandable={{ expandedRowRender }}\r\n\t\t/>\r\n\t)\r\n}\r\n\r\nexport default SalesCampaign\r\n"]},"metadata":{},"sourceType":"module"}