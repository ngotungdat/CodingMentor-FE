{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\ExamList\\\\MarkingExam\\\\DoneMarkingExam.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { FormOutlined, WarningOutlined } from '@ant-design/icons';\nimport { Input, Modal, Spin } from 'antd';\nimport React, { useEffect, useState } from 'react';\nimport { examAppointmentResultApi } from '~/apiBase';\nimport { homeworkPonimentApi } from '~/apiBase/course-detail/home-work-pontment';\nimport { courseExamResultApi } from '~/apiBase/package/course-exam-result';\nimport { packageResultDetailApi } from '~/apiBase/package/package-result-detail';\nimport { useDoneTest } from '~/context/useDoneTest';\nimport { useWrap } from '~/context/wrap';\nvar TextArea = Input.TextArea;\n\nvar DoneMarkingExam = function DoneMarkingExam(props) {\n  _s();\n\n  var onDoneMarking = props.onDoneMarking,\n      isMarked = props.isMarked,\n      type = props.type;\n\n  var _useDoneTest = useDoneTest(),\n      dataMarking = _useDoneTest.dataMarking,\n      getDataMarking = _useDoneTest.getDataMarking;\n\n  var _useWrap = useWrap(),\n      showNoti = _useWrap.showNoti;\n\n  var _useState = useState(false),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var _useState2 = useState(false),\n      checkDone = _useState2[0],\n      setCheckDone = _useState2[1];\n\n  var _useState3 = useState(false),\n      isModalVisible = _useState3[0],\n      setIsModalVisible = _useState3[1];\n\n  var showModal = function showModal() {\n    setIsModalVisible(true);\n  };\n\n  var handleOk = function handleOk() {\n    handleMarkingExam();\n  };\n\n  var handleCancel = function handleCancel() {\n    setIsModalVisible(false);\n  };\n\n  var remakeData = function remakeData() {\n    var dataSubmit = null;\n\n    switch (type) {\n      case 'test':\n        var dataTest = {\n          ExamAppointmentResultID: null,\n          Note: '',\n          examAppointmentExerciseStudentList: []\n        };\n        dataTest.ExamAppointmentResultID = dataMarking.SetPackageResultID;\n        dataTest.Note = dataMarking.Note;\n        dataTest.examAppointmentExerciseStudentList = _toConsumableArray(dataMarking.setPackageExerciseStudentsList);\n        dataSubmit = _objectSpread({}, dataTest);\n        break;\n\n      case 'check':\n        var dataCheck = {\n          CourseExamresultID: dataMarking.SetPackageResultID,\n          Note: dataMarking.Note,\n          courseExamExerciseStudentList: _toConsumableArray(dataMarking.setPackageExerciseStudentsList)\n        };\n        dataSubmit = _objectSpread({}, dataCheck);\n        break;\n\n      case 'homework':\n        var dataHW = {\n          HomeworkResultID: dataMarking.SetPackageResultID,\n          Note: dataMarking.Note,\n          homeworkExerciseStudenttList: _toConsumableArray(dataMarking.setPackageExerciseStudentsList)\n        };\n        dataSubmit = _objectSpread({}, dataHW);\n        break;\n\n      default:\n        dataSubmit = _objectSpread({}, dataMarking);\n        break;\n    }\n\n    return dataSubmit;\n  };\n\n  var handleMarkingExam = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var dataSubmit, res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              dataSubmit = remakeData();\n              console.log('Data Submit: ', dataMarking);\n              res = null;\n              _context.prev = 4;\n              _context.t0 = type;\n              _context.next = _context.t0 === 'test' ? 8 : _context.t0 === 'check' ? 12 : _context.t0 === 'homework' ? 16 : 20;\n              break;\n\n            case 8:\n              _context.next = 10;\n              return examAppointmentResultApi.updatePoint(dataSubmit);\n\n            case 10:\n              res = _context.sent;\n              return _context.abrupt(\"break\", 24);\n\n            case 12:\n              _context.next = 14;\n              return courseExamResultApi.updatePoint(dataSubmit);\n\n            case 14:\n              res = _context.sent;\n              return _context.abrupt(\"break\", 24);\n\n            case 16:\n              _context.next = 18;\n              return homeworkPonimentApi.update(dataSubmit);\n\n            case 18:\n              res = _context.sent;\n              return _context.abrupt(\"break\", 24);\n\n            case 20:\n              _context.next = 22;\n              return packageResultDetailApi.updatePoint(dataSubmit);\n\n            case 22:\n              res = _context.sent;\n              return _context.abrupt(\"break\", 24);\n\n            case 24:\n              if (res.status === 200) {\n                showNoti('success', 'Hoàn tất chấm bài');\n                onDoneMarking && onDoneMarking();\n                setIsModalVisible(false);\n              }\n\n              _context.next = 30;\n              break;\n\n            case 27:\n              _context.prev = 27;\n              _context.t1 = _context[\"catch\"](4);\n              showNoti('danger', _context.t1.message);\n\n            case 30:\n              _context.prev = 30;\n              setLoading(false);\n              return _context.finish(30);\n\n            case 33:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 27, 30, 33]]);\n    }));\n\n    return function handleMarkingExam() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var onChange_note = function onChange_note(value) {\n    getDataMarking(_objectSpread(_objectSpread({}, dataMarking), {}, {\n      Note: value\n    }));\n  };\n\n  useEffect(function () {\n    if (isModalVisible) {\n      var nullPoint = dataMarking === null || dataMarking === void 0 ? void 0 : dataMarking.setPackageExerciseStudentsList.some(function (item) {\n        return item['Point'] == null;\n      });\n      setCheckDone(!nullPoint);\n    }\n  }, [isModalVisible]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-warning ml-2\",\n      onClick: showModal,\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"d-flex align-items-center\",\n        children: [/*#__PURE__*/_jsxDEV(FormOutlined, {\n          className: \"mr-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 6\n        }, _this), \"Ho\\xE0n t\\u1EA5t ch\\u1EA5m b\\xE0i\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 5\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 4\n    }, _this), /*#__PURE__*/_jsxDEV(Modal, {\n      title: isMarked || !checkDone ? /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-icon delete\",\n        children: /*#__PURE__*/_jsxDEV(WarningOutlined, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 8\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 7\n      }, _this) : 'Hoàn tất chấm bài',\n      footer: null,\n      visible: isModalVisible // onOk={handleOk}\n      ,\n      onCancel: handleCancel // confirmLoading={loading}\n      ,\n      children: isMarked ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mb-0\",\n        style: {\n          fontWeight: 500\n        },\n        children: [\"\\u0110\\u1EC1 thi n\\xE0y \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c ch\\u1EA5m. \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 32\n        }, _this), \" B\\u1EA1n ch\\u1EC9 \\u0111\\u01B0\\u1EE3c ch\\u1EA5m l\\u1EA1i khi c\\xF3 y\\xEAu c\\u1EA7u c\\u1EE7a h\\u1ECDc vi\\xEAn\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 6\n      }, _this) : !checkDone ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mb-0\",\n        style: {\n          fontWeight: 500\n        },\n        children: [\"V\\u1EABn c\\xF2n c\\xE2u ch\\u01B0a \\u0111\\u01B0\\u1EE3c ch\\u1EA5m \\u0111i\\u1EC3m! \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 40\n        }, _this), \"Vui l\\xF2ng ch\\u1EA5m n\\u1ED1t s\\u1ED1 c\\xE2u c\\xF2n l\\u1EA1i\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 6\n      }, _this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontWeight: 500\n          },\n          children: \"Nh\\u1EADn x\\xE9t (c\\xF3 th\\u1EC3 \\u0111\\u1EC3 tr\\u1ED1ng)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 7\n        }, _this), /*#__PURE__*/_jsxDEV(TextArea, {\n          onChange: function onChange(e) {\n            return onChange_note(e.target.value);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 7\n        }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary w-100 mt-3\",\n          onClick: handleMarkingExam,\n          children: [\"L\\u01B0u\", loading && /*#__PURE__*/_jsxDEV(Spin, {\n            className: \"loading-base\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 20\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 7\n        }, _this), ' ']\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 4\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(DoneMarkingExam, \"UnO2d8gK6UKtUyFUvLCXOcutjT8=\", false, function () {\n  return [useDoneTest, useWrap];\n});\n\n_c = DoneMarkingExam;\nexport default DoneMarkingExam;\n\nvar _c;\n\n$RefreshReg$(_c, \"DoneMarkingExam\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/ExamList/MarkingExam/DoneMarkingExam.tsx"],"names":["FormOutlined","WarningOutlined","Input","Modal","Spin","React","useEffect","useState","examAppointmentResultApi","homeworkPonimentApi","courseExamResultApi","packageResultDetailApi","useDoneTest","useWrap","TextArea","DoneMarkingExam","props","onDoneMarking","isMarked","type","dataMarking","getDataMarking","showNoti","loading","setLoading","checkDone","setCheckDone","isModalVisible","setIsModalVisible","showModal","handleOk","handleMarkingExam","handleCancel","remakeData","dataSubmit","dataTest","ExamAppointmentResultID","Note","examAppointmentExerciseStudentList","SetPackageResultID","setPackageExerciseStudentsList","dataCheck","CourseExamresultID","courseExamExerciseStudentList","dataHW","HomeworkResultID","homeworkExerciseStudenttList","console","log","res","updatePoint","update","status","message","onChange_note","value","nullPoint","some","item","fontWeight","e","target"],"mappings":"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","sourcesContent":["import { FormOutlined, WarningOutlined } from '@ant-design/icons'\r\nimport { Input, Modal, Spin } from 'antd'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { examAppointmentResultApi } from '~/apiBase'\r\nimport { homeworkPonimentApi } from '~/apiBase/course-detail/home-work-pontment'\r\nimport { courseExamResultApi } from '~/apiBase/package/course-exam-result'\r\nimport { packageResultDetailApi } from '~/apiBase/package/package-result-detail'\r\nimport { useDoneTest } from '~/context/useDoneTest'\r\nimport { useWrap } from '~/context/wrap'\r\n\r\nconst { TextArea } = Input\r\n\r\nconst DoneMarkingExam = (props) => {\r\n\tconst { onDoneMarking, isMarked, type } = props\r\n\tconst { dataMarking, getDataMarking } = useDoneTest()\r\n\tconst { showNoti } = useWrap()\r\n\tconst [loading, setLoading] = useState(false)\r\n\tconst [checkDone, setCheckDone] = useState(false)\r\n\r\n\tconst [isModalVisible, setIsModalVisible] = useState(false)\r\n\r\n\tconst showModal = () => {\r\n\t\tsetIsModalVisible(true)\r\n\t}\r\n\r\n\tconst handleOk = () => {\r\n\t\thandleMarkingExam()\r\n\t}\r\n\r\n\tconst handleCancel = () => {\r\n\t\tsetIsModalVisible(false)\r\n\t}\r\n\r\n\tconst remakeData = () => {\r\n\t\tlet dataSubmit = null\r\n\t\tswitch (type) {\r\n\t\t\tcase 'test':\r\n\t\t\t\tlet dataTest = {\r\n\t\t\t\t\tExamAppointmentResultID: null,\r\n\t\t\t\t\tNote: '',\r\n\t\t\t\t\texamAppointmentExerciseStudentList: []\r\n\t\t\t\t}\r\n\t\t\t\tdataTest.ExamAppointmentResultID = dataMarking.SetPackageResultID\r\n\t\t\t\tdataTest.Note = dataMarking.Note\r\n\t\t\t\tdataTest.examAppointmentExerciseStudentList = [...dataMarking.setPackageExerciseStudentsList]\r\n\r\n\t\t\t\tdataSubmit = { ...dataTest }\r\n\t\t\t\tbreak\r\n\r\n\t\t\tcase 'check':\r\n\t\t\t\tlet dataCheck = {\r\n\t\t\t\t\tCourseExamresultID: dataMarking.SetPackageResultID,\r\n\t\t\t\t\tNote: dataMarking.Note,\r\n\t\t\t\t\tcourseExamExerciseStudentList: [...dataMarking.setPackageExerciseStudentsList]\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdataSubmit = { ...dataCheck }\r\n\t\t\t\tbreak\r\n\r\n\t\t\tcase 'homework':\r\n\t\t\t\tlet dataHW = {\r\n\t\t\t\t\tHomeworkResultID: dataMarking.SetPackageResultID,\r\n\t\t\t\t\tNote: dataMarking.Note,\r\n\t\t\t\t\thomeworkExerciseStudenttList: [...dataMarking.setPackageExerciseStudentsList]\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdataSubmit = { ...dataHW }\r\n\t\t\t\tbreak\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tdataSubmit = { ...dataMarking }\r\n\t\t\t\tbreak\r\n\t\t}\r\n\r\n\t\treturn dataSubmit\r\n\t}\r\n\r\n\tconst handleMarkingExam = async () => {\r\n\t\tsetLoading(true)\r\n\t\tlet dataSubmit = remakeData()\r\n\r\n\t\tconsole.log('Data Submit: ', dataMarking)\r\n\r\n\t\tlet res = null\r\n\r\n\t\ttry {\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase 'test':\r\n\t\t\t\t\tres = await examAppointmentResultApi.updatePoint(dataSubmit)\r\n\t\t\t\t\tbreak\r\n\r\n\t\t\t\tcase 'check':\r\n\t\t\t\t\tres = await courseExamResultApi.updatePoint(dataSubmit)\r\n\t\t\t\t\tbreak\r\n\r\n\t\t\t\tcase 'homework':\r\n\t\t\t\t\tres = await homeworkPonimentApi.update(dataSubmit)\r\n\t\t\t\t\tbreak\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tres = await packageResultDetailApi.updatePoint(dataSubmit)\r\n\t\t\t\t\tbreak\r\n\t\t\t}\r\n\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tshowNoti('success', 'Hoàn tất chấm bài')\r\n\t\t\t\tonDoneMarking && onDoneMarking()\r\n\t\t\t\tsetIsModalVisible(false)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetLoading(false)\r\n\t\t}\r\n\t}\r\n\r\n\tconst onChange_note = (value) => {\r\n\t\tgetDataMarking({\r\n\t\t\t...dataMarking,\r\n\t\t\tNote: value\r\n\t\t})\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isModalVisible) {\r\n\t\t\tlet nullPoint = dataMarking?.setPackageExerciseStudentsList.some((item) => item['Point'] == null)\r\n\t\t\tsetCheckDone(!nullPoint)\r\n\t\t}\r\n\t}, [isModalVisible])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<button className=\"btn btn-warning ml-2\" onClick={showModal}>\r\n\t\t\t\t<span className=\"d-flex align-items-center\">\r\n\t\t\t\t\t<FormOutlined className=\"mr-2\" />\r\n\t\t\t\t\tHoàn tất chấm bài\r\n\t\t\t\t</span>\r\n\t\t\t</button>\r\n\t\t\t<Modal\r\n\t\t\t\ttitle={\r\n\t\t\t\t\tisMarked || !checkDone ? (\r\n\t\t\t\t\t\t<button className=\"btn btn-icon delete\">\r\n\t\t\t\t\t\t\t<WarningOutlined />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t'Hoàn tất chấm bài'\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\tfooter={null}\r\n\t\t\t\tvisible={isModalVisible}\r\n\t\t\t\t// onOk={handleOk}\r\n\t\t\t\tonCancel={handleCancel}\r\n\t\t\t\t// confirmLoading={loading}\r\n\t\t\t>\r\n\t\t\t\t{isMarked ? (\r\n\t\t\t\t\t<p className=\"mb-0\" style={{ fontWeight: 500 }}>\r\n\t\t\t\t\t\tĐề thi này đã được chấm. <br /> Bạn chỉ được chấm lại khi có yêu cầu của học viên\r\n\t\t\t\t\t</p>\r\n\t\t\t\t) : !checkDone ? (\r\n\t\t\t\t\t<p className=\"mb-0\" style={{ fontWeight: 500 }}>\r\n\t\t\t\t\t\tVẫn còn câu chưa được chấm điểm! <br />\r\n\t\t\t\t\t\tVui lòng chấm nốt số câu còn lại\r\n\t\t\t\t\t</p>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<p style={{ fontWeight: 500 }}>Nhận xét (có thể để trống)</p>\r\n\t\t\t\t\t\t<TextArea onChange={(e) => onChange_note(e.target.value)}></TextArea>\r\n\t\t\t\t\t\t<button className=\"btn btn-primary w-100 mt-3\" onClick={handleMarkingExam}>\r\n\t\t\t\t\t\t\tLưu\r\n\t\t\t\t\t\t\t{loading && <Spin className=\"loading-base\" />}\r\n\t\t\t\t\t\t</button>{' '}\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</Modal>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default DoneMarkingExam\r\n"]},"metadata":{},"sourceType":"module"}