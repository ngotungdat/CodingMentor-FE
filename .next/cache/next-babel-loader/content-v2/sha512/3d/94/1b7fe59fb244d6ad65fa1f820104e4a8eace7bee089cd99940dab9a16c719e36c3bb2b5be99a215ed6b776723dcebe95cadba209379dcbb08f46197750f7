{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Elements\\\\AudioRecord\\\\AudioRecord.tsx\";\nimport React, { useEffect, useState } from 'react';\nimport AudioReactRecorder, { RecordState } from 'audio-react-recorder';\nimport { exerciseGroupApi } from '~/apiBase/';\nimport { useWrap } from '~/context/wrap';\nimport { Mic, Pause, Play, Square } from 'react-feather';\nimport { Spin, Tooltip } from 'antd';\n\nconst AudioRecord = props => {\n  const {\n    getLinkRecord,\n    linkRecord\n  } = props;\n  const {\n    0: state,\n    1: setState\n  } = useState(null);\n  const {\n    showNoti\n  } = useWrap();\n  const {\n    0: loadingUpload,\n    1: setLoadingUpload\n  } = useState(false);\n  const {\n    0: isRecord,\n    1: setIsRecord\n  } = useState(false);\n  const {\n    0: isPause,\n    1: setIsPause\n  } = useState(false);\n\n  const start = () => {\n    try {\n      setState(RecordState.START);\n      setIsRecord(true);\n    } catch (error) {}\n  };\n\n  const pause = () => {\n    setState(RecordState.PAUSE);\n    setIsPause(!isPause);\n    isPause && start();\n  };\n\n  const stop = () => {\n    setState(RecordState.STOP);\n  };\n\n  function blobToFile(theBlob, fileName) {\n    theBlob.lastModifiedDate = new Date();\n    theBlob.name = fileName;\n    return new File([theBlob], fileName, {\n      lastModified: new Date().getTime(),\n      type: theBlob.type\n    });\n  }\n\n  const onStop = async audioData => {\n    let file = blobToFile(audioData.blob, 'record-audio.mp3');\n    setLoadingUpload(true);\n    setIsRecord(false);\n    setIsPause(false);\n\n    try {\n      let res = await exerciseGroupApi.UploadAudio(file);\n\n      if (res.status == 200) {\n        getLinkRecord(res.data.data);\n        showNoti('success', 'Ghi âm thành công');\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {\n      setLoadingUpload(false);\n    }\n  };\n\n  useEffect(() => {\n    Promise.resolve(navigator.mediaDevices.getUserMedia({\n      audio: true\n    }));\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"wrap-audio-record mt-2\",\n    children: [/*#__PURE__*/_jsxDEV(AudioReactRecorder, {\n      state: state,\n      onStop: onStop,\n      canvasHeight: 30,\n      canvasWidth: 300\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 4\n    }, this), loadingUpload ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex align-items-center mt-2 mb-2\",\n      children: [/*#__PURE__*/_jsxDEV(Spin, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          marginLeft: '5px',\n          fontStyle: 'italic',\n          fontSize: '13px'\n        },\n        children: \"Loading audio...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 5\n    }, this) : linkRecord && /*#__PURE__*/_jsxDEV(\"audio\", {\n      controls: true,\n      children: /*#__PURE__*/_jsxDEV(\"source\", {\n        src: linkRecord,\n        type: \"audio/mpeg\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 6\n    }, this), !isRecord && /*#__PURE__*/_jsxDEV(Tooltip, {\n      title: \"B\\u1EAFt \\u0111\\u1EA7u ghi \\xE2m\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn-record start\",\n        onClick: start,\n        children: /*#__PURE__*/_jsxDEV(Mic, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 5\n    }, this), isRecord && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Tooltip, {\n        title: \"T\\u1EA1m d\\u1EEBng\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-record pause mr-2\",\n          onClick: pause,\n          children: !isPause ? /*#__PURE__*/_jsxDEV(Pause, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 20\n          }, this) : /*#__PURE__*/_jsxDEV(Play, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 32\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n        title: \"L\\u01B0u l\\u1EA1i\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-record save\",\n          onClick: stop,\n          children: /*#__PURE__*/_jsxDEV(Square, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true), isPause && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-block mt-2\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"font-italic\",\n        style: {\n          fontWeight: 500,\n          opacity: 0.7\n        },\n        children: \"L\\u01B0u \\xFD: Hi\\u1EC7n b\\u1EA1n \\u0111ang t\\u1EA1m d\\u1EEBng. B\\u1EA5m v\\xE0o n\\xFAt l\\u01B0u b\\xEAn tr\\xEAn \\u0111\\u1EC3 l\\u01B0u l\\u1EA1i \\u0111o\\u1EA1n ghi \\xE2m.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 3\n  }, this);\n};\n\nexport default AudioRecord;","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Elements/AudioRecord/AudioRecord.tsx"],"names":["React","useEffect","useState","AudioReactRecorder","RecordState","exerciseGroupApi","useWrap","Mic","Pause","Play","Square","Spin","Tooltip","AudioRecord","props","getLinkRecord","linkRecord","state","setState","showNoti","loadingUpload","setLoadingUpload","isRecord","setIsRecord","isPause","setIsPause","start","START","error","pause","PAUSE","stop","STOP","blobToFile","theBlob","fileName","lastModifiedDate","Date","name","File","lastModified","getTime","type","onStop","audioData","file","blob","res","UploadAudio","status","data","message","Promise","resolve","navigator","mediaDevices","getUserMedia","audio","marginLeft","fontStyle","fontSize","fontWeight","opacity"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport AudioReactRecorder, { RecordState } from 'audio-react-recorder'\r\nimport { exerciseGroupApi } from '~/apiBase/'\r\nimport { useWrap } from '~/context/wrap'\r\nimport { Mic, Pause, Play, Square } from 'react-feather'\r\nimport { Spin, Tooltip } from 'antd'\r\n\r\nconst AudioRecord = (props) => {\r\n\tconst { getLinkRecord, linkRecord } = props\r\n\tconst [state, setState] = useState(null)\r\n\tconst { showNoti } = useWrap()\r\n\tconst [loadingUpload, setLoadingUpload] = useState(false)\r\n\tconst [isRecord, setIsRecord] = useState(false)\r\n\tconst [isPause, setIsPause] = useState(false)\r\n\r\n\tconst start = () => {\r\n\t\ttry {\r\n\t\t\tsetState(RecordState.START)\r\n\t\t\tsetIsRecord(true)\r\n\t\t} catch (error) {}\r\n\t}\r\n\r\n\tconst pause = () => {\r\n\t\tsetState(RecordState.PAUSE)\r\n\t\tsetIsPause(!isPause)\r\n\t\tisPause && start()\r\n\t}\r\n\r\n\tconst stop = () => {\r\n\t\tsetState(RecordState.STOP)\r\n\t}\r\n\r\n\tfunction blobToFile(theBlob, fileName) {\r\n\t\ttheBlob.lastModifiedDate = new Date()\r\n\t\ttheBlob.name = fileName\r\n\t\treturn new File([theBlob], fileName, {\r\n\t\t\tlastModified: new Date().getTime(),\r\n\t\t\ttype: theBlob.type\r\n\t\t})\r\n\t}\r\n\r\n\tconst onStop = async (audioData) => {\r\n\t\tlet file = blobToFile(audioData.blob, 'record-audio.mp3')\r\n\t\tsetLoadingUpload(true)\r\n\t\tsetIsRecord(false)\r\n\t\tsetIsPause(false)\r\n\r\n\t\ttry {\r\n\t\t\tlet res = await exerciseGroupApi.UploadAudio(file)\r\n\t\t\tif (res.status == 200) {\r\n\t\t\t\tgetLinkRecord(res.data.data)\r\n\t\t\t\tshowNoti('success', 'Ghi âm thành công')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetLoadingUpload(false)\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tPromise.resolve(navigator.mediaDevices.getUserMedia({ audio: true }))\r\n\t}, [])\r\n\r\n\treturn (\r\n\t\t<div className=\"wrap-audio-record mt-2\">\r\n\t\t\t<AudioReactRecorder state={state} onStop={onStop} canvasHeight={30} canvasWidth={300} />\r\n\r\n\t\t\t{loadingUpload ? (\r\n\t\t\t\t<div className=\"d-flex align-items-center mt-2 mb-2\">\r\n\t\t\t\t\t<Spin />\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tmarginLeft: '5px',\r\n\t\t\t\t\t\t\tfontStyle: 'italic',\r\n\t\t\t\t\t\t\tfontSize: '13px'\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tLoading audio...\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\tlinkRecord && (\r\n\t\t\t\t\t<audio controls>\r\n\t\t\t\t\t\t<source src={linkRecord} type=\"audio/mpeg\" />\r\n\t\t\t\t\t</audio>\r\n\t\t\t\t)\r\n\t\t\t)}\r\n\r\n\t\t\t{!isRecord && (\r\n\t\t\t\t<Tooltip title=\"Bắt đầu ghi âm\">\r\n\t\t\t\t\t<button className=\"btn-record start\" onClick={start}>\r\n\t\t\t\t\t\t<Mic />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t)}\r\n\r\n\t\t\t{isRecord && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<Tooltip title=\"Tạm dừng\">\r\n\t\t\t\t\t\t<button className=\"btn-record pause mr-2\" onClick={pause}>\r\n\t\t\t\t\t\t\t{!isPause ? <Pause /> : <Play />}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t<Tooltip title=\"Lưu lại\">\r\n\t\t\t\t\t\t<button className=\"btn-record save\" onClick={stop}>\r\n\t\t\t\t\t\t\t<Square />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\r\n\t\t\t{isPause && (\r\n\t\t\t\t<div className=\"d-block mt-2\">\r\n\t\t\t\t\t<p className=\"font-italic\" style={{ fontWeight: 500, opacity: 0.7 }}>\r\n\t\t\t\t\t\tLưu ý: Hiện bạn đang tạm dừng. Bấm vào nút lưu bên trên để lưu lại đoạn ghi âm.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default AudioRecord\r\n"]},"metadata":{},"sourceType":"module"}