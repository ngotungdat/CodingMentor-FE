{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\Option\\\\ProgramDetail\\\\Subject.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport { useRouter } from 'next/router';\nimport { useWrap } from '~/context/wrap';\nimport { subjectApi, programApi } from '~/apiBase';\nimport SubjectForm from '../SubjectForm';\nimport PowerTable from '~/components/PowerTable';\nvar pageIndex = 1;\n\nvar Subject = function Subject(props) {\n  _s();\n\n  var key = props.key;\n  var router = useRouter();\n  var programID = parseInt(router.query.slug);\n\n  var _useState = useState([]),\n      dataProgram = _useState[0],\n      setDataProgram = _useState[1];\n\n  var _useState2 = useState([]),\n      dataSource = _useState2[0],\n      setDataSource = _useState2[1];\n\n  var _useWrap = useWrap(),\n      showNoti = _useWrap.showNoti,\n      pageSize = _useWrap.pageSize,\n      userInformation = _useWrap.userInformation;\n\n  var _useState3 = useState({\n    type: '',\n    status: false\n  }),\n      isLoading = _useState3[0],\n      setIsLoading = _useState3[1];\n\n  var _useState4 = useState(null),\n      totalPage = _useState4[0],\n      setTotalPage = _useState4[1];\n\n  var _useState5 = useState(null),\n      indexRow = _useState5[0],\n      setIndexRow = _useState5[1];\n\n  var _useState6 = useState(1),\n      currentPage = _useState6[0],\n      setCurrentPage = _useState6[1];\n\n  var listTodoApi = {\n    pageSize: pageSize,\n    pageIndex: pageIndex,\n    ProgramID: programID ? programID : null\n  };\n\n  var _useState7 = useState(listTodoApi),\n      todoApi = _useState7[0],\n      setTodoApi = _useState7[1];\n\n  var getDataSource = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setIsLoading({\n                type: 'GET_ALL',\n                status: true\n              });\n              _context.prev = 1;\n              _context.next = 4;\n              return subjectApi.getAll(todoApi);\n\n            case 4:\n              res = _context.sent;\n\n              if (res.status == 200) {\n                if (res.data.data.length > 0) {\n                  setDataSource(res.data.data);\n                  setTotalPage(res.data.totalRow);\n                }\n              }\n\n              res.status == 204 && showNoti('danger', 'Không có dữ liệu') && setDataSource([]);\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](1);\n              showNoti('danger', _context.t0.message);\n\n            case 12:\n              _context.prev = 12;\n              setIsLoading({\n                type: 'GET_ALL',\n                status: false\n              });\n              return _context.finish(12);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 9, 12, 15]]);\n    }));\n\n    return function getDataSource() {\n      return _ref.apply(this, arguments);\n    };\n  }(); // GET DATA PROGRAM\n\n\n  var getDataProgram = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return programApi.getAll(todoApi);\n\n            case 3:\n              res = _context2.sent;\n              res.status == 200 && setDataProgram(res.data.data);\n              res.status == 204 && showNoti('danger', 'Không có dữ liệu');\n              _context2.next = 11;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](0);\n              showNoti('danger', _context2.t0.message);\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 8]]);\n    }));\n\n    return function getDataProgram() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var afterPost = function afterPost(mes) {\n    showNoti('success', mes);\n    setTodoApi(_objectSpread(_objectSpread({}, listTodoApi), {}, {\n      pageIndex: 1\n    }));\n    setCurrentPage(1);\n  };\n\n  var _onSubmit2 = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dataSubmit) {\n      var res, newDataSource, _res;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: true\n              });\n              res = null;\n\n              if (!dataSubmit.ID) {\n                _context3.next = 18;\n                break;\n              }\n\n              _context3.prev = 3;\n              _context3.next = 6;\n              return subjectApi.update(dataSubmit);\n\n            case 6:\n              res = _context3.sent;\n\n              if (res.status == 200) {\n                newDataSource = _toConsumableArray(dataSource);\n                newDataSource.splice(indexRow, 1, dataSubmit);\n                setDataSource(newDataSource);\n                showNoti('success', res.data.message);\n              }\n\n              _context3.next = 13;\n              break;\n\n            case 10:\n              _context3.prev = 10;\n              _context3.t0 = _context3[\"catch\"](3);\n              showNoti('danger', _context3.t0.message);\n\n            case 13:\n              _context3.prev = 13;\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: false\n              });\n              return _context3.finish(13);\n\n            case 16:\n              _context3.next = 31;\n              break;\n\n            case 18:\n              _context3.prev = 18;\n              _context3.next = 21;\n              return subjectApi.add(dataSubmit);\n\n            case 21:\n              res = _context3.sent;\n              ((_res = res) === null || _res === void 0 ? void 0 : _res.status) == 200 && afterPost(res.data.message);\n              _context3.next = 28;\n              break;\n\n            case 25:\n              _context3.prev = 25;\n              _context3.t1 = _context3[\"catch\"](18);\n              showNoti('danger', _context3.t1.message);\n\n            case 28:\n              _context3.prev = 28;\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: false\n              });\n              return _context3.finish(28);\n\n            case 31:\n              return _context3.abrupt(\"return\", res);\n\n            case 32:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[3, 10, 13, 16], [18, 25, 28, 31]]);\n    }));\n\n    return function _onSubmit(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var _getPagination = function getPagination(pageNumber) {\n    pageIndex = pageNumber;\n    setCurrentPage(pageNumber);\n    setTodoApi(_objectSpread(_objectSpread({}, todoApi), {}, {\n      pageIndex: pageIndex\n    }));\n  };\n\n  useEffect(function () {\n    getDataSource();\n  }, [todoApi, key]);\n  useEffect(function () {\n    getDataProgram();\n  }, []);\n  var columns = [{\n    title: 'Bài học',\n    dataIndex: 'SubjectName',\n    key: 'subjectname',\n    width: '90%',\n    className: 'col-long',\n    render: function render(text) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"font-weight-black\",\n        children: text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 22\n      }, _this);\n    }\n  }, {\n    width: userInformation && (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) !== 2 ? '10%' : 0,\n    align: 'center',\n    render: function render(text, data, index) {\n      return /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: userInformation && (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) !== 2 && /*#__PURE__*/_jsxDEV(SubjectForm, {\n          dataProgram: dataProgram,\n          getIndex: function getIndex() {\n            return setIndexRow(index);\n          },\n          index: index,\n          rowData: data,\n          rowID: data.ID,\n          isLoading: isLoading,\n          _onSubmit: function _onSubmit(data) {\n            return _onSubmit2(data);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 7\n        }, _this)\n      }, void 0, false);\n    }\n  }];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(PowerTable, {\n      currentPage: currentPage,\n      totalPage: totalPage && totalPage,\n      getPagination: function getPagination(pageNumber) {\n        return _getPagination(pageNumber);\n      },\n      addClass: \"table-fix-column table-small\",\n      loading: isLoading,\n      TitleCard: userInformation && (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) !== 2 && /*#__PURE__*/_jsxDEV(SubjectForm, {\n        dataProgram: dataProgram,\n        isLoading: isLoading,\n        _onSubmit: function _onSubmit(data) {\n          return _onSubmit2(data);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 7\n      }, _this),\n      dataSource: dataSource,\n      columns: columns,\n      Extra: \"B\\xE0i h\\u1ECDc\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 4\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 136,\n    columnNumber: 3\n  }, _this);\n};\n\n_s(Subject, \"zPqLVUb8//q0Jg60ExChjwciNWs=\", false, function () {\n  return [useRouter, useWrap];\n});\n\n_c = Subject;\nexport default Subject;\n\nvar _c;\n\n$RefreshReg$(_c, \"Subject\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/Option/ProgramDetail/Subject.tsx"],"names":["React","useEffect","useState","useRouter","useWrap","subjectApi","programApi","SubjectForm","PowerTable","pageIndex","Subject","props","key","router","programID","parseInt","query","slug","dataProgram","setDataProgram","dataSource","setDataSource","showNoti","pageSize","userInformation","type","status","isLoading","setIsLoading","totalPage","setTotalPage","indexRow","setIndexRow","currentPage","setCurrentPage","listTodoApi","ProgramID","todoApi","setTodoApi","getDataSource","getAll","res","data","length","totalRow","message","getDataProgram","afterPost","mes","_onSubmit","dataSubmit","ID","update","newDataSource","splice","add","getPagination","pageNumber","columns","title","dataIndex","width","className","render","text","RoleID","align","index"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useRouter } from 'next/router'\r\nimport { useWrap } from '~/context/wrap'\r\nimport { subjectApi, programApi } from '~/apiBase'\r\nimport SubjectForm from '../SubjectForm'\r\nimport PowerTable from '~/components/PowerTable'\r\n\r\nlet pageIndex = 1\r\n\r\nconst Subject = (props) => {\r\n\tconst { key } = props\r\n\tconst router = useRouter()\r\n\tconst programID = parseInt(router.query.slug as string)\r\n\r\n\tconst [dataProgram, setDataProgram] = useState<IProgram[]>([])\r\n\r\n\tconst [dataSource, setDataSource] = useState<ISubject[]>([])\r\n\tconst { showNoti, pageSize, userInformation } = useWrap()\r\n\tconst [isLoading, setIsLoading] = useState({ type: '', status: false })\r\n\tconst [totalPage, setTotalPage] = useState(null)\r\n\tconst [indexRow, setIndexRow] = useState(null)\r\n\tconst [currentPage, setCurrentPage] = useState(1)\r\n\tconst listTodoApi = { pageSize: pageSize, pageIndex: pageIndex, ProgramID: programID ? programID : null }\r\n\tconst [todoApi, setTodoApi] = useState(listTodoApi)\r\n\r\n\tconst getDataSource = async () => {\r\n\t\tsetIsLoading({ type: 'GET_ALL', status: true })\r\n\t\ttry {\r\n\t\t\tlet res = await subjectApi.getAll(todoApi)\r\n\t\t\tif (res.status == 200) {\r\n\t\t\t\tif (res.data.data.length > 0) {\r\n\t\t\t\t\tsetDataSource(res.data.data)\r\n\t\t\t\t\tsetTotalPage(res.data.totalRow)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tres.status == 204 && showNoti('danger', 'Không có dữ liệu') && setDataSource([])\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({ type: 'GET_ALL', status: false })\r\n\t\t}\r\n\t}\r\n\r\n\t// GET DATA PROGRAM\r\n\tconst getDataProgram = async () => {\r\n\t\ttry {\r\n\t\t\tlet res = await programApi.getAll(todoApi)\r\n\t\t\tres.status == 200 && setDataProgram(res.data.data)\r\n\t\t\tres.status == 204 && showNoti('danger', 'Không có dữ liệu')\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t}\r\n\t}\r\n\r\n\tconst afterPost = (mes: any) => {\r\n\t\tshowNoti('success', mes)\r\n\t\tsetTodoApi({ ...listTodoApi, pageIndex: 1 })\r\n\t\tsetCurrentPage(1)\r\n\t}\r\n\r\n\tconst _onSubmit = async (dataSubmit: any) => {\r\n\t\tsetIsLoading({ type: 'ADD_DATA', status: true })\r\n\t\tlet res = null\r\n\t\tif (dataSubmit.ID) {\r\n\t\t\ttry {\r\n\t\t\t\tres = await subjectApi.update(dataSubmit)\r\n\t\t\t\tif (res.status == 200) {\r\n\t\t\t\t\tlet newDataSource = [...dataSource]\r\n\t\t\t\t\tnewDataSource.splice(indexRow, 1, dataSubmit)\r\n\t\t\t\t\tsetDataSource(newDataSource)\r\n\t\t\t\t\tshowNoti('success', res.data.message)\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({ type: 'ADD_DATA', status: false })\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttry {\r\n\t\t\t\tres = await subjectApi.add(dataSubmit)\r\n\t\t\t\tres?.status == 200 && afterPost(res.data.message)\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({ type: 'ADD_DATA', status: false })\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst getPagination = (pageNumber: number) => {\r\n\t\tpageIndex = pageNumber\r\n\t\tsetCurrentPage(pageNumber)\r\n\t\tsetTodoApi({ ...todoApi, pageIndex: pageIndex })\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tgetDataSource()\r\n\t}, [todoApi, key])\r\n\r\n\tuseEffect(() => {\r\n\t\tgetDataProgram()\r\n\t}, [])\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Bài học',\r\n\t\t\tdataIndex: 'SubjectName',\r\n\t\t\tkey: 'subjectname',\r\n\t\t\twidth: '90%',\r\n\t\t\tclassName: 'col-long',\r\n\t\t\trender: (text) => <p className=\"font-weight-black\">{text}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\twidth: userInformation && userInformation?.RoleID !== 2 ? '10%' : 0,\r\n\t\t\talign: 'center',\r\n\t\t\trender: (text, data, index) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{userInformation && userInformation?.RoleID !== 2 && (\r\n\t\t\t\t\t\t<SubjectForm\r\n\t\t\t\t\t\t\tdataProgram={dataProgram}\r\n\t\t\t\t\t\t\tgetIndex={() => setIndexRow(index)}\r\n\t\t\t\t\t\t\tindex={index}\r\n\t\t\t\t\t\t\trowData={data}\r\n\t\t\t\t\t\t\trowID={data.ID}\r\n\t\t\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t\t\t\t_onSubmit={(data: any) => _onSubmit(data)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</>\r\n\t\t\t)\r\n\t\t}\r\n\t]\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<PowerTable\r\n\t\t\t\tcurrentPage={currentPage}\r\n\t\t\t\ttotalPage={totalPage && totalPage}\r\n\t\t\t\tgetPagination={(pageNumber: number) => getPagination(pageNumber)}\r\n\t\t\t\taddClass=\"table-fix-column table-small\"\r\n\t\t\t\tloading={isLoading}\r\n\t\t\t\tTitleCard={\r\n\t\t\t\t\tuserInformation &&\r\n\t\t\t\t\tuserInformation?.RoleID !== 2 && (\r\n\t\t\t\t\t\t<SubjectForm dataProgram={dataProgram} isLoading={isLoading} _onSubmit={(data: any) => _onSubmit(data)} />\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\tdataSource={dataSource}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tExtra=\"Bài học\"\r\n\t\t\t/>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Subject\r\n"]},"metadata":{},"sourceType":"module"}