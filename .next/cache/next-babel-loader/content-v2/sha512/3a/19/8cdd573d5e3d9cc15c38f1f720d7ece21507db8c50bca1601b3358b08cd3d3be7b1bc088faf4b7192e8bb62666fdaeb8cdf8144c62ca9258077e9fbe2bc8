{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\pages\\\\option\\\\discount\\\\index.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState } from 'react';\nimport FilterDiscountTable from '~/components/Global/Option/FilterTable/FilterDiscountTable';\nimport SortBox from '~/components/Elements/SortBox';\nimport DiscountForm from '~/components/Global/Option/DiscountForm';\nimport LayoutBase from '~/components/LayoutBase';\nimport PowerTable from '~/components/PowerTable';\nimport FilterColumn from '~/components/Tables/FilterColumn';\nimport TitlePage from '~/components/TitlePage';\nimport { Popconfirm, Button } from 'antd';\nimport { useWrap } from '~/context/wrap';\nimport { discountApi } from '~/apiBase';\nimport { X } from 'react-feather';\nimport moment from 'moment';\nimport { parseToMoney } from '~/utils/functions';\nimport ViewImage from './show-image'; // SORT\n\nconst dataOption = [{\n  dataSort: {\n    sort: 2,\n    sortType: false\n  },\n  value: 3,\n  text: 'Tên giảm dần'\n}, {\n  dataSort: {\n    sort: 2,\n    sortType: true\n  },\n  value: 4,\n  text: 'Tên tăng dần '\n}];\nlet listField = {\n  DiscountCode: '',\n  Status: ''\n};\nlet pageIndex = 1;\n\nconst Discount = () => {\n  const {\n    showNoti,\n    pageSize\n  } = useWrap();\n  const {\n    0: dataTable,\n    1: setDataTable\n  } = useState([]);\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState({\n    type: '',\n    status: false\n  });\n  const {\n    0: totalPage,\n    1: setTotalPage\n  } = useState(null);\n  const {\n    0: currentPage,\n    1: setCurrentPage\n  } = useState(1);\n  const {\n    0: activeColumnSearch,\n    1: setActiveColumnSearch\n  } = useState('');\n  const {\n    0: rerender,\n    1: setRerender\n  } = useState(''); // PARAMS API GETALL\n\n  const listTodoApi = {\n    pageSize: pageSize,\n    pageIndex: pageIndex,\n    sort: null,\n    sortType: null,\n    DiscountCode: null,\n    Status: null\n  };\n  const {\n    0: todoApi,\n    1: setTodoApi\n  } = useState(listTodoApi); // GET DATA STAFFSALARY\n\n  const getDataTable = async () => {\n    setIsLoading({\n      type: 'GET_ALL',\n      status: true\n    });\n\n    try {\n      let res = await discountApi.getAll(todoApi);\n\n      if (res.status == 204) {\n        showNoti('danger', 'Không có dữ liệu');\n        setDataTable([]);\n      }\n\n      if (res.status == 200) {\n        setDataTable(res.data.data);\n\n        if (res.data.data.length < 1) {\n          handleReset();\n        }\n\n        setTotalPage(res.data.totalRow);\n        let now = new Date().getTime();\n        setRerender(now);\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: false\n      });\n    }\n  }; // ADD DATA\n\n\n  const _onSubmit = async data => {\n    setIsLoading({\n      type: 'ADD_DATA',\n      status: true\n    });\n    let res = null;\n\n    if (data.ID) {\n      try {\n        var _res;\n\n        res = await discountApi.update(data);\n        ((_res = res) === null || _res === void 0 ? void 0 : _res.status) == 200 && showNoti('success', 'Cập nhật thành công'), getDataTable();\n      } catch (error) {\n        showNoti('danger', error.message);\n      } finally {\n        setIsLoading({\n          type: 'ADD_DATA',\n          status: false\n        });\n      }\n    } else {\n      try {\n        var _res2;\n\n        res = await discountApi.add(data);\n        ((_res2 = res) === null || _res2 === void 0 ? void 0 : _res2.status) == 200 && afterPost('Thêm');\n      } catch (error) {\n        showNoti('danger', error.message);\n      } finally {\n        setIsLoading({\n          type: 'ADD_DATA',\n          status: false\n        });\n      }\n    }\n\n    return res;\n  };\n\n  const afterPost = value => {\n    showNoti('success', `${value} thành công`);\n    setTodoApi(_objectSpread(_objectSpread({}, listTodoApi), {}, {\n      pageIndex: 1\n    }));\n    setCurrentPage(1);\n  }; // PAGINATION\n\n\n  const getPagination = (pageNumber, pageSize) => {\n    if (!pageSize) pageSize = 10;\n    pageIndex = pageNumber;\n    setCurrentPage(pageNumber);\n    setTodoApi(_objectSpread(_objectSpread({}, todoApi), {}, {\n      pageIndex: pageIndex,\n      pageSize: pageSize\n    }));\n  }; // ON SEARCH\n\n\n  const compareField = (valueSearch, dataIndex) => {\n    let newList = null;\n    Object.keys(listField).forEach(function (key) {\n      if (key != dataIndex) {\n        listField[key] = '';\n      } else {\n        listField[key] = valueSearch;\n      }\n    });\n    newList = listField;\n    return newList;\n  };\n\n  const onSearch = (valueSearch, dataIndex) => {\n    let clearKey = compareField(valueSearch, dataIndex);\n    setTodoApi(_objectSpread(_objectSpread({}, todoApi), {}, {\n      pageIndex: 1\n    }, clearKey));\n  }; // DELETE\n\n\n  const handleDelele = async param => {\n    if (param) {\n      let res = null;\n\n      try {\n        res = await discountApi.update(param);\n        res.status === 200 && showNoti('success', 'Xóa thành công');\n\n        if (dataTable.length === 1) {\n          listTodoApi.pageIndex === 1 ? setTodoApi(_objectSpread(_objectSpread({}, listTodoApi), {}, {\n            pageIndex: 1\n          })) : setTodoApi(_objectSpread(_objectSpread({}, listTodoApi), {}, {\n            pageIndex: listTodoApi.pageIndex - 1\n          }));\n          return;\n        }\n\n        getDataTable();\n      } catch (error) {\n        showNoti('danger', error.message);\n      } finally {\n        setIsLoading({\n          type: 'DELETE_DATA',\n          status: false\n        });\n      }\n    }\n  }; // HANDLE RESET\n\n\n  const handleReset = () => {\n    setActiveColumnSearch('');\n    setTodoApi(_objectSpread(_objectSpread({}, listTodoApi), {}, {\n      pageIndex: 1\n    }));\n    setCurrentPage(1);\n  }; // HANDLE SORT\n\n\n  const handleSort = async option => {\n    let newTodoApi = _objectSpread(_objectSpread({}, listTodoApi), {}, {\n      sort: option.title.sort,\n      sortType: option.title.sortType\n    });\n\n    setCurrentPage(1);\n    setTodoApi(newTodoApi);\n  }; // HANDLE FILTER\n\n\n  const _onFilterTable = data => {\n    let newTodoApi = _objectSpread(_objectSpread({}, listTodoApi), {}, {\n      fromDate: data.fromDate,\n      toDate: data.toDate,\n      Status: data.Status\n    });\n\n    setCurrentPage(1);\n    setTodoApi(newTodoApi);\n  };\n\n  const columns = [_objectSpread(_objectSpread({\n    title: 'Mã khuyến mãi',\n    width: 150,\n    dataIndex: 'DiscountCode'\n  }, FilterColumn('DiscountCode', onSearch, handleReset, 'text')), {}, {\n    className: activeColumnSearch === 'ID' ? 'active-column-search' : '',\n    render: code => /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"tag green\",\n      children: code\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 22\n    }, this)\n  }), {\n    title: 'Khuyến mãi',\n    dataIndex: 'Discount',\n    width: 150,\n    render: (text, record) => {\n      if (record.DiscountType == 2) {\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"font-weight-primary\",\n          children: [text, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 13\n        }, this);\n      } else {\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"font-weight-primary\",\n          children: Intl.NumberFormat('ja-JP').format(text)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 13\n        }, this);\n      }\n    }\n  }, {\n    title: 'Gói',\n    dataIndex: 'StyleName',\n    width: 150,\n    render: (text, record) => {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"font-weight-black\",\n        children: text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 12\n      }, this);\n    }\n  }, {\n    title: 'Trạng thái',\n    width: 150,\n    align: 'center',\n    dataIndex: 'StatusName',\n    render: (text, record) => {\n      switch (record.Status) {\n        case 1:\n          return /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag green\",\n            children: text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 14\n          }, this);\n\n        case 2:\n          return /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag yellow\",\n            children: text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 14\n          }, this);\n\n        case 3:\n          return /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag red\",\n            children: text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 14\n          }, this);\n      }\n    }\n  }, {\n    title: 'Đơn hàng tối thiểu',\n    align: 'center',\n    width: 200,\n    dataIndex: 'MinimumOrder',\n    render: (data, value) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [parseToMoney(data), \"\\u0111\"]\n    }, void 0, true)\n  }, {\n    title: 'Giảm tối đa',\n    align: 'center',\n    width: 200,\n    dataIndex: 'MaxDiscountPrice',\n    render: (data, value) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [parseToMoney(data), \"\\u0111\"]\n    }, void 0, true)\n  }, {\n    title: 'Số lượng',\n    align: 'center',\n    width: 100,\n    dataIndex: 'Quantity'\n  }, {\n    title: 'Số lượng đã dùng',\n    width: 200,\n    align: 'center',\n    dataIndex: 'QuantityLeft'\n  }, {\n    title: 'Ghi chú',\n    width: 200,\n    dataIndex: 'Note'\n  }, {\n    title: 'Thời hạn',\n    dataIndex: 'DeadLine',\n    render: date => moment(date).format('DD/MM/YYYY')\n  }, {\n    align: 'right',\n    render: (record, text, index) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(DiscountForm, {\n        showIcon: true,\n        rowData: record,\n        isLoading: isLoading,\n        _onSubmit: data => _onSubmit(data)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(Popconfirm, {\n        placement: \"left\",\n        title: \"B\\u1EA1n c\\xF3 ch\\u1EAFc ch\\u1EAFn mu\\u1ED1n x\\xF3a kh\\xF4ng?\",\n        onConfirm: () => handleDelele({\n          ID: record.ID,\n          Enable: false\n        }),\n        okText: \"X\\xF3a\",\n        cancelText: \"Hu\\u1EF7\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          className: \"btn btn-icon delete\",\n          children: /*#__PURE__*/_jsxDEV(X, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(ViewImage, {\n        url: record === null || record === void 0 ? void 0 : record.Images\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true)\n  }];\n  useEffect(() => {\n    getDataTable();\n  }, [todoApi]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"row\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-12\",\n      children: /*#__PURE__*/_jsxDEV(TitlePage, {\n        title: \"Danh s\\xE1ch m\\xE3 khuy\\u1EBFn m\\xE3i\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-12\",\n      children: /*#__PURE__*/_jsxDEV(PowerTable, {\n        loading: isLoading,\n        currentPage: currentPage,\n        totalPage: totalPage && totalPage,\n        getPagination: getPagination,\n        addClass: \"basic-header\",\n        TitleCard: /*#__PURE__*/_jsxDEV(DiscountForm, {\n          showAdd: true,\n          isLoading: isLoading,\n          _onSubmit: data => _onSubmit(data)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 17\n        }, this),\n        dataSource: dataTable,\n        columns: columns,\n        Extra: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"extra-table\",\n          children: [/*#__PURE__*/_jsxDEV(FilterDiscountTable, {\n            _onFilter: value => _onFilterTable(value),\n            _onHandleReset: handleReset\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 8\n          }, this), /*#__PURE__*/_jsxDEV(SortBox, {\n            handleSort: value => handleSort(value),\n            dataOption: dataOption\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 8\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 304,\n    columnNumber: 3\n  }, this);\n};\n\nDiscount.layout = LayoutBase;\nexport default Discount;","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/pages/option/discount/index.tsx"],"names":["React","useEffect","useState","FilterDiscountTable","SortBox","DiscountForm","LayoutBase","PowerTable","FilterColumn","TitlePage","Popconfirm","Button","useWrap","discountApi","X","moment","parseToMoney","ViewImage","dataOption","dataSort","sort","sortType","value","text","listField","DiscountCode","Status","pageIndex","Discount","showNoti","pageSize","dataTable","setDataTable","isLoading","setIsLoading","type","status","totalPage","setTotalPage","currentPage","setCurrentPage","activeColumnSearch","setActiveColumnSearch","rerender","setRerender","listTodoApi","todoApi","setTodoApi","getDataTable","res","getAll","data","length","handleReset","totalRow","now","Date","getTime","error","message","_onSubmit","ID","update","add","afterPost","getPagination","pageNumber","compareField","valueSearch","dataIndex","newList","Object","keys","forEach","key","onSearch","clearKey","handleDelele","param","handleSort","option","newTodoApi","title","_onFilterTable","fromDate","toDate","columns","width","className","render","code","record","DiscountType","Intl","NumberFormat","format","align","date","index","Enable","Images","layout"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport FilterDiscountTable from '~/components/Global/Option/FilterTable/FilterDiscountTable'\r\nimport SortBox from '~/components/Elements/SortBox'\r\nimport DiscountForm from '~/components/Global/Option/DiscountForm'\r\nimport LayoutBase from '~/components/LayoutBase'\r\nimport PowerTable from '~/components/PowerTable'\r\nimport FilterColumn from '~/components/Tables/FilterColumn'\r\nimport TitlePage from '~/components/TitlePage'\r\nimport { Popconfirm, Button } from 'antd'\r\nimport { useWrap } from '~/context/wrap'\r\nimport { discountApi } from '~/apiBase'\r\nimport { X } from 'react-feather'\r\nimport moment from 'moment'\r\nimport { parseToMoney } from '~/utils/functions'\r\nimport ViewImage from './show-image'\r\n\r\n// SORT\r\nconst dataOption = [\r\n\t{\r\n\t\tdataSort: {\r\n\t\t\tsort: 2,\r\n\t\t\tsortType: false\r\n\t\t},\r\n\t\tvalue: 3,\r\n\t\ttext: 'Tên giảm dần'\r\n\t},\r\n\t{\r\n\t\tdataSort: {\r\n\t\t\tsort: 2,\r\n\t\t\tsortType: true\r\n\t\t},\r\n\t\tvalue: 4,\r\n\t\ttext: 'Tên tăng dần '\r\n\t}\r\n]\r\n\r\nlet listField = { DiscountCode: '', Status: '' }\r\nlet pageIndex = 1\r\n\r\nconst Discount = () => {\r\n\tconst { showNoti, pageSize } = useWrap()\r\n\r\n\tconst [dataTable, setDataTable] = useState<IDiscount[]>([])\r\n\tconst [isLoading, setIsLoading] = useState({ type: '', status: false })\r\n\tconst [totalPage, setTotalPage] = useState(null)\r\n\tconst [currentPage, setCurrentPage] = useState(1)\r\n\tconst [activeColumnSearch, setActiveColumnSearch] = useState('')\r\n\r\n\tconst [rerender, setRerender] = useState<any>('')\r\n\r\n\t// PARAMS API GETALL\r\n\tconst listTodoApi = {\r\n\t\tpageSize: pageSize,\r\n\t\tpageIndex: pageIndex,\r\n\t\tsort: null,\r\n\t\tsortType: null,\r\n\t\tDiscountCode: null,\r\n\t\tStatus: null\r\n\t}\r\n\r\n\tconst [todoApi, setTodoApi] = useState(listTodoApi)\r\n\r\n\t// GET DATA STAFFSALARY\r\n\tconst getDataTable = async () => {\r\n\t\tsetIsLoading({ type: 'GET_ALL', status: true })\r\n\t\ttry {\r\n\t\t\tlet res = await discountApi.getAll(todoApi)\r\n\t\t\tif (res.status == 204) {\r\n\t\t\t\tshowNoti('danger', 'Không có dữ liệu')\r\n\t\t\t\tsetDataTable([])\r\n\t\t\t}\r\n\t\t\tif (res.status == 200) {\r\n\t\t\t\tsetDataTable(res.data.data)\r\n\t\t\t\tif (res.data.data.length < 1) {\r\n\t\t\t\t\thandleReset()\r\n\t\t\t\t}\r\n\t\t\t\tsetTotalPage(res.data.totalRow)\r\n\t\t\t\tlet now = new Date().getTime()\r\n\t\t\t\tsetRerender(now)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({ type: 'GET_ALL', status: false })\r\n\t\t}\r\n\t}\r\n\r\n\t// ADD DATA\r\n\tconst _onSubmit = async (data: any) => {\r\n\t\tsetIsLoading({ type: 'ADD_DATA', status: true })\r\n\t\tlet res = null\r\n\t\tif (data.ID) {\r\n\t\t\ttry {\r\n\t\t\t\tres = await discountApi.update(data)\r\n\t\t\t\tres?.status == 200 && showNoti('success', 'Cập nhật thành công'), getDataTable()\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({ type: 'ADD_DATA', status: false })\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttry {\r\n\t\t\t\tres = await discountApi.add(data)\r\n\t\t\t\tres?.status == 200 && afterPost('Thêm')\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({ type: 'ADD_DATA', status: false })\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst afterPost = (value) => {\r\n\t\tshowNoti('success', `${value} thành công`)\r\n\t\tsetTodoApi({ ...listTodoApi, pageIndex: 1 })\r\n\t\tsetCurrentPage(1)\r\n\t}\r\n\r\n\t// PAGINATION\r\n\tconst getPagination = (pageNumber: number, pageSize: number) => {\r\n\t\tif (!pageSize) pageSize = 10\r\n\t\tpageIndex = pageNumber\r\n\t\tsetCurrentPage(pageNumber)\r\n\t\tsetTodoApi({ ...todoApi, pageIndex: pageIndex, pageSize: pageSize })\r\n\t}\r\n\r\n\t// ON SEARCH\r\n\tconst compareField = (valueSearch, dataIndex) => {\r\n\t\tlet newList = null\r\n\t\tObject.keys(listField).forEach(function (key) {\r\n\t\t\tif (key != dataIndex) {\r\n\t\t\t\tlistField[key] = ''\r\n\t\t\t} else {\r\n\t\t\t\tlistField[key] = valueSearch\r\n\t\t\t}\r\n\t\t})\r\n\t\tnewList = listField\r\n\t\treturn newList\r\n\t}\r\n\r\n\tconst onSearch = (valueSearch, dataIndex) => {\r\n\t\tlet clearKey = compareField(valueSearch, dataIndex)\r\n\t\tsetTodoApi({ ...todoApi, pageIndex: 1, ...clearKey })\r\n\t}\r\n\r\n\t// DELETE\r\n\tconst handleDelele = async (param) => {\r\n\t\tif (param) {\r\n\t\t\tlet res = null\r\n\t\t\ttry {\r\n\t\t\t\tres = await discountApi.update(param)\r\n\t\t\t\tres.status === 200 && showNoti('success', 'Xóa thành công')\r\n\t\t\t\tif (dataTable.length === 1) {\r\n\t\t\t\t\tlistTodoApi.pageIndex === 1\r\n\t\t\t\t\t\t? setTodoApi({ ...listTodoApi, pageIndex: 1 })\r\n\t\t\t\t\t\t: setTodoApi({ ...listTodoApi, pageIndex: listTodoApi.pageIndex - 1 })\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tgetDataTable()\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({ type: 'DELETE_DATA', status: false })\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// HANDLE RESET\r\n\tconst handleReset = () => {\r\n\t\tsetActiveColumnSearch('')\r\n\t\tsetTodoApi({ ...listTodoApi, pageIndex: 1 })\r\n\t\tsetCurrentPage(1)\r\n\t}\r\n\r\n\t// HANDLE SORT\r\n\tconst handleSort = async (option) => {\r\n\t\tlet newTodoApi = { ...listTodoApi, sort: option.title.sort, sortType: option.title.sortType }\r\n\t\tsetCurrentPage(1)\r\n\t\tsetTodoApi(newTodoApi)\r\n\t}\r\n\r\n\t// HANDLE FILTER\r\n\tconst _onFilterTable = (data) => {\r\n\t\tlet newTodoApi = {\r\n\t\t\t...listTodoApi,\r\n\t\t\tfromDate: data.fromDate,\r\n\t\t\ttoDate: data.toDate,\r\n\t\t\tStatus: data.Status\r\n\t\t}\r\n\t\tsetCurrentPage(1)\r\n\t\tsetTodoApi(newTodoApi)\r\n\t}\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Mã khuyến mãi',\r\n\t\t\twidth: 150,\r\n\t\t\tdataIndex: 'DiscountCode',\r\n\t\t\t...FilterColumn('DiscountCode', onSearch, handleReset, 'text'),\r\n\t\t\tclassName: activeColumnSearch === 'ID' ? 'active-column-search' : '',\r\n\t\t\trender: (code) => <span className=\"tag green\">{code}</span>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Khuyến mãi',\r\n\t\t\tdataIndex: 'Discount',\r\n\t\t\twidth: 150,\r\n\t\t\trender: (text, record) => {\r\n\t\t\t\tif (record.DiscountType == 2) {\r\n\t\t\t\t\treturn <p className=\"font-weight-primary\">{text}%</p>\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn <p className=\"font-weight-primary\">{Intl.NumberFormat('ja-JP').format(text)}</p>\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Gói',\r\n\t\t\tdataIndex: 'StyleName',\r\n\t\t\twidth: 150,\r\n\t\t\trender: (text, record) => {\r\n\t\t\t\treturn <p className=\"font-weight-black\">{text}</p>\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Trạng thái',\r\n\t\t\twidth: 150,\r\n\t\t\talign: 'center',\r\n\t\t\tdataIndex: 'StatusName',\r\n\t\t\trender: (text: any, record: any) => {\r\n\t\t\t\tswitch (record.Status) {\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\treturn <span className=\"tag green\">{text}</span>\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\treturn <span className=\"tag yellow\">{text}</span>\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\treturn <span className=\"tag red\">{text}</span>\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Đơn hàng tối thiểu',\r\n\t\t\talign: 'center',\r\n\t\t\twidth: 200,\r\n\t\t\tdataIndex: 'MinimumOrder',\r\n\t\t\trender: (data: string, value) => <>{parseToMoney(data)}đ</>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Giảm tối đa',\r\n\t\t\talign: 'center',\r\n\t\t\twidth: 200,\r\n\t\t\tdataIndex: 'MaxDiscountPrice',\r\n\t\t\trender: (data: string, value) => <>{parseToMoney(data)}đ</>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Số lượng',\r\n\t\t\talign: 'center',\r\n\t\t\twidth: 100,\r\n\t\t\tdataIndex: 'Quantity'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Số lượng đã dùng',\r\n\t\t\twidth: 200,\r\n\t\t\talign: 'center',\r\n\t\t\tdataIndex: 'QuantityLeft'\r\n\t\t},\r\n\t\t{ title: 'Ghi chú', width: 200, dataIndex: 'Note' },\r\n\t\t{\r\n\t\t\ttitle: 'Thời hạn',\r\n\t\t\tdataIndex: 'DeadLine',\r\n\t\t\trender: (date) => moment(date).format('DD/MM/YYYY')\r\n\t\t},\r\n\t\t{\r\n\t\t\talign: 'right',\r\n\t\t\trender: (record, text, index) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<DiscountForm showIcon={true} rowData={record} isLoading={isLoading} _onSubmit={(data: any) => _onSubmit(data)} />\r\n\t\t\t\t\t<Popconfirm\r\n\t\t\t\t\t\tplacement=\"left\"\r\n\t\t\t\t\t\ttitle=\"Bạn có chắc chắn muốn xóa không?\"\r\n\t\t\t\t\t\tonConfirm={() =>\r\n\t\t\t\t\t\t\thandleDelele({\r\n\t\t\t\t\t\t\t\tID: record.ID,\r\n\t\t\t\t\t\t\t\tEnable: false\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tokText=\"Xóa\"\r\n\t\t\t\t\t\tcancelText=\"Huỷ\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Button className=\"btn btn-icon delete\">\r\n\t\t\t\t\t\t\t<X />\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Popconfirm>\r\n\t\t\t\t\t<ViewImage url={record?.Images} />\r\n\t\t\t\t</>\r\n\t\t\t)\r\n\t\t}\r\n\t]\r\n\r\n\tuseEffect(() => {\r\n\t\tgetDataTable()\r\n\t}, [todoApi])\r\n\r\n\treturn (\r\n\t\t<div className=\"row\">\r\n\t\t\t<div className=\"col-12\">\r\n\t\t\t\t<TitlePage title=\"Danh sách mã khuyến mãi\" />\r\n\t\t\t</div>\r\n\t\t\t<div className=\"col-12\">\r\n\t\t\t\t<PowerTable\r\n\t\t\t\t\tloading={isLoading}\r\n\t\t\t\t\tcurrentPage={currentPage}\r\n\t\t\t\t\ttotalPage={totalPage && totalPage}\r\n\t\t\t\t\tgetPagination={getPagination}\r\n\t\t\t\t\taddClass=\"basic-header\"\r\n\t\t\t\t\tTitleCard={<DiscountForm showAdd={true} isLoading={isLoading} _onSubmit={(data: any) => _onSubmit(data)} />}\r\n\t\t\t\t\tdataSource={dataTable}\r\n\t\t\t\t\tcolumns={columns}\r\n\t\t\t\t\tExtra={\r\n\t\t\t\t\t\t<div className=\"extra-table\">\r\n\t\t\t\t\t\t\t<FilterDiscountTable _onFilter={(value: any) => _onFilterTable(value)} _onHandleReset={handleReset} />\r\n\t\t\t\t\t\t\t<SortBox handleSort={(value) => handleSort(value)} dataOption={dataOption} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nDiscount.layout = LayoutBase\r\nexport default Discount\r\n"]},"metadata":{},"sourceType":"module"}