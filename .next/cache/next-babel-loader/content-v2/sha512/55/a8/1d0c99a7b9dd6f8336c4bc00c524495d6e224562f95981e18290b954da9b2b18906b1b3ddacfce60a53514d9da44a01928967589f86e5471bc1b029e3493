{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\CourseList\\\\CourseListDetail\\\\Homework\\\\Homework.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Popconfirm, Select, Tooltip } from 'antd';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport { homeworkApi } from '~/apiBase/course-detail/home-work';\nimport { rollUpApi } from '~/apiBase/course-detail/roll-up';\nimport { examTopicApi } from '~/apiBase/options/exam-topic';\nimport { useWrap } from '~/context/wrap';\nimport ModalCreateExercise from './ModalCreateExercise';\nimport Link from 'next/link';\nimport ExpandTable from '~/components/ExpandTable';\nimport TableDetail from './TableDetail';\nimport ExamAppointmentPoint from '~/components/Global/ExamAppointment/ExamAppointmentPoint';\nimport { DeleteOutlined, ExclamationCircleOutlined } from '@ant-design/icons';\nHomework.propTypes = {\n  courseID: PropTypes.number,\n  CurriculumID: PropTypes.any\n};\n\nfunction Homework(props) {\n  const {\n    courseID,\n    CurriculumID\n  } = props;\n  const {\n    showNoti,\n    isAdmin,\n    userInformation\n  } = useWrap();\n  const {\n    0: dataRollUp,\n    1: setDataRollUp\n  } = useState({\n    RollUp: [],\n    ScheduleList: [],\n    StudentList: []\n  });\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState({\n    type: 'GET_ALL',\n    status: false\n  });\n  const {\n    0: totalPage,\n    1: setTotalPage\n  } = useState(null);\n  const {\n    Option\n  } = Select; // FILTER\n\n  const {\n    0: filters,\n    1: setFilters\n  } = useState({\n    pageSize: 10,\n    pageIndex: 1,\n    CourseScheduleID: 0,\n    StudentID: 0\n  }); // PAGE NUMBER\n\n  const getPagination = pageNumber => {\n    setFilters(_objectSpread(_objectSpread({}, filters), {}, {\n      pageIndex: pageNumber\n    }));\n  };\n\n  const {\n    0: scheduleSelected,\n    1: setScheduleSelected\n  } = useState(-1);\n  const {\n    0: itemSelected,\n    1: setItemSelected\n  } = useState(-1);\n\n  const onSelectCourseSchedule = CourseScheduleID => {\n    setScheduleSelected(CourseScheduleID);\n    const item = dataRollUp.ScheduleList.find(na => na.value == CourseScheduleID); // @ts-ignore\n\n    setItemSelected(item === null || item === void 0 ? void 0 : item.CurriculumsDetailID);\n    getHomeWorkList(_objectSpread({\n      CourseID: props.courseID,\n      CurriculumDetailID: CourseScheduleID == -1 ? null : item === null || item === void 0 ? void 0 : item.CurriculumsDetailID\n    }, filters));\n  }; // GET ROLL UP\n\n\n  const getRollUpList = async () => {\n    try {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: true\n      });\n      const res = await rollUpApi.getAll(filters);\n\n      if (res.status === 200) {\n        const {\n          RollUp,\n          ScheduleList,\n          StudentList,\n          TotalRow\n        } = res.data;\n        const fmScheduleList = ScheduleList.map((item, index) => {\n          const date = moment(item.StartTime).format('DD/MM/YYYY');\n          const startTime = moment(item.StartTime).format('HH:mm');\n          const endTime = moment(item.EndTime).format('HH:mm');\n          return {\n            value: item.ID,\n            // @ts-ignore\n            CurriculumsDetailID: item.CurriculumsDetailID,\n            title: `${item.RoomName ? `[${item.RoomName}]` : ''}[${date}] ${startTime} - ${endTime}`,\n            options: {\n              BranchID: item.BranchID\n            }\n          };\n        });\n        const fmStudentList = StudentList.map(s => {\n          const studentRollUp = RollUp.find(r => r.StudentID === s.StudentID);\n          const moreInfo = {\n            RollUpID: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.ID) || 0,\n            BranchID: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.BranchID) || 0,\n            CourseScheduleID: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.CourseScheduleID) || 0,\n            Note: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.Note) || '',\n            StatusID: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.StatusID) || 0,\n            StatusName: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.StatusName) || '',\n            LearningStatusID: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.LearningStatusID) || 0,\n            LearningStatusName: (studentRollUp === null || studentRollUp === void 0 ? void 0 : studentRollUp.LearningStatusName) || ''\n          };\n          return _objectSpread(_objectSpread({}, s), moreInfo);\n        });\n        setDataRollUp({\n          RollUp,\n          // @ts-ignore\n          ScheduleList: [{\n            value: -1,\n            CurriculumsDetailID: -1,\n            title: '---Chọn ca học---'\n          }, ...fmScheduleList],\n          StudentList: fmStudentList\n        });\n        setTotalPage(TotalRow);\n      }\n\n      if (res.status === 204) {\n        showNoti('danger', 'Không tìm thấy');\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: false\n      });\n    }\n  };\n\n  useEffect(() => {\n    getRollUpList();\n    getHomeWorkList(_objectSpread({\n      CourseID: props.courseID,\n      CurriculumDetailID: scheduleSelected == -1 ? null : itemSelected\n    }, filters));\n  }, [filters]);\n\n  const deleteHomework = async params => {\n    try {\n      const res = await homeworkApi.update(params);\n      res.status == 200 && getHomeWorkList(_objectSpread({\n        CourseID: props.courseID,\n        CurriculumDetailID: scheduleSelected == -1 ? null : itemSelected\n      }, filters));\n    } catch (error) {\n      showNoti('danger', error.message);\n    }\n  };\n\n  const columns = [{\n    title: 'Đề thi',\n    dataIndex: 'ExamTopicName',\n    render: text => /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-weight-primary\",\n      children: text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 22\n    }, this)\n  }, {\n    title: 'Ngày bắt đầu',\n    dataIndex: 'DateStart',\n    render: text => /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-weight-primary\",\n      children: moment(text).format('DD/MM/yyy')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 22\n    }, this)\n  }, {\n    title: 'Ngày kết thúc',\n    dataIndex: 'DateEnd',\n    render: text => /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-weight-primary\",\n      children: moment(text).format('DD/MM/yyy')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 22\n    }, this)\n  }, {\n    title: 'Trạng thái',\n    dataIndex: 'StatusName',\n    align: 'center',\n    render: value => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: value == 'Chưa bắt đầu' ? /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"tag gray\",\n        children: value\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 34\n      }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"tag green\",\n        children: value\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 78\n      }, this)\n    }, void 0, false)\n  }, {\n    width: 120,\n    title: 'Hành động',\n    dataIndex: 'Warning',\n    align: 'center',\n    render: (warning, item, idx) => {\n      return /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) == 1 || (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) == 2 ? /*#__PURE__*/_jsxDEV(Popconfirm, {\n          title: \"B\\u1EA1n mu\\u1ED1n x\\xF3a b\\xE0i t\\u1EADp n\\xE0y?\",\n          onConfirm: () => deleteHomework({\n            ID: item.ID,\n            Enable: false\n          }),\n          okText: \"Yes\",\n          cancelText: \"No\",\n          children: /*#__PURE__*/_jsxDEV(Tooltip, {\n            title: \"Xo\\xE1 b\\xE0i t\\u1EADp\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-icon\",\n              children: /*#__PURE__*/_jsxDEV(DeleteOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 220,\n                columnNumber: 11\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 8\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: item.isSubmitted ? /*#__PURE__*/_jsxDEV(Link, {\n            href: {\n              pathname: '/course/exercise/result/[slug]',\n              query: {\n                slug: item.ID,\n                examID: item.ExamTopicID,\n                ExamAppointmentResultID: item.ExamAppointmentResultID\n              }\n            },\n            children: /*#__PURE__*/_jsxDEV(Tooltip, {\n              title: \"Chi ti\\u1EBFt k\\u1EBFt qu\\u1EA3\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-icon\",\n                children: /*#__PURE__*/_jsxDEV(ExclamationCircleOutlined, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 13\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 12\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 10\n          }, this) : /*#__PURE__*/_jsxDEV(Link, {\n            href: {\n              pathname: '/exam/exam-review',\n              query: {\n                examID: item.ExamTopicID,\n                isExercise: true,\n                packageDetailID: item.ID,\n                type: 'examination' // Thi cử\n\n              }\n            },\n            children: /*#__PURE__*/_jsxDEV(Tooltip, {\n              title: \"L\\xE0m b\\xE0i t\\u1EADp\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-icon exchange\",\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-edit\",\n                  style: {\n                    color: item.isSubmitted ? '#CFD8DC' : '#34c4a4',\n                    fontSize: 16\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 257,\n                  columnNumber: 13\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 12\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 10\n          }, this)\n        }, void 0, false)\n      }, void 0, false);\n    }\n  }];\n  const {\n    0: examTopics,\n    1: setExamTopics\n  } = useState([]);\n  const {\n    0: homeWorks,\n    1: setHomeWorks\n  } = useState([]);\n  useEffect(() => {\n    getDataExam();\n  }, []); // GET EXAM TOPIC\n\n  const getDataExam = async () => {\n    try {\n      let res = await examTopicApi.getAll({\n        selectAll: true,\n        type: 4,\n        CurriculumID: CurriculumID\n      });\n\n      if (res.status === 200) {\n        setTotalPage(res.data.totalRow);\n        setExamTopics(res.data.data);\n      }\n    } catch (error) {\n      console.log('Error Exam: ', error.message);\n      showNoti('danger', error.message);\n    }\n  }; // GET HOMEWORK LIST\n\n\n  const getHomeWorkList = async params => {\n    try {\n      const res = await homeworkApi.getAll(params);\n\n      if (res.status === 200) {\n        setHomeWorks(res.data.data);\n      }\n\n      if (res.status === 204) {\n        setHomeWorks([]);\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    }\n  };\n\n  const expandedRowRender = (record, x, y, visible) => {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          fontWeight: 500\n        },\n        className: \"mt-3 mb-2\",\n        children: \"Chi ti\\u1EBFt\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: record.Note\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 5\n      }, this), (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) == 1 || (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) == 2 ? /*#__PURE__*/_jsxDEV(TableDetail, {\n        dataRow: record,\n        visible: visible,\n        courseID: props.courseID,\n        CurriculumID: props.CurriculumID\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 6\n      }, this) : /*#__PURE__*/_jsxDEV(ExamAppointmentPoint, {\n        isExercise: true,\n        visible: visible,\n        infoID: record.ID,\n        userID: userInformation === null || userInformation === void 0 ? void 0 : userInformation.UserInformationID\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(ExpandTable, {\n      loading: isLoading,\n      currentPage: filters.pageIndex,\n      totalPage: totalPage,\n      getPagination: getPagination,\n      dataSource: homeWorks,\n      columns: columns,\n      Extra: scheduleSelected !== -1 && ((userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) == 1 || (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) == 2) ? /*#__PURE__*/_jsxDEV(ModalCreateExercise, {\n        dataExam: examTopics,\n        courseID: props.courseID,\n        onFetchData: () => getHomeWorkList(_objectSpread({\n          CourseID: props.courseID,\n          CurriculumDetailID: scheduleSelected == -1 ? null : itemSelected\n        }, filters)),\n        CurriculumID: scheduleSelected\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 7\n      }, this) : null,\n      TitleCard: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex align-items-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"\",\n          children: /*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Ca h\\u1ECDc:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(Select, {\n            placeholder: \"Ch\\u1ECDn ca h\\u1ECDc\",\n            defaultValue: null,\n            style: {\n              width: 280,\n              paddingLeft: 20,\n              marginBottom: 0\n            },\n            className: \"style-input\",\n            onChange: onSelectCourseSchedule,\n            children: dataRollUp.ScheduleList.map((o, idx) => /*#__PURE__*/_jsxDEV(Option, {\n              value: o.value,\n              children: o.title\n            }, idx, false, {\n              fileName: _jsxFileName,\n              lineNumber: 365,\n              columnNumber: 10\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 6\n      }, this),\n      expandable: {\n        expandedRowRender\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 4\n    }, this)\n  }, void 0, false);\n}\n\nexport default Homework;","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/CourseList/CourseListDetail/Homework/Homework.tsx"],"names":["Popconfirm","Select","Tooltip","moment","PropTypes","React","useEffect","useState","homeworkApi","rollUpApi","examTopicApi","useWrap","ModalCreateExercise","Link","ExpandTable","TableDetail","ExamAppointmentPoint","DeleteOutlined","ExclamationCircleOutlined","Homework","propTypes","courseID","number","CurriculumID","any","props","showNoti","isAdmin","userInformation","dataRollUp","setDataRollUp","RollUp","ScheduleList","StudentList","isLoading","setIsLoading","type","status","totalPage","setTotalPage","Option","filters","setFilters","pageSize","pageIndex","CourseScheduleID","StudentID","getPagination","pageNumber","scheduleSelected","setScheduleSelected","itemSelected","setItemSelected","onSelectCourseSchedule","item","find","na","value","CurriculumsDetailID","getHomeWorkList","CourseID","CurriculumDetailID","getRollUpList","res","getAll","TotalRow","data","fmScheduleList","map","index","date","StartTime","format","startTime","endTime","EndTime","ID","title","RoomName","options","BranchID","fmStudentList","s","studentRollUp","r","moreInfo","RollUpID","Note","StatusID","StatusName","LearningStatusID","LearningStatusName","error","message","deleteHomework","params","update","columns","dataIndex","render","text","align","width","warning","idx","RoleID","Enable","isSubmitted","pathname","query","slug","examID","ExamTopicID","ExamAppointmentResultID","isExercise","packageDetailID","color","fontSize","examTopics","setExamTopics","homeWorks","setHomeWorks","getDataExam","selectAll","totalRow","console","log","expandedRowRender","record","x","y","visible","fontWeight","UserInformationID","paddingLeft","marginBottom","o"],"mappings":"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","sourcesContent":["import { Input, Popconfirm, Select, Tooltip } from 'antd'\r\nimport moment from 'moment'\r\nimport PropTypes from 'prop-types'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { homeworkApi } from '~/apiBase/course-detail/home-work'\r\nimport { rollUpApi } from '~/apiBase/course-detail/roll-up'\r\nimport { examTopicApi } from '~/apiBase/options/exam-topic'\r\nimport { useWrap } from '~/context/wrap'\r\nimport ModalCreateExercise from './ModalCreateExercise'\r\nimport Link from 'next/link'\r\nimport ExpandTable from '~/components/ExpandTable'\r\nimport TableDetail from './TableDetail'\r\nimport ExamAppointmentPoint from '~/components/Global/ExamAppointment/ExamAppointmentPoint'\r\nimport { DeleteOutlined, ExclamationCircleOutlined, FormOutlined } from '@ant-design/icons'\r\n\r\nHomework.propTypes = {\r\n\tcourseID: PropTypes.number,\r\n\tCurriculumID: PropTypes.any\r\n}\r\n\r\ninterface IStudentRollUp {\r\n\tID: number\r\n\tCourseID: number\r\n\tStudentID: number\r\n\tStudentName: string\r\n\tMobile: string\r\n\tEmail: string\r\n\tAcademicName: string\r\n\tDayOff: number\r\n\tWarning: boolean\r\n\tRollUpID: number\r\n\tBranchID: number\r\n\tCourseScheduleID: number\r\n\tNote: string\r\n\tStatusID: number\r\n\tStatusName: string\r\n\tLearningStatusID: number\r\n\tLearningStatusName: string\r\n}\r\n\r\ntype TypeDataRollUp = {\r\n\tRollUp: IRollUp[]\r\n\tScheduleList: IOptionCommon[]\r\n\tStudentList: IStudentRollUp[]\r\n}\r\n\r\nfunction Homework(props) {\r\n\tconst { courseID, CurriculumID } = props\r\n\tconst { showNoti, isAdmin, userInformation } = useWrap()\r\n\tconst [dataRollUp, setDataRollUp] = useState<TypeDataRollUp>({\r\n\t\tRollUp: [],\r\n\t\tScheduleList: [],\r\n\t\tStudentList: []\r\n\t})\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: 'GET_ALL',\r\n\t\tstatus: false\r\n\t})\r\n\tconst [totalPage, setTotalPage] = useState(null)\r\n\tconst { Option } = Select\r\n\r\n\t// FILTER\r\n\tconst [filters, setFilters] = useState({\r\n\t\tpageSize: 10,\r\n\t\tpageIndex: 1,\r\n\t\tCourseScheduleID: 0,\r\n\t\tStudentID: 0\r\n\t})\r\n\r\n\t// PAGE NUMBER\r\n\tconst getPagination = (pageNumber: number) => {\r\n\t\tsetFilters({\r\n\t\t\t...filters,\r\n\t\t\tpageIndex: pageNumber\r\n\t\t})\r\n\t}\r\n\r\n\tconst [scheduleSelected, setScheduleSelected] = useState(-1)\r\n\tconst [itemSelected, setItemSelected] = useState(-1)\r\n\r\n\tconst onSelectCourseSchedule = (CourseScheduleID) => {\r\n\t\tsetScheduleSelected(CourseScheduleID)\r\n\r\n\t\tconst item: any = dataRollUp.ScheduleList.find((na: any) => na.value == CourseScheduleID)\r\n\t\t// @ts-ignore\r\n\t\tsetItemSelected(item?.CurriculumsDetailID)\r\n\t\tgetHomeWorkList({\r\n\t\t\tCourseID: props.courseID,\r\n\t\t\tCurriculumDetailID: CourseScheduleID == -1 ? null : item?.CurriculumsDetailID,\r\n\t\t\t...filters\r\n\t\t})\r\n\t}\r\n\r\n\t// GET ROLL UP\r\n\tconst getRollUpList = async () => {\r\n\t\ttry {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: true\r\n\t\t\t})\r\n\t\t\tconst res: any = await rollUpApi.getAll(filters)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tconst { RollUp, ScheduleList, StudentList, TotalRow } = res.data\r\n\t\t\t\tconst fmScheduleList = ScheduleList.map((item, index) => {\r\n\t\t\t\t\tconst date = moment(item.StartTime).format('DD/MM/YYYY')\r\n\t\t\t\t\tconst startTime = moment(item.StartTime).format('HH:mm')\r\n\t\t\t\t\tconst endTime = moment(item.EndTime).format('HH:mm')\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tvalue: item.ID,\r\n\t\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t\tCurriculumsDetailID: item.CurriculumsDetailID,\r\n\t\t\t\t\t\ttitle: `${item.RoomName ? `[${item.RoomName}]` : ''}[${date}] ${startTime} - ${endTime}`,\r\n\t\t\t\t\t\toptions: {\r\n\t\t\t\t\t\t\tBranchID: item.BranchID\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tconst fmStudentList = StudentList.map((s) => {\r\n\t\t\t\t\tconst studentRollUp = RollUp.find((r) => r.StudentID === s.StudentID)\r\n\t\t\t\t\tconst moreInfo = {\r\n\t\t\t\t\t\tRollUpID: studentRollUp?.ID || 0,\r\n\t\t\t\t\t\tBranchID: studentRollUp?.BranchID || 0,\r\n\t\t\t\t\t\tCourseScheduleID: studentRollUp?.CourseScheduleID || 0,\r\n\t\t\t\t\t\tNote: studentRollUp?.Note || '',\r\n\t\t\t\t\t\tStatusID: studentRollUp?.StatusID || 0,\r\n\t\t\t\t\t\tStatusName: studentRollUp?.StatusName || '',\r\n\t\t\t\t\t\tLearningStatusID: studentRollUp?.LearningStatusID || 0,\r\n\t\t\t\t\t\tLearningStatusName: studentRollUp?.LearningStatusName || ''\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...s,\r\n\t\t\t\t\t\t...moreInfo\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tsetDataRollUp({\r\n\t\t\t\t\tRollUp,\r\n\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\tScheduleList: [{ value: -1, CurriculumsDetailID: -1, title: '---Chọn ca học---' }, ...fmScheduleList],\r\n\t\t\t\t\tStudentList: fmStudentList\r\n\t\t\t\t})\r\n\t\t\t\tsetTotalPage(TotalRow)\r\n\t\t\t}\r\n\t\t\tif (res.status === 204) {\r\n\t\t\t\tshowNoti('danger', 'Không tìm thấy')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tgetRollUpList()\r\n\t\tgetHomeWorkList({\r\n\t\t\tCourseID: props.courseID,\r\n\t\t\tCurriculumDetailID: scheduleSelected == -1 ? null : itemSelected,\r\n\t\t\t...filters\r\n\t\t})\r\n\t}, [filters])\r\n\r\n\tconst deleteHomework = async (params) => {\r\n\t\ttry {\r\n\t\t\tconst res = await homeworkApi.update(params)\r\n\t\t\tres.status == 200 &&\r\n\t\t\t\tgetHomeWorkList({\r\n\t\t\t\t\tCourseID: props.courseID,\r\n\t\t\t\t\tCurriculumDetailID: scheduleSelected == -1 ? null : itemSelected,\r\n\t\t\t\t\t...filters\r\n\t\t\t\t})\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t}\r\n\t}\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Đề thi',\r\n\t\t\tdataIndex: 'ExamTopicName',\r\n\t\t\trender: (text) => <p className=\"font-weight-primary\">{text}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Ngày bắt đầu',\r\n\t\t\tdataIndex: 'DateStart',\r\n\t\t\trender: (text) => <p className=\"font-weight-primary\">{moment(text).format('DD/MM/yyy')}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Ngày kết thúc',\r\n\t\t\tdataIndex: 'DateEnd',\r\n\t\t\trender: (text) => <p className=\"font-weight-primary\">{moment(text).format('DD/MM/yyy')}</p>\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Trạng thái',\r\n\t\t\tdataIndex: 'StatusName',\r\n\t\t\talign: 'center',\r\n\t\t\trender: (value) => (\r\n\t\t\t\t<>{value == 'Chưa bắt đầu' ? <span className=\"tag gray\">{value}</span> : <span className=\"tag green\">{value}</span>}</>\r\n\t\t\t)\r\n\t\t},\r\n\t\t{\r\n\t\t\twidth: 120,\r\n\t\t\ttitle: 'Hành động',\r\n\t\t\tdataIndex: 'Warning',\r\n\t\t\talign: 'center',\r\n\t\t\trender: (warning, item: any, idx) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t{userInformation?.RoleID == 1 || userInformation?.RoleID == 2 ? (\r\n\t\t\t\t\t\t\t<Popconfirm\r\n\t\t\t\t\t\t\t\ttitle=\"Bạn muốn xóa bài tập này?\"\r\n\t\t\t\t\t\t\t\tonConfirm={() => deleteHomework({ ID: item.ID, Enable: false })}\r\n\t\t\t\t\t\t\t\tokText=\"Yes\"\r\n\t\t\t\t\t\t\t\tcancelText=\"No\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Tooltip title=\"Xoá bài tập\">\r\n\t\t\t\t\t\t\t\t\t<button className=\"btn btn-icon\">\r\n\t\t\t\t\t\t\t\t\t\t<DeleteOutlined />\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t</Popconfirm>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t{item.isSubmitted ? (\r\n\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\thref={{\r\n\t\t\t\t\t\t\t\t\t\t\tpathname: '/course/exercise/result/[slug]',\r\n\t\t\t\t\t\t\t\t\t\t\tquery: {\r\n\t\t\t\t\t\t\t\t\t\t\t\tslug: item.ID,\r\n\t\t\t\t\t\t\t\t\t\t\t\texamID: item.ExamTopicID,\r\n\t\t\t\t\t\t\t\t\t\t\t\tExamAppointmentResultID: item.ExamAppointmentResultID\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Chi tiết kết quả\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button className=\"btn btn-icon\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ExclamationCircleOutlined />\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\thref={{\r\n\t\t\t\t\t\t\t\t\t\t\tpathname: '/exam/exam-review',\r\n\t\t\t\t\t\t\t\t\t\t\tquery: {\r\n\t\t\t\t\t\t\t\t\t\t\t\texamID: item.ExamTopicID,\r\n\t\t\t\t\t\t\t\t\t\t\t\tisExercise: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\tpackageDetailID: item.ID,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'examination' // Thi cử\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Làm bài tập\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button className=\"btn btn-icon exchange\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<i className=\"fas fa-edit\" style={{ color: item.isSubmitted ? '#CFD8DC' : '#34c4a4', fontSize: 16 }} />\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n\r\n\tconst [examTopics, setExamTopics] = useState([])\r\n\tconst [homeWorks, setHomeWorks] = useState([])\r\n\r\n\tuseEffect(() => {\r\n\t\tgetDataExam()\r\n\t}, [])\r\n\r\n\t// GET EXAM TOPIC\r\n\tconst getDataExam = async () => {\r\n\t\ttry {\r\n\t\t\tlet res = await examTopicApi.getAll({\r\n\t\t\t\tselectAll: true,\r\n\t\t\t\ttype: 4,\r\n\t\t\t\tCurriculumID: CurriculumID\r\n\t\t\t})\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tsetTotalPage(res.data.totalRow)\r\n\t\t\t\tsetExamTopics(res.data.data)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('Error Exam: ', error.message)\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t}\r\n\t}\r\n\r\n\t// GET HOMEWORK LIST\r\n\tconst getHomeWorkList = async (params) => {\r\n\t\ttry {\r\n\t\t\tconst res = await homeworkApi.getAll(params)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tsetHomeWorks(res.data.data)\r\n\t\t\t}\r\n\t\t\tif (res.status === 204) {\r\n\t\t\t\tsetHomeWorks([])\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t}\r\n\t}\r\n\r\n\tconst expandedRowRender = (record, x, y, visible: boolean) => {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<p style={{ fontWeight: 500 }} className=\"mt-3 mb-2\">\r\n\t\t\t\t\tChi tiết\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>{record.Note}</p>\r\n\t\t\t\t{userInformation?.RoleID == 1 || userInformation?.RoleID == 2 ? (\r\n\t\t\t\t\t<TableDetail dataRow={record} visible={visible} courseID={props.courseID} CurriculumID={props.CurriculumID} />\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<ExamAppointmentPoint isExercise={true} visible={visible} infoID={record.ID} userID={userInformation?.UserInformationID} />\r\n\t\t\t\t)}\r\n\t\t\t</>\r\n\t\t)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<ExpandTable\r\n\t\t\t\tloading={isLoading}\r\n\t\t\t\tcurrentPage={filters.pageIndex}\r\n\t\t\t\ttotalPage={totalPage}\r\n\t\t\t\tgetPagination={getPagination}\r\n\t\t\t\tdataSource={homeWorks}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tExtra={\r\n\t\t\t\t\tscheduleSelected !== -1 && (userInformation?.RoleID == 1 || userInformation?.RoleID == 2) ? (\r\n\t\t\t\t\t\t<ModalCreateExercise\r\n\t\t\t\t\t\t\tdataExam={examTopics}\r\n\t\t\t\t\t\t\tcourseID={props.courseID}\r\n\t\t\t\t\t\t\tonFetchData={() =>\r\n\t\t\t\t\t\t\t\tgetHomeWorkList({\r\n\t\t\t\t\t\t\t\t\tCourseID: props.courseID,\r\n\t\t\t\t\t\t\t\t\tCurriculumDetailID: scheduleSelected == -1 ? null : itemSelected,\r\n\t\t\t\t\t\t\t\t\t...filters\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tCurriculumID={scheduleSelected}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) : null\r\n\t\t\t\t}\r\n\t\t\t\tTitleCard={\r\n\t\t\t\t\t<div className=\"d-flex align-items-center\">\r\n\t\t\t\t\t\t<div className=\"\">\r\n\t\t\t\t\t\t\t<b>Ca học:</b>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\tplaceholder=\"Chọn ca học\"\r\n\t\t\t\t\t\t\t\tdefaultValue={null}\r\n\t\t\t\t\t\t\t\tstyle={{ width: 280, paddingLeft: 20, marginBottom: 0 }}\r\n\t\t\t\t\t\t\t\tclassName=\"style-input\"\r\n\t\t\t\t\t\t\t\tonChange={onSelectCourseSchedule}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{dataRollUp.ScheduleList.map((o, idx) => (\r\n\t\t\t\t\t\t\t\t\t<Option key={idx} value={o.value}>\r\n\t\t\t\t\t\t\t\t\t\t{o.title}\r\n\t\t\t\t\t\t\t\t\t</Option>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t\texpandable={{ expandedRowRender }}\r\n\t\t\t/>\r\n\t\t</>\r\n\t)\r\n}\r\nexport default Homework\r\n"]},"metadata":{},"sourceType":"module"}