{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\ScheduleStudyTeacher\\\\ScheduleStudyTeacher.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Card } from 'antd';\nimport moment from 'moment';\nimport React, { useEffect, useState } from 'react';\nimport { scheduleZoomApi, zoomRoomApi } from '~/apiBase';\nimport TitlePage from '~/components/TitlePage';\nimport { useDebounce } from '~/context/useDebounce';\nimport { useWrap } from '~/context/wrap';\nimport CDCalendar from '../CourseList/CourseListDetail/CourseDetailCalendar/Calendar';\n\nvar ScheduleStudyTeacher = function ScheduleStudyTeacher() {\n  _s();\n\n  var _useWrap = useWrap(),\n      showNoti = _useWrap.showNoti;\n\n  var _useState = useState({\n    type: '',\n    status: false\n  }),\n      isLoading = _useState[0],\n      setIsLoading = _useState[1];\n\n  var _useState2 = useState([]),\n      scheduleTeacherList = _useState2[0],\n      setScheduleTeacherList = _useState2[1];\n\n  var _useState3 = useState({\n    StartTime: moment().startOf('month').format('YYYY/MM/DD'),\n    EndTime: moment().endOf('month').format('YYYY/MM/DD')\n  }),\n      filters = _useState3[0],\n      setFilters = _useState3[1];\n\n  var fetchScheduleStudyTeacher = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              setIsLoading({\n                type: 'FETCH_SCHEDULE_TEACHER',\n                status: true\n              });\n              _context.next = 4;\n              return scheduleZoomApi.getAll(filters);\n\n            case 4:\n              res = _context.sent;\n\n              if (res.status === 200) {\n                setScheduleTeacherList(res.data.data);\n              }\n\n              if (res.status === 204) {\n                showNoti('danger', 'Lịch dạy trống');\n              }\n\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              showNoti('danger', _context.t0.message);\n\n            case 12:\n              _context.prev = 12;\n              setIsLoading({\n                type: 'FETCH_SCHEDULE_TEACHER',\n                status: false\n              });\n              return _context.finish(12);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 9, 12, 15]]);\n    }));\n\n    return function fetchScheduleStudyTeacher() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    fetchScheduleStudyTeacher();\n  }, [filters]);\n\n  var fetchNewScheduleList = function fetchNewScheduleList(date) {\n    var fmDate;\n\n    if (date !== null && date !== void 0 && date.start && date !== null && date !== void 0 && date.end) {\n      fmDate = {\n        StartTime: moment(date.start).format('YYYY/MM/DD'),\n        EndTime: moment(date.end).format('YYYY/MM/DD')\n      };\n    }\n\n    if (Array.isArray(date) && date.length >= 1) {\n      fmDate = {\n        StartTime: moment(date[0]).format('YYYY/MM/DD'),\n        EndTime: moment(date[date.length - 1]).format('YYYY/MM/DD')\n      };\n    }\n\n    setFilters(fmDate || _objectSpread({}, filters));\n  };\n\n  var debounceFetchScheduleList = useDebounce(fetchNewScheduleList, 200, []);\n\n  var onHandleZoom = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data) {\n      var idx, btnID, btnName, scheduleID, res, newScheduleTeacherList, newScheduleTeacher, _res, _newScheduleTeacherList, _newScheduleTeacher;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              //0 - ,1-Bắt đầu , 2-Vào lớp học, 3-Kết thúc\n              idx = data.idx, btnID = data.btnID, btnName = data.btnName, scheduleID = data.scheduleID;\n\n              if (!(btnID === 1)) {\n                _context2.next = 8;\n                break;\n              }\n\n              setIsLoading({\n                type: 'FETCH_SCHEDULE_TEACHER',\n                status: true\n              });\n              _context2.next = 6;\n              return zoomRoomApi.createRoom(scheduleID);\n\n            case 6:\n              res = _context2.sent;\n\n              if (res.status === 200) {\n                newScheduleTeacherList = _toConsumableArray(scheduleTeacherList);\n                newScheduleTeacher = _objectSpread(_objectSpread({}, newScheduleTeacherList[idx]), {}, {\n                  ButtonName: 'Vào lớp học',\n                  ButtonID: 2\n                });\n                newScheduleTeacherList.splice(idx, 1, newScheduleTeacher);\n                setScheduleTeacherList(newScheduleTeacherList);\n                setIsLoading({\n                  type: 'FETCH_SCHEDULE_TEACHER',\n                  status: false\n                });\n\n                if (scheduleID) {\n                  window.open(\"/course/zoom-view/\".concat(scheduleID));\n                }\n              }\n\n            case 8:\n              if (btnID === 2 && scheduleID) {\n                window.open(\"/course/zoom-view/\".concat(scheduleID));\n              }\n\n              if (!(btnID === 3 && scheduleID)) {\n                _context2.next = 15;\n                break;\n              }\n\n              setIsLoading({\n                type: 'FETCH_SCHEDULE_TEACHER',\n                status: true\n              });\n              _context2.next = 13;\n              return zoomRoomApi.closeRoom(scheduleID);\n\n            case 13:\n              _res = _context2.sent;\n\n              if (_res.status === 200) {\n                _newScheduleTeacherList = _toConsumableArray(scheduleTeacherList);\n                _newScheduleTeacher = _objectSpread(_objectSpread({}, _newScheduleTeacherList[idx]), {}, {\n                  ButtonName: 'Kết thúc',\n                  ButtonID: 3\n                });\n\n                _newScheduleTeacherList.splice(idx, 1, _newScheduleTeacher);\n\n                setScheduleTeacherList(_newScheduleTeacherList);\n                setIsLoading({\n                  type: 'FETCH_SCHEDULE_TEACHER',\n                  status: false\n                });\n              }\n\n            case 15:\n              _context2.next = 21;\n              break;\n\n            case 17:\n              _context2.prev = 17;\n              _context2.t0 = _context2[\"catch\"](0);\n              showNoti('danger', _context2.t0.message);\n              console.log('fetchConfigAccount', _context2.t0.message);\n\n            case 21:\n              _context2.prev = 21;\n              setIsLoading({\n                type: 'FETCH_SCHEDULE_TEACHER',\n                status: false\n              });\n              return _context2.finish(21);\n\n            case 24:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 17, 21, 24]]);\n    }));\n\n    return function onHandleZoom(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(); // CALENDAR FORMAT\n\n\n  var calendarFm = function calendarFm(calendarArr) {\n    var rs = calendarArr.map(function (c, idx) {\n      var ID = c.ID,\n          Title = c.Title,\n          CourseID = c.CourseID,\n          BranchName = c.BranchName,\n          RoomName = c.RoomName,\n          SubjectName = c.SubjectName,\n          StartTime = c.StartTime,\n          EndTime = c.EndTime,\n          ButtonID = c.ButtonID,\n          ButtonName = c.ButtonName,\n          IsExam = c.IsExam,\n          TeacherAttendanceID = c.TeacherAttendanceID;\n      var studyTimeStart = moment(StartTime).format('HH:mm');\n      var studyTimeEnd = moment(EndTime).format('HH:mm');\n      var studyTime = \"\".concat(studyTimeStart, \" - \").concat(studyTimeEnd);\n      return {\n        id: +ID,\n        title: '',\n        start: moment(StartTime).toDate(),\n        end: moment(EndTime).toDate(),\n        resource: {\n          ID: ID,\n          CourseID: CourseID,\n          CourseName: Title,\n          RoomName: RoomName,\n          BranchName: BranchName,\n          SubjectName: SubjectName,\n          //\n          StudyTimeName: studyTime,\n          //\n          ButtonID: ButtonID,\n          ButtonName: ButtonName,\n          idx: idx,\n          IsExam: IsExam,\n          TeacherAttendanceID: TeacherAttendanceID\n        }\n      };\n    });\n    return rs;\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"row\",\n    children: [/*#__PURE__*/_jsxDEV(TitlePage, {\n      title: \"L\\u1ECBch d\\u1EA1y gi\\xE1o vi\\xEAn\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 4\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-12 hide-rbc-event\",\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        children: /*#__PURE__*/_jsxDEV(CDCalendar, {\n          isLoaded: isLoading.type === 'FETCH_SCHEDULE_TEACHER' && isLoading.status ? false : true,\n          eventList: calendarFm(scheduleTeacherList),\n          isStudyZoom: true,\n          fetchStudyZoom: debounceFetchScheduleList,\n          handleStudyZoom: onHandleZoom\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 6\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 5\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 4\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 179,\n    columnNumber: 3\n  }, _this);\n};\n\n_s(ScheduleStudyTeacher, \"inWlBbpFV58uVub/kFvGCXY9TR4=\", false, function () {\n  return [useWrap, useDebounce];\n});\n\n_c = ScheduleStudyTeacher;\nexport default ScheduleStudyTeacher;\n\nvar _c;\n\n$RefreshReg$(_c, \"ScheduleStudyTeacher\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/ScheduleStudyTeacher/ScheduleStudyTeacher.tsx"],"names":["Card","moment","React","useEffect","useState","scheduleZoomApi","zoomRoomApi","TitlePage","useDebounce","useWrap","CDCalendar","ScheduleStudyTeacher","showNoti","type","status","isLoading","setIsLoading","scheduleTeacherList","setScheduleTeacherList","StartTime","startOf","format","EndTime","endOf","filters","setFilters","fetchScheduleStudyTeacher","getAll","res","data","message","fetchNewScheduleList","date","fmDate","start","end","Array","isArray","length","debounceFetchScheduleList","onHandleZoom","idx","btnID","btnName","scheduleID","createRoom","newScheduleTeacherList","newScheduleTeacher","ButtonName","ButtonID","splice","window","open","closeRoom","console","log","calendarFm","calendarArr","rs","map","c","ID","Title","CourseID","BranchName","RoomName","SubjectName","IsExam","TeacherAttendanceID","studyTimeStart","studyTimeEnd","studyTime","id","title","toDate","resource","CourseName","StudyTimeName"],"mappings":"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","sourcesContent":["import { Card } from 'antd';\r\nimport moment from 'moment';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { scheduleZoomApi, zoomRoomApi } from '~/apiBase';\r\nimport TitlePage from '~/components/TitlePage';\r\nimport { useDebounce } from '~/context/useDebounce';\r\nimport { useWrap } from '~/context/wrap';\r\nimport CDCalendar from '../CourseList/CourseListDetail/CourseDetailCalendar/Calendar';\r\n\r\nconst ScheduleStudyTeacher = () => {\r\n\tconst { showNoti } = useWrap();\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: '',\r\n\t\tstatus: false\r\n\t});\r\n\tconst [scheduleTeacherList, setScheduleTeacherList] = useState<IScheduleZoom[]>([]);\r\n\tconst [filters, setFilters] = useState({\r\n\t\tStartTime: moment().startOf('month').format('YYYY/MM/DD'),\r\n\t\tEndTime: moment().endOf('month').format('YYYY/MM/DD')\r\n\t});\r\n\r\n\tconst fetchScheduleStudyTeacher = async () => {\r\n\t\ttry {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'FETCH_SCHEDULE_TEACHER',\r\n\t\t\t\tstatus: true\r\n\t\t\t});\r\n\t\t\tconst res = await scheduleZoomApi.getAll(filters);\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tsetScheduleTeacherList(res.data.data);\r\n\t\t\t}\r\n\t\t\tif (res.status === 204) {\r\n\t\t\t\tshowNoti('danger', 'Lịch dạy trống');\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'FETCH_SCHEDULE_TEACHER',\r\n\t\t\t\tstatus: false\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tfetchScheduleStudyTeacher();\r\n\t}, [filters]);\r\n\r\n\tconst fetchNewScheduleList = (date) => {\r\n\t\tlet fmDate;\r\n\t\tif (date?.start && date?.end) {\r\n\t\t\tfmDate = {\r\n\t\t\t\tStartTime: moment(date.start).format('YYYY/MM/DD'),\r\n\t\t\t\tEndTime: moment(date.end).format('YYYY/MM/DD')\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (Array.isArray(date) && date.length >= 1) {\r\n\t\t\tfmDate = {\r\n\t\t\t\tStartTime: moment(date[0]).format('YYYY/MM/DD'),\r\n\t\t\t\tEndTime: moment(date[date.length - 1]).format('YYYY/MM/DD')\r\n\t\t\t};\r\n\t\t}\r\n\t\tsetFilters(fmDate || { ...filters });\r\n\t};\r\n\tconst debounceFetchScheduleList = useDebounce(fetchNewScheduleList, 200, []);\r\n\r\n\tconst onHandleZoom = async (data: { idx: number; btnID: number; btnName?: string; scheduleID: number }) => {\r\n\t\ttry {\r\n\t\t\t//0 - ,1-Bắt đầu , 2-Vào lớp học, 3-Kết thúc\r\n\t\t\tconst { idx, btnID, btnName, scheduleID } = data;\r\n\t\t\tif (btnID === 1) {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'FETCH_SCHEDULE_TEACHER',\r\n\t\t\t\t\tstatus: true\r\n\t\t\t\t});\r\n\t\t\t\tconst res = await zoomRoomApi.createRoom(scheduleID);\r\n\t\t\t\tif (res.status === 200) {\r\n\t\t\t\t\tconst newScheduleTeacherList = [...scheduleTeacherList];\r\n\t\t\t\t\tconst newScheduleTeacher: IScheduleZoom = {\r\n\t\t\t\t\t\t...newScheduleTeacherList[idx],\r\n\t\t\t\t\t\tButtonName: 'Vào lớp học',\r\n\t\t\t\t\t\tButtonID: 2\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnewScheduleTeacherList.splice(idx, 1, newScheduleTeacher);\r\n\t\t\t\t\tsetScheduleTeacherList(newScheduleTeacherList);\r\n\t\t\t\t\tsetIsLoading({\r\n\t\t\t\t\t\ttype: 'FETCH_SCHEDULE_TEACHER',\r\n\t\t\t\t\t\tstatus: false\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (scheduleID) {\r\n\t\t\t\t\t\twindow.open(`/course/zoom-view/${scheduleID}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (btnID === 2 && scheduleID) {\r\n\t\t\t\twindow.open(`/course/zoom-view/${scheduleID}`);\r\n\t\t\t}\r\n\t\t\tif (btnID === 3 && scheduleID) {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'FETCH_SCHEDULE_TEACHER',\r\n\t\t\t\t\tstatus: true\r\n\t\t\t\t});\r\n\t\t\t\tconst res = await zoomRoomApi.closeRoom(scheduleID);\r\n\t\t\t\tif (res.status === 200) {\r\n\t\t\t\t\tconst newScheduleTeacherList = [...scheduleTeacherList];\r\n\t\t\t\t\tconst newScheduleTeacher: IScheduleZoom = {\r\n\t\t\t\t\t\t...newScheduleTeacherList[idx],\r\n\t\t\t\t\t\tButtonName: 'Kết thúc',\r\n\t\t\t\t\t\tButtonID: 3\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnewScheduleTeacherList.splice(idx, 1, newScheduleTeacher);\r\n\t\t\t\t\tsetScheduleTeacherList(newScheduleTeacherList);\r\n\t\t\t\t\tsetIsLoading({\r\n\t\t\t\t\t\ttype: 'FETCH_SCHEDULE_TEACHER',\r\n\t\t\t\t\t\tstatus: false\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t\tconsole.log('fetchConfigAccount', error.message);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'FETCH_SCHEDULE_TEACHER',\r\n\t\t\t\tstatus: false\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t// CALENDAR FORMAT\r\n\tconst calendarFm = (calendarArr: IScheduleZoom[]) => {\r\n\t\tconst rs = calendarArr.map((c, idx) => {\r\n\t\t\tconst {\r\n\t\t\t\tID,\r\n\t\t\t\tTitle,\r\n\t\t\t\tCourseID,\r\n\t\t\t\tBranchName,\r\n\t\t\t\tRoomName,\r\n\t\t\t\tSubjectName,\r\n\t\t\t\tStartTime,\r\n\t\t\t\tEndTime,\r\n\t\t\t\t//\r\n\t\t\t\tButtonID,\r\n\t\t\t\tButtonName,\r\n\t\t\t\tIsExam,\r\n\t\t\t\tTeacherAttendanceID\r\n\t\t\t} = c;\r\n\t\t\tconst studyTimeStart = moment(StartTime).format('HH:mm');\r\n\t\t\tconst studyTimeEnd = moment(EndTime).format('HH:mm');\r\n\t\t\tconst studyTime = `${studyTimeStart} - ${studyTimeEnd}`;\r\n\r\n\t\t\treturn {\r\n\t\t\t\tid: +ID,\r\n\t\t\t\ttitle: '',\r\n\t\t\t\tstart: moment(StartTime).toDate(),\r\n\t\t\t\tend: moment(EndTime).toDate(),\r\n\t\t\t\tresource: {\r\n\t\t\t\t\tID,\r\n\t\t\t\t\tCourseID,\r\n\t\t\t\t\tCourseName: Title,\r\n\t\t\t\t\tRoomName,\r\n\t\t\t\t\tBranchName,\r\n\t\t\t\t\tSubjectName,\r\n\t\t\t\t\t//\r\n\t\t\t\t\tStudyTimeName: studyTime,\r\n\t\t\t\t\t//\r\n\t\t\t\t\tButtonID,\r\n\t\t\t\t\tButtonName,\r\n\t\t\t\t\tidx,\r\n\t\t\t\t\tIsExam,\r\n\t\t\t\t\tTeacherAttendanceID\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t\treturn rs;\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"row\">\r\n\t\t\t<TitlePage title=\"Lịch dạy giáo viên\" />\r\n\t\t\t<div className=\"col-12 hide-rbc-event\">\r\n\t\t\t\t<Card>\r\n\t\t\t\t\t<CDCalendar\r\n\t\t\t\t\t\tisLoaded={isLoading.type === 'FETCH_SCHEDULE_TEACHER' && isLoading.status ? false : true}\r\n\t\t\t\t\t\teventList={calendarFm(scheduleTeacherList)}\r\n\t\t\t\t\t\tisStudyZoom={true}\r\n\t\t\t\t\t\tfetchStudyZoom={debounceFetchScheduleList}\r\n\t\t\t\t\t\thandleStudyZoom={onHandleZoom}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Card>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\nexport default ScheduleStudyTeacher;\r\n"]},"metadata":{},"sourceType":"module"}