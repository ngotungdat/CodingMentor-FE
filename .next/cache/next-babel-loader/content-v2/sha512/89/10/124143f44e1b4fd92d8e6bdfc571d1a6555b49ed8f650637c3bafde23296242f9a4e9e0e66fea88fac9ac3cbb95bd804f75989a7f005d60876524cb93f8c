{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\RegisterForm\\\\index.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport styles from './RegisterForm.module.scss';\nimport { useRouter } from 'next/router';\nimport { Toaster } from 'react-hot-toast';\nimport { Form, Spin } from 'antd';\nimport { userApi } from '~/apiBase';\nimport { useWrap } from '~/context/wrap';\nimport { CheckCircleOutlined } from '@ant-design/icons';\nimport { signIn } from 'next-auth/client';\nvar roles;\n\n(function (roles) {\n  roles[\"user\"] = \"user\";\n  roles[\"admin\"] = \"admin\";\n  roles[\"moderator\"] = \"moderator\";\n})(roles || (roles = {}));\n\nfunction RegisterForm(props) {\n  const router = useRouter();\n  const {\n    0: count,\n    1: setCount\n  } = useState(3);\n  const {\n    register,\n    handleSubmit,\n    watch,\n    formState: {\n      errors\n    },\n    reset\n  } = useForm();\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: isSuccess,\n    1: setIsSuccess\n  } = useState(false);\n  const {\n    showNoti\n  } = useWrap();\n  let timerID;\n\n  const _Submit = async data => {\n    setLoading(true);\n\n    try {\n      let res = await userApi.createAccount(data);\n\n      if (res.status === 200) {\n        setIsSuccess(true);\n\n        if (count <= 0) {\n          clearInterval(timerID);\n        }\n\n        timerID = setInterval(() => {\n          setCount(count - 1);\n        }, 1000);\n        const dataLogin = {\n          username: data.Email,\n          password: '123456'\n        };\n        handleLogin(dataLogin);\n        localStorage.setItem('isNewUser', 'true');\n      } else {\n        showNoti('danger', 'Đường truyền mạng đang không ổn định');\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    }\n  };\n\n  const handleLogin = data => {\n    var _router$query$callbac, _router$query;\n\n    signIn('credentials-signin', _objectSpread(_objectSpread({}, data), {}, {\n      callbackUrl: (_router$query$callbac = (_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.callbackUrl) !== null && _router$query$callbac !== void 0 ? _router$query$callbac : '/'\n    }));\n  };\n\n  const moveToSignIn = e => {\n    e.preventDefault();\n    router.push('/auth/signin');\n  };\n\n  useEffect(() => {\n    return () => {};\n  }, []);\n  /* \"handleSubmit\" will validate your inputs before invoking \"onSubmit\" */\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Toaster, {\n      position: \"top-center\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.container,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.wrapBox,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.wrapForm,\n          children: /*#__PURE__*/_jsxDEV(Form, {\n            onFinish: handleSubmit(_Submit),\n            layout: \"vertical\",\n            className: `${styles.loginForm}`,\n            children: [!isSuccess && /*#__PURE__*/_jsxDEV(\"h6\", {\n              className: styles.title,\n              children: \"\\u0110\\u0103ng k\\xFD\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 23\n            }, this), !isSuccess ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n                label: \" H\\u1ECD v\\xE0 t\\xEAn\",\n                name: \"FullNameUnicode\",\n                rules: [{\n                  required: true,\n                  message: 'Hãy điền tên đăng nhập!'\n                }],\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-control-input\",\n                  children: /*#__PURE__*/_jsxDEV(\"input\", _objectSpread({\n                    name: \"FullNameUnicode\",\n                    placeholder: \"Nh\\u1EADp h\\u1ECD v\\xE0 t\\xEAn\",\n                    defaultValue: \"\"\n                  }, register('FullNameUnicode', {\n                    required: true\n                  })), void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 113,\n                    columnNumber: 12\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 112,\n                  columnNumber: 11\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 107,\n                columnNumber: 10\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n                label: \" Email\",\n                name: \"Email\",\n                rules: [{\n                  required: true,\n                  message: 'Hãy điền email!'\n                }, {\n                  required: true,\n                  type: 'email',\n                  message: 'Hãy điền đúng định dạng email!'\n                }],\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-control-input\",\n                  children: /*#__PURE__*/_jsxDEV(\"input\", _objectSpread({\n                    name: \"Email\",\n                    placeholder: \"Nh\\u1EADp Email\",\n                    defaultValue: \"\"\n                  }, register('Email', {\n                    required: true\n                  })), void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 132,\n                    columnNumber: 12\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 130,\n                  columnNumber: 11\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 10\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n                label: \" S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\",\n                name: \"Mobile\",\n                rules: [{\n                  required: true,\n                  message: 'Hãy điền số điện thoại!'\n                }],\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-control-input\",\n                  children: /*#__PURE__*/_jsxDEV(\"input\", _objectSpread(_objectSpread({\n                    type: \"number\",\n                    name: \"Mobile\",\n                    defaultValue: \"\"\n                  }, register('Mobile', {\n                    required: true\n                  })), {}, {\n                    placeholder: \"Nh\\u1EADp s\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"\n                  }), void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 149,\n                    columnNumber: 12\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 147,\n                  columnNumber: 11\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 10\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n                label: \" Ghi ch\\xFA\",\n                name: \"Note\",\n                rules: [{\n                  required: false,\n                  message: 'Hãy điền số điện thoại!'\n                }],\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-control-input\",\n                  children: /*#__PURE__*/_jsxDEV(\"input\", _objectSpread(_objectSpread({\n                    name: \"Note\",\n                    defaultValue: \"\"\n                  }, register('Note', {\n                    required: false\n                  })), {}, {\n                    placeholder: \"Ghi ch\\xFA\"\n                  }), void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 167,\n                    columnNumber: 12\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 165,\n                  columnNumber: 11\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 10\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.boxSubmit,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"submit\",\n                  value: 'Đăng ký'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 178,\n                  columnNumber: 11\n                }, this), loading && /*#__PURE__*/_jsxDEV(Spin, {\n                  className: \"loading-login\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 179,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 10\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.boxSignup,\n                children: [\"B\\u1EA1n \\u0111\\xE3 c\\xF3 t\\xE0i kho\\u1EA3n?\", ' ', /*#__PURE__*/_jsxDEV(\"a\", {\n                  href: \"\",\n                  onClick: moveToSignIn,\n                  children: \"\\u0110\\u0103ng nh\\u1EADp\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 183,\n                  columnNumber: 11\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 181,\n                columnNumber: 10\n              }, this)]\n            }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"success-reset mt-3\",\n              children: [/*#__PURE__*/_jsxDEV(CheckCircleOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 10\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"success-text\",\n                children: \"T\\u1EA1o t\\xE0i kho\\u1EA3n th\\xE0nh c\\xF4ng! \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 191,\n                columnNumber: 10\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"move-text\",\n                children: [\"H\\u1EC7 th\\u1ED1ng s\\u1EBD t\\u1EF1 \\u0111\\u0103ng nh\\u1EADp sau \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-weight-primary\",\n                  children: [count, \"s\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 193,\n                  columnNumber: 40\n                }, this), \"..\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 10\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n}\n\nexport default RegisterForm;","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/RegisterForm/index.tsx"],"names":["React","useEffect","useState","useForm","styles","useRouter","Toaster","Form","Spin","userApi","useWrap","CheckCircleOutlined","signIn","roles","RegisterForm","props","router","count","setCount","register","handleSubmit","watch","formState","errors","reset","loading","setLoading","isSuccess","setIsSuccess","showNoti","timerID","_Submit","data","res","createAccount","status","clearInterval","setInterval","dataLogin","username","Email","password","handleLogin","localStorage","setItem","error","message","callbackUrl","query","moveToSignIn","e","preventDefault","push","container","wrapBox","wrapForm","loginForm","title","required","type","boxSubmit","boxSignup"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useForm } from 'react-hook-form';\r\nimport styles from './RegisterForm.module.scss';\r\nimport { useRouter } from 'next/router';\r\nimport toast, { Toaster } from 'react-hot-toast';\r\nimport { Form, Spin } from 'antd';\r\nimport { userApi } from '~/apiBase';\r\nimport { useWrap } from '~/context/wrap';\r\nimport { CheckCircleOutlined } from '@ant-design/icons';\r\nimport { signIn } from 'next-auth/client';\r\n\r\nenum roles {\r\n\tuser = 'user',\r\n\tadmin = 'admin',\r\n\tmoderator = 'moderator'\r\n}\r\ntype Inputs = {\r\n\ttext: string;\r\n\ttextRequired: string;\r\n};\r\ninterface RegisterInputs {\r\n\tFullNameUnicode: Inputs;\r\n\tEmail: Inputs;\r\n\tMobile: Inputs;\r\n\tNote: Inputs;\r\n}\r\n\r\ninterface dataNewAccount {\r\n\tFullNameUnicode: string;\r\n\tEmail: string;\r\n\tMobile: string;\r\n\tNote: string;\r\n}\r\n\r\nfunction RegisterForm(props) {\r\n\tconst router = useRouter();\r\n\tconst [count, setCount] = useState(3);\r\n\tconst {\r\n\t\tregister,\r\n\t\thandleSubmit,\r\n\t\twatch,\r\n\t\tformState: { errors },\r\n\t\treset\r\n\t} = useForm<RegisterInputs>();\r\n\r\n\tconst [loading, setLoading] = useState(false);\r\n\tconst [isSuccess, setIsSuccess] = useState(false);\r\n\tconst { showNoti } = useWrap();\r\n\r\n\tlet timerID;\r\n\r\n\tconst _Submit = async (data: any) => {\r\n\t\tsetLoading(true);\r\n\r\n\t\ttry {\r\n\t\t\tlet res = await userApi.createAccount(data);\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tsetIsSuccess(true);\r\n\t\t\t\tif (count <= 0) {\r\n\t\t\t\t\tclearInterval(timerID);\r\n\t\t\t\t}\r\n\t\t\t\ttimerID = setInterval(() => {\r\n\t\t\t\t\tsetCount(count - 1);\r\n\t\t\t\t}, 1000);\r\n\t\t\t\tconst dataLogin = {\r\n\t\t\t\t\tusername: data.Email,\r\n\t\t\t\t\tpassword: '123456'\r\n\t\t\t\t};\r\n\t\t\t\thandleLogin(dataLogin);\r\n\t\t\t\tlocalStorage.setItem('isNewUser', 'true');\r\n\t\t\t} else {\r\n\t\t\t\tshowNoti('danger', 'Đường truyền mạng đang không ổn định');\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleLogin = (data) => {\r\n\t\tsignIn('credentials-signin', {\r\n\t\t\t...data,\r\n\t\t\tcallbackUrl: router.query?.callbackUrl ?? '/'\r\n\t\t});\r\n\t};\r\n\r\n\tconst moveToSignIn = (e) => {\r\n\t\te.preventDefault();\r\n\t\trouter.push('/auth/signin');\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => {};\r\n\t}, []);\r\n\r\n\t/* \"handleSubmit\" will validate your inputs before invoking \"onSubmit\" */\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Toaster position=\"top-center\" />\r\n\t\t\t<div className={styles.container}>\r\n\t\t\t\t<div className={styles.wrapBox}>\r\n\t\t\t\t\t<div className={styles.wrapForm}>\r\n\t\t\t\t\t\t<Form onFinish={handleSubmit(_Submit)} layout=\"vertical\" className={`${styles.loginForm}`}>\r\n\t\t\t\t\t\t\t{!isSuccess && <h6 className={styles.title}>Đăng ký</h6>}\r\n\t\t\t\t\t\t\t{!isSuccess ? (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<Form.Item\r\n\t\t\t\t\t\t\t\t\t\tlabel=\" Họ và tên\"\r\n\t\t\t\t\t\t\t\t\t\tname=\"FullNameUnicode\"\r\n\t\t\t\t\t\t\t\t\t\trules={[{ required: true, message: 'Hãy điền tên đăng nhập!' }]}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"form-control-input\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\tname=\"FullNameUnicode\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Nhập họ và tên\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultValue=\"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t{...register('FullNameUnicode', { required: true })}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Form.Item>\r\n\r\n\t\t\t\t\t\t\t\t\t<Form.Item\r\n\t\t\t\t\t\t\t\t\t\tlabel=\" Email\"\r\n\t\t\t\t\t\t\t\t\t\tname=\"Email\"\r\n\t\t\t\t\t\t\t\t\t\trules={[\r\n\t\t\t\t\t\t\t\t\t\t\t{ required: true, message: 'Hãy điền email!' },\r\n\t\t\t\t\t\t\t\t\t\t\t{ required: true, type: 'email', message: 'Hãy điền đúng định dạng email!' }\r\n\t\t\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"form-control-input\">\r\n\t\t\t\t\t\t\t\t\t\t\t{/* <label className={styles.fcontrol}>Email</label> */}\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\tname=\"Email\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Nhập Email\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultValue=\"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t{...register('Email', { required: true })}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t{/* {errors.Email && <span className={styles.errorText}>Hãy điền email</span>} */}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Form.Item>\r\n\r\n\t\t\t\t\t\t\t\t\t<Form.Item\r\n\t\t\t\t\t\t\t\t\t\tlabel=\" Số điện thoại\"\r\n\t\t\t\t\t\t\t\t\t\tname=\"Mobile\"\r\n\t\t\t\t\t\t\t\t\t\trules={[{ required: true, message: 'Hãy điền số điện thoại!' }]}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"form-control-input\">\r\n\t\t\t\t\t\t\t\t\t\t\t{/* <label className={styles.fcontrol}>Số điện thoại</label> */}\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tname=\"Mobile\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultValue=\"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t{...register('Mobile', { required: true })}\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Nhập số điện thoại\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t{/* {errors.Mobile && <span className={styles.errorText}>Hãy điền số điện thoại</span>} */}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Form.Item>\r\n\r\n\t\t\t\t\t\t\t\t\t<Form.Item\r\n\t\t\t\t\t\t\t\t\t\tlabel=\" Ghi chú\"\r\n\t\t\t\t\t\t\t\t\t\tname=\"Note\"\r\n\t\t\t\t\t\t\t\t\t\trules={[{ required: false, message: 'Hãy điền số điện thoại!' }]}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"form-control-input\">\r\n\t\t\t\t\t\t\t\t\t\t\t{/* <label className={styles.fcontrol}>Số điện thoại</label> */}\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\tname=\"Note\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultValue=\"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t{...register('Note', { required: false })}\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Ghi chú\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t{/* {errors.Mobile && <span className={styles.errorText}>Hãy điền số điện thoại</span>} */}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Form.Item>\r\n\r\n\t\t\t\t\t\t\t\t\t<div className={styles.boxSubmit}>\r\n\t\t\t\t\t\t\t\t\t\t<input type=\"submit\" value={'Đăng ký'} />\r\n\t\t\t\t\t\t\t\t\t\t{loading && <Spin className=\"loading-login\" />}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className={styles.boxSignup}>\r\n\t\t\t\t\t\t\t\t\t\tBạn đã có tài khoản?{' '}\r\n\t\t\t\t\t\t\t\t\t\t<a href=\"\" onClick={moveToSignIn}>\r\n\t\t\t\t\t\t\t\t\t\t\tĐăng nhập\r\n\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<div className=\"success-reset mt-3\">\r\n\t\t\t\t\t\t\t\t\t<CheckCircleOutlined />\r\n\t\t\t\t\t\t\t\t\t<p className=\"success-text\">Tạo tài khoản thành công! </p>\r\n\t\t\t\t\t\t\t\t\t<p className=\"move-text\">\r\n\t\t\t\t\t\t\t\t\t\tHệ thống sẽ tự đăng nhập sau <span className=\"font-weight-primary\">{count}s</span>..\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default RegisterForm;\r\n"]},"metadata":{},"sourceType":"module"}