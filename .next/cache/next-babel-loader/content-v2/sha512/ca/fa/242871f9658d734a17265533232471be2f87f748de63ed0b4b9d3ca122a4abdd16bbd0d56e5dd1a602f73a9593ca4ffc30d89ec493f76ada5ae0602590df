{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\ManageZoom\\\\ZoomView\\\\ZoomView.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Spin } from 'antd';\nimport { signIn, useSession } from 'next-auth/client';\nimport Head from 'next/head';\nimport { useRouter } from 'next/router';\nimport React, { useEffect, useState } from 'react';\nimport { scheduleZoomApi } from '~/apiBase';\nimport { useWrap } from '~/context/wrap';\n\nfunction ZoomView() {\n  const router = useRouter();\n  const {\n    slug: ScheduleID\n  } = router.query;\n  const [session, loading] = useSession();\n  let path = router.pathname;\n  const {\n    0: dataZoom,\n    1: setDataZoom\n  } = useState(null);\n  const {\n    userInformation\n  } = useWrap();\n  console.log('======= =======');\n  console.log('ScheduleID: ', ScheduleID);\n\n  const fetchInfoRoomZoom = async () => {\n    try {\n      if (!userInformation) return;\n      const parseID = parseInt(ScheduleID.toString());\n      const res = await scheduleZoomApi.getById(parseID);\n\n      if (res.status === 200) {\n        const {\n          ZoomRoomID,\n          ZoomRoomPass,\n          SignatureTeacher,\n          SignatureStudent,\n          ApiKey\n        } = res.data.data;\n        setDataZoom({\n          apiKey: ApiKey,\n          signature: SignatureTeacher && SignatureStudent ? (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) === 2 ? SignatureTeacher : SignatureStudent : '',\n          meetingNumber: ZoomRoomID,\n          passWord: ZoomRoomPass,\n          userName: userInformation.FullNameUnicode\n        });\n      }\n    } catch (error) {\n      console.log('fetchInfoRoomZoom', error.message);\n    }\n  };\n\n  useEffect(() => {\n    fetchInfoRoomZoom();\n  }, [userInformation]);\n  useEffect(() => {\n    if (typeof session !== 'undefined') {\n      if (session == null) {\n        if (path.search('signin') < 0) {\n          signIn();\n        }\n      }\n    }\n  }, [session]);\n\n  const initZoom = async () => {\n    var _document$getElementB;\n\n    if (!dataZoom) return;\n    const module = await import('@zoomus/websdk'); // DECLARE MODULE\n\n    const {\n      ZoomMtg\n    } = module;\n    ZoomMtg.setZoomJSLib('https://source.zoom.us/2.1.1/lib', '/av');\n    ZoomMtg.preLoadWasm();\n    ZoomMtg.prepareWebSDK(); // SHOW LAYOUT ZOOM\n\n    (_document$getElementB = document.getElementById('zmmtg-root')) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.setAttribute('style', 'display:block;');\n    let leaveUrl = 'http://localhost:3000/';\n\n    if (false) {\n      leaveUrl = window.location.origin;\n    } // INIT MEETING\n\n\n    ZoomMtg.init({\n      leaveUrl,\n      isSupportAV: true,\n      success: success => {\n        // JOIN MEETING\n        console.log('ZoomMtg.init', success);\n        ZoomMtg.join(_objectSpread(_objectSpread({}, dataZoom), {}, {\n          success: success => {\n            console.log('ZoomMtg.join', success);\n          },\n          error: error => {\n            console.log('ZoomMtg.join', error);\n          }\n        })); // ZoomMtg.inMeetingServiceListener('onUserJoin', function (data) {\n        // \tconsole.log('onUserJoin', data);\n        // });\n        // ZoomMtg.inMeetingServiceListener('onUserLeave', function (data) {\n        // \tconsole.log('onUserLeave', data);\n        // });\n        // ZoomMtg.inMeetingServiceListener(\n        // \t'onUserIsInWaitingRoom',\n        // \tfunction (data) {\n        // \t\tconsole.log('onUserIsInWaitingRoom', data);\n        // \t}\n        // );\n        // ZoomMtg.endMeeting({\n        // \tsuccess: (success) => {\n        // \t\tconsole.log('endMeeting', success);\n        // \t},\n        // \terror: (error) => {\n        // \t\tconsole.log(error);\n        // \t},\n        // });\n        // ZoomMtg.leaveMeeting({\n        // \tsuccess: (success) => {\n        // \t\tconsole.log('leaveMeeting', success);\n        // \t},\n        // \terror: (error) => {\n        // \t\tconsole.log(error);\n        // \t},\n        // });\n      },\n      error: error => {\n        console.log('ZoomMtg.init', error);\n      }\n    });\n  };\n\n  useEffect(() => {\n    initZoom();\n  }, [dataZoom]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"link\", {\n        type: \"text/css\",\n        rel: \"stylesheet\",\n        href: \"https://source.zoom.us/2.1.1/css/bootstrap.css\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"link\", {\n        type: \"text/css\",\n        rel: \"stylesheet\",\n        href: \"https://source.zoom.us/2.1.1/css/react-select.css\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"zoom-view\",\n      style: {\n        height: '100vh',\n        width: '100vw',\n        position: 'relative'\n      },\n      children: /*#__PURE__*/_jsxDEV(Spin, {\n        size: \"large\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n}\n\nexport default ZoomView;","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/ManageZoom/ZoomView/ZoomView.tsx"],"names":["Spin","signIn","useSession","Head","useRouter","React","useEffect","useState","scheduleZoomApi","useWrap","ZoomView","router","slug","ScheduleID","query","session","loading","path","pathname","dataZoom","setDataZoom","userInformation","console","log","fetchInfoRoomZoom","parseID","parseInt","toString","res","getById","status","ZoomRoomID","ZoomRoomPass","SignatureTeacher","SignatureStudent","ApiKey","data","apiKey","signature","RoleID","meetingNumber","passWord","userName","FullNameUnicode","error","message","search","initZoom","module","ZoomMtg","setZoomJSLib","preLoadWasm","prepareWebSDK","document","getElementById","setAttribute","leaveUrl","window","location","origin","init","isSupportAV","success","join","height","width","position"],"mappings":"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","sourcesContent":["import { Spin } from 'antd'\r\nimport { signIn, useSession } from 'next-auth/client'\r\nimport Head from 'next/head'\r\nimport { useRouter } from 'next/router'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { scheduleZoomApi } from '~/apiBase'\r\nimport { useWrap } from '~/context/wrap'\r\n\r\nfunction ZoomView() {\r\n\tconst router = useRouter()\r\n\tconst { slug: ScheduleID } = router.query\r\n\tconst [session, loading] = useSession()\r\n\tlet path: string = router.pathname\r\n\r\n\tconst [dataZoom, setDataZoom] = useState<{\r\n\t\tapiKey: string\r\n\t\tsignature: string\r\n\t\tmeetingNumber: string\r\n\t\tpassWord: string\r\n\t\tuserName: string\r\n\t}>(null)\r\n\r\n\tconst { userInformation } = useWrap()\r\n\tconsole.log('======= =======')\r\n\tconsole.log('ScheduleID: ', ScheduleID)\r\n\r\n\tconst fetchInfoRoomZoom = async () => {\r\n\t\ttry {\r\n\t\t\tif (!userInformation) return\r\n\t\t\tconst parseID = parseInt(ScheduleID.toString())\r\n\t\t\tconst res = await scheduleZoomApi.getById(parseID)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tconst { ZoomRoomID, ZoomRoomPass, SignatureTeacher, SignatureStudent, ApiKey } = res.data.data\r\n\t\t\t\tsetDataZoom({\r\n\t\t\t\t\tapiKey: ApiKey,\r\n\t\t\t\t\tsignature: SignatureTeacher && SignatureStudent ? (userInformation?.RoleID === 2 ? SignatureTeacher : SignatureStudent) : '',\r\n\t\t\t\t\tmeetingNumber: ZoomRoomID,\r\n\t\t\t\t\tpassWord: ZoomRoomPass,\r\n\t\t\t\t\tuserName: userInformation.FullNameUnicode\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('fetchInfoRoomZoom', error.message)\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tfetchInfoRoomZoom()\r\n\t}, [userInformation])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (typeof session !== 'undefined') {\r\n\t\t\tif (session == null) {\r\n\t\t\t\tif (path.search('signin') < 0) {\r\n\t\t\t\t\tsignIn()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}, [session])\r\n\r\n\tconst initZoom = async () => {\r\n\t\tif (!dataZoom) return\r\n\t\tconst module = await import('@zoomus/websdk')\r\n\t\t// DECLARE MODULE\r\n\t\tconst { ZoomMtg } = module\r\n\t\tZoomMtg.setZoomJSLib('https://source.zoom.us/2.1.1/lib', '/av')\r\n\t\tZoomMtg.preLoadWasm()\r\n\t\tZoomMtg.prepareWebSDK()\r\n\r\n\t\t// SHOW LAYOUT ZOOM\r\n\t\tdocument.getElementById('zmmtg-root')?.setAttribute('style', 'display:block;')\r\n\t\tlet leaveUrl = 'http://localhost:3000/'\r\n\t\tif (typeof window !== 'undefined') {\r\n\t\t\tleaveUrl = window.location.origin\r\n\t\t}\r\n\t\t// INIT MEETING\r\n\t\tZoomMtg.init({\r\n\t\t\tleaveUrl,\r\n\t\t\tisSupportAV: true,\r\n\t\t\tsuccess: (success) => {\r\n\t\t\t\t// JOIN MEETING\r\n\t\t\t\tconsole.log('ZoomMtg.init', success)\r\n\t\t\t\tZoomMtg.join({\r\n\t\t\t\t\t...dataZoom,\r\n\t\t\t\t\tsuccess: (success) => {\r\n\t\t\t\t\t\tconsole.log('ZoomMtg.join', success)\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: (error) => {\r\n\t\t\t\t\t\tconsole.log('ZoomMtg.join', error)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// ZoomMtg.inMeetingServiceListener('onUserJoin', function (data) {\r\n\t\t\t\t// \tconsole.log('onUserJoin', data);\r\n\t\t\t\t// });\r\n\t\t\t\t// ZoomMtg.inMeetingServiceListener('onUserLeave', function (data) {\r\n\t\t\t\t// \tconsole.log('onUserLeave', data);\r\n\t\t\t\t// });\r\n\t\t\t\t// ZoomMtg.inMeetingServiceListener(\r\n\t\t\t\t// \t'onUserIsInWaitingRoom',\r\n\t\t\t\t// \tfunction (data) {\r\n\t\t\t\t// \t\tconsole.log('onUserIsInWaitingRoom', data);\r\n\t\t\t\t// \t}\r\n\t\t\t\t// );\r\n\t\t\t\t// ZoomMtg.endMeeting({\r\n\t\t\t\t// \tsuccess: (success) => {\r\n\t\t\t\t// \t\tconsole.log('endMeeting', success);\r\n\t\t\t\t// \t},\r\n\t\t\t\t// \terror: (error) => {\r\n\t\t\t\t// \t\tconsole.log(error);\r\n\t\t\t\t// \t},\r\n\t\t\t\t// });\r\n\t\t\t\t// ZoomMtg.leaveMeeting({\r\n\t\t\t\t// \tsuccess: (success) => {\r\n\t\t\t\t// \t\tconsole.log('leaveMeeting', success);\r\n\t\t\t\t// \t},\r\n\t\t\t\t// \terror: (error) => {\r\n\t\t\t\t// \t\tconsole.log(error);\r\n\t\t\t\t// \t},\r\n\t\t\t\t// });\r\n\t\t\t},\r\n\t\t\terror: (error) => {\r\n\t\t\t\tconsole.log('ZoomMtg.init', error)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tinitZoom()\r\n\t}, [dataZoom])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Head>\r\n\t\t\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"https://source.zoom.us/2.1.1/css/bootstrap.css\" />\r\n\t\t\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"https://source.zoom.us/2.1.1/css/react-select.css\" />\r\n\t\t\t</Head>\r\n\t\t\t<div className=\"zoom-view\" style={{ height: '100vh', width: '100vw', position: 'relative' }}>\r\n\t\t\t\t<Spin size=\"large\" />\r\n\t\t\t</div>\r\n\t\t</>\r\n\t)\r\n}\r\nexport default ZoomView\r\n"]},"metadata":{},"sourceType":"module"}