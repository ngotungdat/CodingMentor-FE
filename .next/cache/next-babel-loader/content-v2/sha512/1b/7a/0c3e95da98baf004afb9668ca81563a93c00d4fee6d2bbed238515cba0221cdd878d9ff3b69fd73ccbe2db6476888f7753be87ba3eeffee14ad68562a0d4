{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\ChangePassword\\\\index.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { Form, Card, Divider, Spin } from 'antd';\nimport { useForm } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as yup from 'yup';\nimport { useWrap } from '~/context/wrap';\nimport { userApi } from '~/apiBase';\nimport TitlePage from '~/components/Elements/TitlePage';\nimport InputPassField from '~/components/FormControl/InputPassField';\nimport ProfileSummary from '~/components/ProfileSummary.tsx/ProfileSummary';\nimport { signOut } from 'next-auth/client';\nvar returnSchema = {};\nvar schema = null;\n\nvar ChangePassword = function ChangePassword(props) {\n  _s();\n\n  var _useForm = useForm(),\n      register = _useForm.register,\n      handleSubmit = _useForm.handleSubmit,\n      setValue = _useForm.setValue,\n      _useForm$formState = _useForm.formState,\n      isSubmitting = _useForm$formState.isSubmitting,\n      errors = _useForm$formState.errors,\n      isSubmitted = _useForm$formState.isSubmitted;\n\n  var _useWrap = useWrap(),\n      showNoti = _useWrap.showNoti,\n      getDataUser = _useWrap.getDataUser,\n      userInformation = _useWrap.userInformation;\n\n  var _useState = useState({\n    type: '',\n    status: false\n  }),\n      isLoading = _useState[0],\n      setIsLoading = _useState[1];\n\n  var router = useRouter();\n  var dataUser = props.dataUser;\n\n  var _useState2 = useState(null),\n      dataForm = _useState2[0],\n      setDataForm = _useState2[1];\n\n  var _useState3 = useState(false),\n      isNewUser = _useState3[0],\n      setIsNewUser = _useState3[1];\n\n  var defaultValuesInit = {\n    KeyForgotPassword: '',\n    Password: '',\n    RePassword: ''\n  };\n\n  (function returnSchemaFunc() {\n    returnSchema = _objectSpread({}, defaultValuesInit);\n    Object.keys(returnSchema).forEach(function (key) {\n      switch (key) {\n        case 'KeyForgotPassword':\n          returnSchema[key] = yup.string().required('Bạn không được bỏ trống');\n          break;\n\n        case 'Password':\n          returnSchema[key] = yup.string().required('Bạn không được bỏ trống');\n          break;\n\n        case 'RePassword':\n          returnSchema[key] = yup.string().oneOf([yup.ref('Password'), null], 'Password mới xác nhận lại chưa đúng').required('Bạn không được bỏ trống');\n          break;\n\n        default:\n          break;\n      }\n    });\n    schema = yup.object().shape(returnSchema);\n  })();\n\n  var form = useForm({\n    defaultValues: defaultValuesInit,\n    resolver: yupResolver(schema)\n  }); // ----------- SUBMI FORM ------------\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n      var res, _res;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: true\n              });\n              res = null;\n              _context.prev = 2;\n              _context.next = 5;\n              return userApi.changePassword(data);\n\n            case 5:\n              res = _context.sent;\n              ((_res = res) === null || _res === void 0 ? void 0 : _res.status) == 200 && (showNoti('success', 'Đổi mật khẩu thành công'), form.reset(defaultValuesInit));\n              localStorage.setItem('isNewUser', 'false');\n              setTimeout(function () {\n                signOut();\n              }, 1000);\n              _context.next = 14;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](2);\n              showNoti('danger', _context.t0.message);\n\n            case 14:\n              _context.prev = 14;\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: false\n              });\n              return _context.finish(14);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 11, 14, 17]]);\n    }));\n\n    return function onSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    var checkNewUser = localStorage.getItem('isNewUser');\n\n    if (checkNewUser === 'true') {\n      setIsNewUser(true);\n      form.setValue('KeyForgotPassword', '123456');\n    }\n\n    setIsLoading({\n      type: 'FETCH_DATA',\n      status: true\n    });\n\n    if (dataUser) {\n      dataUser.Gender = parseInt(dataUser.Gender);\n      setTimeout(function () {\n        setIsLoading({\n          type: 'FETCH_DATA',\n          status: false\n        });\n      }, 500);\n\n      if (userInformation === null) {\n        setDataForm(dataUser);\n      } else {\n        setDataForm(userInformation);\n      }\n    }\n  }, [userInformation]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(TitlePage, {\n      title: \"\\u0110\\u1ED5i m\\u1EADt kh\\u1EA9u\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 4\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-4 col-12\",\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: \"info-profile-left\",\n          loading: isLoading.type === 'FETCH_DATA' && isLoading.status,\n          children: /*#__PURE__*/_jsxDEV(ProfileSummary, {\n            isFix: true,\n            dataForm: dataForm\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 7\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 6\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 5\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-7 col-12\",\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: \"space-top-card\",\n          children: /*#__PURE__*/_jsxDEV(Form, {\n            layout: \"vertical\",\n            onFinish: form.handleSubmit(onSubmit),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row d-flex justify-content-center align-items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                children: \"Form thay \\u0111\\u1ED5i m\\u1EADt kh\\u1EA9u\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 9\n              }, _this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 9\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 8\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  width: '100%',\n                  display: 'flex',\n                  flexDirection: 'column',\n                  alignItems: 'center'\n                },\n                children: [/*#__PURE__*/_jsxDEV(InputPassField, {\n                  disabled: isNewUser ? true : false,\n                  form: form,\n                  name: \"KeyForgotPassword\",\n                  label: \"M\\u1EADt kh\\u1EA9u c\\u0169\",\n                  style: {\n                    width: 500\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 142,\n                  columnNumber: 10\n                }, _this), /*#__PURE__*/_jsxDEV(InputPassField, {\n                  form: form,\n                  name: \"Password\",\n                  label: \"M\\u1EADt kh\\u1EA9u m\\u1EDBi\",\n                  style: {\n                    width: 500\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 10\n                }, _this), /*#__PURE__*/_jsxDEV(InputPassField, {\n                  form: form,\n                  name: \"RePassword\",\n                  label: \"X\\xE1c nh\\u1EADn m\\u1EADt kh\\u1EA9u m\\u1EDBi\",\n                  style: {\n                    width: 500\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 150,\n                  columnNumber: 10\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 9\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 8\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row mt-3\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-12 d-flex justify-content-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"submit\",\n                  className: \"btn btn-primary\",\n                  children: [\"L\\u01B0u\", isLoading.type == 'ADD_DATA' && isLoading.status && /*#__PURE__*/_jsxDEV(Spin, {\n                    className: \"loading-base\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 158,\n                    columnNumber: 64\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 10\n                }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"btn btn-warning ml-4\",\n                  onClick: function onClick() {\n                    localStorage.setItem('isNewUser', 'false');\n                    router.push('/');\n                  },\n                  children: [\"B\\u1ECF qua\", isLoading.type == 'ADD_DATA' && isLoading.status && /*#__PURE__*/_jsxDEV(Spin, {\n                    className: \"loading-base\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 169,\n                    columnNumber: 64\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 160,\n                  columnNumber: 10\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 9\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 8\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 7\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 6\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 5\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 4\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 4\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(ChangePassword, \"wuUFv5I1ia3K+iDNmuobESGSvJc=\", false, function () {\n  return [useForm, useWrap, useRouter, useForm];\n});\n\n_c = ChangePassword;\nexport default ChangePassword;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChangePassword\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/ChangePassword/index.tsx"],"names":["React","useState","useEffect","useRouter","Form","Card","Divider","Spin","useForm","yupResolver","yup","useWrap","userApi","TitlePage","InputPassField","ProfileSummary","signOut","returnSchema","schema","ChangePassword","props","register","handleSubmit","setValue","formState","isSubmitting","errors","isSubmitted","showNoti","getDataUser","userInformation","type","status","isLoading","setIsLoading","router","dataUser","dataForm","setDataForm","isNewUser","setIsNewUser","defaultValuesInit","KeyForgotPassword","Password","RePassword","returnSchemaFunc","Object","keys","forEach","key","string","required","oneOf","ref","object","shape","form","defaultValues","resolver","onSubmit","data","res","changePassword","reset","localStorage","setItem","setTimeout","message","checkNewUser","getItem","Gender","parseInt","width","display","flexDirection","alignItems","push"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { useRouter } from 'next/router'\r\nimport { Form, Card, Divider, Spin } from 'antd'\r\nimport { useForm } from 'react-hook-form'\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from 'yup'\r\nimport { useWrap } from '~/context/wrap'\r\nimport { userApi } from '~/apiBase'\r\nimport TitlePage from '~/components/Elements/TitlePage'\r\nimport InputPassField from '~/components/FormControl/InputPassField'\r\nimport ProfileSummary from '~/components/ProfileSummary.tsx/ProfileSummary'\r\nimport { signOut } from 'next-auth/client'\r\n\r\nlet returnSchema = {}\r\nlet schema = null\r\n\r\nconst ChangePassword = (props) => {\r\n\tconst {\r\n\t\tregister,\r\n\t\thandleSubmit,\r\n\t\tsetValue,\r\n\t\tformState: { isSubmitting, errors, isSubmitted }\r\n\t} = useForm()\r\n\tconst { showNoti, getDataUser, userInformation } = useWrap()\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: '',\r\n\t\tstatus: false\r\n\t})\r\n\tconst router = useRouter()\r\n\tconst { dataUser } = props\r\n\tconst [dataForm, setDataForm] = useState<IUser>(null)\r\n\tconst [isNewUser, setIsNewUser] = useState(false)\r\n\r\n\tconst defaultValuesInit = {\r\n\t\tKeyForgotPassword: '',\r\n\t\tPassword: '',\r\n\t\tRePassword: ''\r\n\t}\r\n\r\n\t;(function returnSchemaFunc() {\r\n\t\treturnSchema = { ...defaultValuesInit }\r\n\t\tObject.keys(returnSchema).forEach(function (key) {\r\n\t\t\tswitch (key) {\r\n\t\t\t\tcase 'KeyForgotPassword':\r\n\t\t\t\t\treturnSchema[key] = yup.string().required('Bạn không được bỏ trống')\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'Password':\r\n\t\t\t\t\treturnSchema[key] = yup.string().required('Bạn không được bỏ trống')\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'RePassword':\r\n\t\t\t\t\treturnSchema[key] = yup\r\n\t\t\t\t\t\t.string()\r\n\t\t\t\t\t\t.oneOf([yup.ref('Password'), null], 'Password mới xác nhận lại chưa đúng')\r\n\t\t\t\t\t\t.required('Bạn không được bỏ trống')\r\n\t\t\t\t\tbreak\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tschema = yup.object().shape(returnSchema)\r\n\t})()\r\n\r\n\tconst form = useForm({\r\n\t\tdefaultValues: defaultValuesInit,\r\n\t\tresolver: yupResolver(schema)\r\n\t})\r\n\r\n\t// ----------- SUBMI FORM ------------\r\n\tconst onSubmit = async (data: any) => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'ADD_DATA',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\t\tlet res = null\r\n\t\ttry {\r\n\t\t\tres = await userApi.changePassword(data)\r\n\t\t\tres?.status == 200 && (showNoti('success', 'Đổi mật khẩu thành công'), form.reset(defaultValuesInit))\r\n\t\t\tlocalStorage.setItem('isNewUser', 'false')\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tsignOut()\r\n\t\t\t}, 1000)\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tlet checkNewUser = localStorage.getItem('isNewUser')\r\n\r\n\t\tif (checkNewUser === 'true') {\r\n\t\t\tsetIsNewUser(true)\r\n\t\t\tform.setValue('KeyForgotPassword', '123456')\r\n\t\t}\r\n\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'FETCH_DATA',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\r\n\t\tif (dataUser) {\r\n\t\t\tdataUser.Gender = parseInt(dataUser.Gender)\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'FETCH_DATA',\r\n\t\t\t\t\tstatus: false\r\n\t\t\t\t})\r\n\t\t\t}, 500)\r\n\t\t\tif (userInformation === null) {\r\n\t\t\t\tsetDataForm(dataUser)\r\n\t\t\t} else {\r\n\t\t\t\tsetDataForm(userInformation)\r\n\t\t\t}\r\n\t\t}\r\n\t}, [userInformation])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<TitlePage title=\"Đổi mật khẩu\" />\r\n\t\t\t<div className=\"row\">\r\n\t\t\t\t<div className=\"col-md-4 col-12\">\r\n\t\t\t\t\t<Card className=\"info-profile-left\" loading={isLoading.type === 'FETCH_DATA' && isLoading.status}>\r\n\t\t\t\t\t\t<ProfileSummary isFix={true} dataForm={dataForm} />\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"col-md-7 col-12\">\r\n\t\t\t\t\t<Card className=\"space-top-card\">\r\n\t\t\t\t\t\t<Form layout=\"vertical\" onFinish={form.handleSubmit(onSubmit)}>\r\n\t\t\t\t\t\t\t<div className=\"row d-flex justify-content-center align-items-center\">\r\n\t\t\t\t\t\t\t\t<h5>Form thay đổi mật khẩu</h5>\r\n\r\n\t\t\t\t\t\t\t\t<Divider></Divider>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t\t\t<div style={{ width: '100%', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\r\n\t\t\t\t\t\t\t\t\t<InputPassField\r\n\t\t\t\t\t\t\t\t\t\tdisabled={isNewUser ? true : false}\r\n\t\t\t\t\t\t\t\t\t\tform={form}\r\n\t\t\t\t\t\t\t\t\t\tname=\"KeyForgotPassword\"\r\n\t\t\t\t\t\t\t\t\t\tlabel=\"Mật khẩu cũ\"\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ width: 500 }}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<InputPassField form={form} name=\"Password\" label=\"Mật khẩu mới\" style={{ width: 500 }} />\r\n\t\t\t\t\t\t\t\t\t<InputPassField form={form} name=\"RePassword\" label=\"Xác nhận mật khẩu mới\" style={{ width: 500 }} />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div className=\"row mt-3\">\r\n\t\t\t\t\t\t\t\t<div className=\"col-12 d-flex justify-content-center\">\r\n\t\t\t\t\t\t\t\t\t<button type=\"submit\" className=\"btn btn-primary\">\r\n\t\t\t\t\t\t\t\t\t\tLưu\r\n\t\t\t\t\t\t\t\t\t\t{isLoading.type == 'ADD_DATA' && isLoading.status && <Spin className=\"loading-base\" />}\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"btn btn-warning ml-4\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tlocalStorage.setItem('isNewUser', 'false')\r\n\t\t\t\t\t\t\t\t\t\t\trouter.push('/')\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tBỏ qua\r\n\t\t\t\t\t\t\t\t\t\t{isLoading.type == 'ADD_DATA' && isLoading.status && <Spin className=\"loading-base\" />}\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div></div>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default ChangePassword\r\n"]},"metadata":{},"sourceType":"module"}