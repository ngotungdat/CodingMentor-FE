{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\Option\\\\ConfigVoucherInvoice\\\\VourcherInvoice.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport { configApi } from '~/apiBase';\nimport ConfigVoucherInvoiceForm from '~/components/Global/Option/ConfigVoucherInvoice/ConfigVoucherInvoiceForm';\nimport FilterColumn from '~/components/Tables/FilterColumn';\nimport { useWrap } from '~/context/wrap';\nimport ReactHtmlParser from 'react-html-parser';\nimport ExpandTable from '~/components/ExpandTable';\nimport TitlePage from '~/components/TitlePage';\n\nvar ConfigVoucherInvoice = function ConfigVoucherInvoice() {\n  _s();\n\n  var _useState = useState([]),\n      dataTable = _useState[0],\n      setDataTable = _useState[1];\n\n  var _useState2 = useState({\n    type: '',\n    status: false\n  }),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useWrap = useWrap(),\n      showNoti = _useWrap.showNoti,\n      pageSize = _useWrap.pageSize;\n\n  var _useState3 = useState(null),\n      totalPage = _useState3[0],\n      setTotalPage = _useState3[1];\n\n  var _useState4 = useState(''),\n      activeColumnSearch = _useState4[0],\n      setActiveColumnSearch = _useState4[1]; // FILTER\n\n\n  var listFieldInit = {\n    pageIndex: 1,\n    pageSize: pageSize,\n    Type: null\n  };\n  var refValue = useRef({\n    pageIndex: 1,\n    pageSize: 10\n  });\n\n  var _useState5 = useState(listFieldInit),\n      filters = _useState5[0],\n      setFilters = _useState5[1];\n\n  var optionFormList = [{\n    title: 'Phiếu chi',\n    value: 1\n  }, {\n    title: 'Phiếu thu',\n    value: 2\n  }, {\n    title: 'Mẫu mail sắp tới giờ học',\n    value: 3\n  }, {\n    title: 'Mẫu mail được thêm vào khóa học mới',\n    value: 5\n  }, {\n    title: 'Mẫu mail lịch học thay đổi',\n    value: 6\n  }, {\n    title: 'Mẫu mail bài tập đã chấm',\n    value: 7\n  }, {\n    title: 'Mẫu mail sắp tới lịch dạy',\n    value: 8\n  }, {\n    title: 'Mẫu mail được chỉ định dạy khóa mới',\n    value: 9\n  }, {\n    title: 'Mẫu mail có bài tập cần chấm',\n    value: 10\n  }, {\n    title: 'Mẫu mail tạo được tài khoản mới',\n    value: 11\n  }]; // PAGINATION\n\n  var getPagination = function getPagination(pageIndex, pageSize) {\n    if (!pageSize) pageSize = 10;\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      pageSize: pageSize,\n      pageIndex: pageIndex\n    });\n    setFilters(_objectSpread(_objectSpread({}, filters), refValue.current));\n  }; // RESET SEARCH\n\n\n  var onResetSearch = function onResetSearch() {\n    setActiveColumnSearch('');\n    setFilters(_objectSpread(_objectSpread({}, listFieldInit), {}, {\n      pageSize: refValue.current.pageSize\n    }));\n  }; // ACTION SEARCH\n\n\n  var onSearch = function onSearch(valueSearch, dataIndex) {\n    setActiveColumnSearch(dataIndex);\n    setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, _defineProperty({\n      pageIndex: 1\n    }, dataIndex, valueSearch)));\n  };\n\n  var getDataTable = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setIsLoading({\n                type: 'GET_ALL',\n                status: true\n              });\n              _context.prev = 1;\n              _context.next = 4;\n              return configApi.getAll(filters);\n\n            case 4:\n              res = _context.sent;\n\n              if (res.status === 200) {\n                setDataTable(res.data.data);\n              }\n\n              if (res.status === 204) {\n                setDataTable([]);\n              }\n\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](1);\n              showNoti('danger', _context.t0.message);\n\n            case 12:\n              _context.prev = 12;\n              setIsLoading({\n                type: 'GET_ALL',\n                status: false\n              });\n              return _context.finish(12);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 9, 12, 15]]);\n    }));\n\n    return function getDataTable() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    getDataTable();\n  }, [filters]); // CREATE\n\n  var onCreate = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data) {\n      var res, newDataTable;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: true\n              });\n              _context2.next = 4;\n              return configApi.add(data);\n\n            case 4:\n              res = _context2.sent;\n\n              if (!(res.status === 200)) {\n                _context2.next = 10;\n                break;\n              }\n\n              newDataTable = [res.data.data].concat(_toConsumableArray(dataTable));\n              setDataTable(newDataTable);\n              showNoti('success', res.data.message);\n              return _context2.abrupt(\"return\", true);\n\n            case 10:\n              _context2.next = 15;\n              break;\n\n            case 12:\n              _context2.prev = 12;\n              _context2.t0 = _context2[\"catch\"](0);\n              showNoti('danger', _context2.t0.message);\n\n            case 15:\n              _context2.prev = 15;\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: false\n              });\n              return _context2.finish(15);\n\n            case 18:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 12, 15, 18]]);\n    }));\n\n    return function onCreate(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(); // UPDATE\n\n\n  var onUpdate = function onUpdate(idx) {\n    return /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(data) {\n        var dataUpdate, res, newDataTable;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                setIsLoading({\n                  type: 'ADD_DATA',\n                  status: true\n                });\n                dataUpdate = {\n                  ID: dataTable[idx].ID,\n                  ConfigContent: data.ConfigContent\n                };\n                _context3.next = 5;\n                return configApi.update(dataUpdate);\n\n              case 5:\n                res = _context3.sent;\n\n                if (!(res.status === 200)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                newDataTable = _toConsumableArray(dataTable);\n                newDataTable.splice(idx, 1, _objectSpread(_objectSpread({}, dataTable[idx]), data));\n                setDataTable(newDataTable);\n                showNoti('success', res.data.message);\n                return _context3.abrupt(\"return\", true);\n\n              case 12:\n                _context3.next = 17;\n                break;\n\n              case 14:\n                _context3.prev = 14;\n                _context3.t0 = _context3[\"catch\"](0);\n                showNoti('danger', _context3.t0.message);\n\n              case 17:\n                _context3.prev = 17;\n                setIsLoading({\n                  type: 'ADD_DATA',\n                  status: false\n                });\n                return _context3.finish(17);\n\n              case 20:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[0, 14, 17, 20]]);\n      }));\n\n      return function (_x2) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n  };\n\n  var columns = [_objectSpread(_objectSpread({\n    title: 'Loại phiếu',\n    dataIndex: 'TypeName'\n  }, FilterColumn('Type', onSearch, onResetSearch, 'select', optionFormList)), {}, {\n    // render: (type: number) => optionFormList.find((o) => o.value === type).title,\n    className: activeColumnSearch === 'AreaID' ? 'active-column-search' : ''\n  }), {\n    width: 100,\n    align: 'center',\n    render: function render(record, _, idx) {\n      return /*#__PURE__*/_jsxDEV(ConfigVoucherInvoiceForm, {\n        isLoading: isLoading,\n        isUpdate: true,\n        updateObj: record,\n        handleSubmit: onUpdate(idx),\n        optionFormList: optionFormList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 5\n      }, _this);\n    }\n  }];\n\n  var expandedRowRender = function expandedRowRender(text) {\n    return /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"invoice-content pt-5\",\n      children: ReactHtmlParser(text.ConfigContent)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 10\n    }, _this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(TitlePage, {\n      title: \"M\\u1EABu\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 4\n    }, _this), /*#__PURE__*/_jsxDEV(ExpandTable, {\n      loading: isLoading,\n      dataSource: dataTable,\n      columns: columns,\n      currentPage: filters.pageIndex,\n      totalPage: totalPage,\n      getPagination: getPagination,\n      TitleCard: /*#__PURE__*/_jsxDEV(ConfigVoucherInvoiceForm, {\n        isLoading: isLoading,\n        handleSubmit: onCreate,\n        optionFormList: optionFormList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 16\n      }, _this),\n      expandable: {\n        expandedRowRender: expandedRowRender\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 4\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(ConfigVoucherInvoice, \"NWioycYu5ZdsdcaatAbmUXF7T5o=\", false, function () {\n  return [useWrap];\n});\n\n_c = ConfigVoucherInvoice;\nexport default ConfigVoucherInvoice;\n\nvar _c;\n\n$RefreshReg$(_c, \"ConfigVoucherInvoice\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/Option/ConfigVoucherInvoice/VourcherInvoice.tsx"],"names":["React","useEffect","useRef","useState","configApi","ConfigVoucherInvoiceForm","FilterColumn","useWrap","ReactHtmlParser","ExpandTable","TitlePage","ConfigVoucherInvoice","dataTable","setDataTable","type","status","isLoading","setIsLoading","showNoti","pageSize","totalPage","setTotalPage","activeColumnSearch","setActiveColumnSearch","listFieldInit","pageIndex","Type","refValue","filters","setFilters","optionFormList","title","value","getPagination","current","onResetSearch","onSearch","valueSearch","dataIndex","getDataTable","getAll","res","data","message","onCreate","add","newDataTable","onUpdate","idx","dataUpdate","ID","ConfigContent","update","splice","columns","className","width","align","render","record","_","expandedRowRender","text"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { configApi } from '~/apiBase';\r\nimport ConfigVoucherInvoiceForm from '~/components/Global/Option/ConfigVoucherInvoice/ConfigVoucherInvoiceForm';\r\nimport PowerTable from '~/components/PowerTable';\r\nimport FilterColumn from '~/components/Tables/FilterColumn';\r\nimport { useWrap } from '~/context/wrap';\r\nimport ReactHtmlParser, { processNodes, convertNodeToElement, htmlparser2 } from 'react-html-parser';\r\nimport ExpandTable from '~/components/ExpandTable';\r\nimport TitlePage from '~/components/TitlePage';\r\n\r\nconst ConfigVoucherInvoice = () => {\r\n\tconst [dataTable, setDataTable] = useState<IConfig[]>([]);\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: '',\r\n\t\tstatus: false\r\n\t});\r\n\tconst { showNoti, pageSize } = useWrap();\r\n\tconst [totalPage, setTotalPage] = useState(null);\r\n\tconst [activeColumnSearch, setActiveColumnSearch] = useState('');\r\n\t// FILTER\r\n\tconst listFieldInit = {\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: pageSize,\r\n\r\n\t\tType: null\r\n\t};\r\n\tlet refValue = useRef({\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: 10\r\n\t});\r\n\tconst [filters, setFilters] = useState(listFieldInit);\r\n\tconst optionFormList = [\r\n\t\t{ title: 'Phiếu chi', value: 1 },\r\n\t\t{ title: 'Phiếu thu', value: 2 },\r\n\t\t{ title: 'Mẫu mail sắp tới giờ học', value: 3 },\r\n\t\t{ title: 'Mẫu mail được thêm vào khóa học mới', value: 5 },\r\n\t\t{ title: 'Mẫu mail lịch học thay đổi', value: 6 },\r\n\t\t{ title: 'Mẫu mail bài tập đã chấm', value: 7 },\r\n\t\t{ title: 'Mẫu mail sắp tới lịch dạy', value: 8 },\r\n\t\t{ title: 'Mẫu mail được chỉ định dạy khóa mới', value: 9 },\r\n\t\t{ title: 'Mẫu mail có bài tập cần chấm', value: 10 },\r\n\t\t{ title: 'Mẫu mail tạo được tài khoản mới', value: 11 }\r\n\t];\r\n\r\n\t// PAGINATION\r\n\tconst getPagination = (pageIndex: number, pageSize: number) => {\r\n\t\tif (!pageSize) pageSize = 10;\r\n\t\trefValue.current = {\r\n\t\t\t...refValue.current,\r\n\t\t\tpageSize,\r\n\t\t\tpageIndex\r\n\t\t};\r\n\t\tsetFilters({\r\n\t\t\t...filters,\r\n\t\t\t...refValue.current\r\n\t\t});\r\n\t};\r\n\t// RESET SEARCH\r\n\tconst onResetSearch = () => {\r\n\t\tsetActiveColumnSearch('');\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\tpageSize: refValue.current.pageSize\r\n\t\t});\r\n\t};\r\n\t// ACTION SEARCH\r\n\tconst onSearch = (valueSearch, dataIndex) => {\r\n\t\tsetActiveColumnSearch(dataIndex);\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\t...refValue.current,\r\n\t\t\tpageIndex: 1,\r\n\t\t\t[dataIndex]: valueSearch\r\n\t\t});\r\n\t};\r\n\tconst getDataTable = async () => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'GET_ALL',\r\n\t\t\tstatus: true\r\n\t\t});\r\n\t\ttry {\r\n\t\t\tlet res = await configApi.getAll(filters);\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tsetDataTable(res.data.data);\r\n\t\t\t}\r\n\t\t\tif (res.status === 204) {\r\n\t\t\t\tsetDataTable([]);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tgetDataTable();\r\n\t}, [filters]);\r\n\r\n\t// CREATE\r\n\tconst onCreate = async (data: { ConfigContent: string; Type: number }) => {\r\n\t\ttry {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: true\r\n\t\t\t});\r\n\t\t\tconst res = await configApi.add(data);\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tconst newDataTable = [res.data.data, ...dataTable];\r\n\t\t\t\tsetDataTable(newDataTable);\r\n\t\t\t\tshowNoti('success', res.data.message);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: false\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t// UPDATE\r\n\tconst onUpdate = (idx: number) => {\r\n\t\treturn async (data: { ConfigContent: string; Type: number }) => {\r\n\t\t\ttry {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\t\tstatus: true\r\n\t\t\t\t});\r\n\t\t\t\tconst dataUpdate = {\r\n\t\t\t\t\tID: dataTable[idx].ID,\r\n\t\t\t\t\tConfigContent: data.ConfigContent\r\n\t\t\t\t};\r\n\t\t\t\tconst res = await configApi.update(dataUpdate);\r\n\t\t\t\tif (res.status === 200) {\r\n\t\t\t\t\tconst newDataTable = [...dataTable];\r\n\t\t\t\t\tnewDataTable.splice(idx, 1, { ...dataTable[idx], ...data });\r\n\t\t\t\t\tsetDataTable(newDataTable);\r\n\t\t\t\t\tshowNoti('success', res.data.message);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message);\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\t\tstatus: false\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Loại phiếu',\r\n\t\t\tdataIndex: 'TypeName',\r\n\t\t\t...FilterColumn('Type', onSearch, onResetSearch, 'select', optionFormList),\r\n\t\t\t// render: (type: number) => optionFormList.find((o) => o.value === type).title,\r\n\t\t\tclassName: activeColumnSearch === 'AreaID' ? 'active-column-search' : ''\r\n\t\t},\r\n\t\t{\r\n\t\t\twidth: 100,\r\n\t\t\talign: 'center',\r\n\t\t\trender: (record: IConfig, _, idx: number) => (\r\n\t\t\t\t<ConfigVoucherInvoiceForm\r\n\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t\tisUpdate={true}\r\n\t\t\t\t\tupdateObj={record}\r\n\t\t\t\t\thandleSubmit={onUpdate(idx)}\r\n\t\t\t\t\toptionFormList={optionFormList}\r\n\t\t\t\t/>\r\n\t\t\t)\r\n\t\t}\r\n\t];\r\n\r\n\tconst expandedRowRender = (text) => {\r\n\t\treturn <p className=\"invoice-content pt-5\">{ReactHtmlParser(text.ConfigContent)}</p>;\r\n\t};\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<TitlePage title=\"Mẫu\" />\r\n\t\t\t<ExpandTable\r\n\t\t\t\tloading={isLoading}\r\n\t\t\t\tdataSource={dataTable}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tcurrentPage={filters.pageIndex}\r\n\t\t\t\ttotalPage={totalPage}\r\n\t\t\t\tgetPagination={getPagination}\r\n\t\t\t\tTitleCard={<ConfigVoucherInvoiceForm isLoading={isLoading} handleSubmit={onCreate} optionFormList={optionFormList} />}\r\n\t\t\t\texpandable={{ expandedRowRender }}\r\n\t\t\t/>\r\n\t\t</>\r\n\t);\r\n};\r\nexport default ConfigVoucherInvoice;\r\n"]},"metadata":{},"sourceType":"module"}