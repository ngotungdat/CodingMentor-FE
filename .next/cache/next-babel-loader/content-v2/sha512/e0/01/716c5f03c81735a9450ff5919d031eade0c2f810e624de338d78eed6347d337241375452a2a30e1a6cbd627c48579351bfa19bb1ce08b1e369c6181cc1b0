{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\Option\\\\ProgramDetail\\\\Curriculum.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { DiffOutlined } from '@ant-design/icons';\nimport { Modal, Select, Tooltip } from 'antd';\nimport { useRouter } from 'next/router';\nimport React, { useEffect, useState } from 'react';\nimport { curriculumApi, programApi, subjectApi } from '~/apiBase';\nimport ExpandTable from '~/components/ExpandTable';\nimport CurriculumForm from '~/components/Global/Option/CurriculumForm';\nimport { useWrap } from '~/context/wrap';\nimport CurriculumDetail from './CurriculumDetail';\nlet pageIndex = 1;\nlet listFieldSearch = {\n  pageIndex: 1\n};\nconst dataOption = [{\n  dataSort: {\n    sort: 0,\n    sortType: false\n  },\n  text: 'Tên giảm dần'\n}, {\n  dataSort: {\n    sort: 0,\n    sortType: true\n  },\n  text: 'Tên tăng dần '\n}];\n\nconst Curriculum = props => {\n  const {\n    key\n  } = props;\n  const router = useRouter();\n  const programID = parseInt(router.query.slug);\n  const {\n    0: dataProgram,\n    1: setDataProgram\n  } = useState([]);\n  const {\n    0: dataSubject,\n    1: setDataSubject\n  } = useState();\n  const {\n    0: curriculumID,\n    1: setCurriculumID\n  } = useState(null); // ------ BASE USESTATE TABLE -------\n\n  const {\n    0: dataSource,\n    1: setDataSource\n  } = useState([]);\n  const {\n    showNoti,\n    pageSize,\n    userInformation\n  } = useWrap();\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState({\n    type: '',\n    status: false\n  });\n  const {\n    0: totalPage,\n    1: setTotalPage\n  } = useState(null);\n  const {\n    0: indexRow,\n    1: setIndexRow\n  } = useState(null);\n  const {\n    0: currentPage,\n    1: setCurrentPage\n  } = useState(1);\n  const listTodoApi = {\n    pageSize: pageSize,\n    pageIndex: pageIndex,\n    ProgramID: programID ? programID : null\n  };\n  const {\n    0: todoApi,\n    1: setTodoApi\n  } = useState(listTodoApi); // GET DATA COURSE\n\n  const getDataSource = async () => {\n    setIsLoading({\n      type: 'GET_ALL',\n      status: true\n    });\n\n    try {\n      let res = await curriculumApi.getAll(todoApi);\n\n      if (res.status == 200) {\n        if (res.data.data.length > 0) {\n          setDataSource(res.data.data);\n          setTotalPage(res.data.totalRow);\n        } else {\n          showNoti('danger', 'Không có dữ liệu');\n        }\n      }\n\n      res.status == 204 && showNoti('danger', 'Không có dữ liệu') && setDataSource([]);\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {\n      setIsLoading({\n        type: 'GET_ALL',\n        status: false\n      });\n    }\n  }; // GET DATA PROGRAM\n\n\n  const getDataProgram = async () => {\n    try {\n      let res = await programApi.getAll(todoApi);\n      res.status == 200 && setDataProgram(res.data.data);\n      res.status == 204 && showNoti('danger', 'Không có dữ liệu');\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {}\n  }; // ---------------- GET DATA SUBJECT -------------\n\n\n  const getDataSubject = async () => {\n    try {\n      let res = await subjectApi.getAll({\n        ProgramID: programID,\n        pageIndex: 1,\n        pageSize: 9999\n      });\n\n      if (res.status == 200) {\n        if (res.data.data.length > 0) {\n          setDataSubject(res.data.data);\n        } else {\n          showNoti('danger', 'Không có dữ liệu môn học');\n        }\n      }\n\n      res.status == 204 && showNoti('danger', 'Không có dữ liệu');\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {}\n  }; // ---------------- AFTER SUBMIT -----------------\n\n\n  const afterPost = mes => {\n    showNoti('success', mes);\n    setTodoApi(_objectSpread(_objectSpread({}, listTodoApi), {}, {\n      pageIndex: 1\n    }));\n    setCurrentPage(1);\n  }; // ----------------- ON SUBMIT --------------------\n\n\n  const _onSubmit = async dataSubmit => {\n    setIsLoading({\n      type: 'ADD_DATA',\n      status: true\n    });\n    let res = null;\n\n    if (dataSubmit.ID) {\n      try {\n        res = await curriculumApi.update(dataSubmit);\n\n        if (res.status == 200) {\n          let newDataSource = [...dataSource];\n          newDataSource.splice(indexRow, 1, dataSubmit);\n          setDataSource(newDataSource);\n          showNoti('success', res.data.message);\n          getDataSubject();\n        }\n      } catch (error) {\n        showNoti('danger', error.message);\n      } finally {\n        setIsLoading({\n          type: 'ADD_DATA',\n          status: false\n        });\n      }\n    } else {\n      try {\n        var _res;\n\n        res = await curriculumApi.add(dataSubmit);\n        ((_res = res) === null || _res === void 0 ? void 0 : _res.status) == 200 && (afterPost(res.data.message), getDataSubject());\n      } catch (error) {\n        showNoti('danger', error.message);\n      } finally {\n        setIsLoading({\n          type: 'ADD_DATA',\n          status: false\n        });\n      }\n    }\n\n    return res;\n  }; // HANDLE RESET\n\n\n  const resetListFieldSearch = () => {\n    Object.keys(listFieldSearch).forEach(function (key) {\n      if (key != 'pageIndex') {\n        listFieldSearch[key] = null;\n      }\n    });\n  }; // -------------- HANDLE DELETE --------------\n\n\n  const handleDelete = async data => {\n    try {\n      let res = await curriculumApi.update({\n        ID: data.ID,\n        Enable: false\n      });\n\n      if (res.status === 200) {\n        showNoti('success', 'Xóa thành công');\n        setTodoApi(_objectSpread({}, todoApi));\n      } else {\n        showNoti('danger', 'Đường truyền mạng đang không ổn định');\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    }\n  }; // -------------- GET PAGE_NUMBER -----------------\n\n\n  const getPagination = pageNumber => {\n    pageIndex = pageNumber;\n    setCurrentPage(pageNumber);\n    setTodoApi(_objectSpread(_objectSpread({}, todoApi), {}, {\n      // ...listFieldSearch,\n      pageIndex: pageIndex\n    }));\n  }; // ============== USE EFFECT - FETCH DATA ===================\n\n\n  useEffect(() => {\n    getDataSource();\n  }, [todoApi, key]);\n  useEffect(() => {\n    getDataProgram();\n    getDataSubject();\n  }, []); // EXPANDED ROW RENDER\n\n  const expandedRowRender = () => {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(CurriculumDetail, {\n        isFixed: true,\n        isNested: true,\n        loadingOut: isLoading,\n        dataSubject: dataSubject,\n        programID: programID,\n        curriculumID: curriculumID\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 5\n      }, this)\n    }, void 0, false);\n  };\n\n  const columns = [{\n    title: 'ID',\n    dataIndex: 'ID',\n    render: id => /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-weight-black\",\n      children: id\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 20\n    }, this),\n    fixed: 'left'\n  }, {\n    width: '50%',\n    title: 'Giáo trình',\n    dataIndex: 'CurriculumName',\n    key: 'curriculumname',\n    render: text => /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-weight-black\",\n      children: text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 22\n    }, this),\n    fixed: 'left'\n  }, {\n    width: 120,\n    title: 'Thời gian học',\n    dataIndex: 'TimeOfLesson',\n    key: 'timeoflesson',\n    className: 'text-center'\n  }, {\n    width: 120,\n    title: 'Buổi học',\n    dataIndex: 'Lesson',\n    key: 'lesson',\n    className: 'text-center'\n  }, {\n    width: userInformation && (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) !== 2 ? 180 : 0,\n    key: 'action',\n    align: 'center',\n    render: (text, data, index) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: userInformation && (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) !== 2 && /*#__PURE__*/_jsxDEV(CurriculumForm, {\n        dataProgram: dataProgram,\n        getIndex: () => setIndexRow(index),\n        index: index,\n        rowData: data,\n        rowID: data.ID,\n        isLoading: isLoading,\n        _onSubmit: data => _onSubmit(data)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 7\n      }, this)\n    }, void 0, false)\n  }];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(ExpandTable // addClass=\"table-medium\"\n    , {\n      currentPage: currentPage,\n      totalPage: totalPage && totalPage,\n      getPagination: pageNumber => getPagination(pageNumber),\n      loading: isLoading,\n      TitleCard: userInformation && (userInformation === null || userInformation === void 0 ? void 0 : userInformation.RoleID) !== 2 && /*#__PURE__*/_jsxDEV(CurriculumForm, {\n        dataProgram: dataProgram,\n        isLoading: isLoading,\n        _onSubmit: data => _onSubmit(data)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 7\n      }, this),\n      dataSource: dataSource,\n      columns: columns,\n      Extra: 'Giáo trình',\n      expandable: {\n        expandedRowRender\n      },\n      handleExpand: record => (setCurriculumID(record.ID), getDataSubject())\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 296,\n    columnNumber: 3\n  }, this);\n};\n\nexport default Curriculum;\n\nconst PickAllSubject = props => {\n  const {\n    Option\n  } = Select;\n  const {\n    dataSubject,\n    curriculumID,\n    onFetchData\n  } = props;\n  const {\n    0: isModalVisible,\n    1: setIsModalVisible\n  } = useState(false);\n  const {\n    0: valueSubject,\n    1: setValueSubject\n  } = useState(false);\n  const {\n    showNoti\n  } = useWrap();\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n\n  const showModal = () => {\n    setIsModalVisible(true);\n  };\n\n  const handleOk = async () => {\n    setLoading(true);\n    let dataSubmit = {\n      ID: curriculumID,\n      SubjectID: valueSubject\n    };\n\n    try {\n      let res = await curriculumApi.addSubject(dataSubmit);\n\n      if (res.status === 200) {\n        showNoti('success', 'Thêm môn học thành công');\n        setIsModalVisible(false);\n        onFetchData();\n        setValueSubject(null);\n      } else {\n        showNoti('danger', 'Đường truyền mạng đang không ổn định');\n      }\n    } catch (error) {\n      showNoti('error', error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCancel = () => {\n    setIsModalVisible(false);\n  };\n\n  const handleChange_Subject = value => {\n    setValueSubject(value);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Tooltip, {\n      title: \"Th\\xEAm m\\xF4n h\\u1ECDc cho t\\u1EA5t c\\u1EA3 c\\xE1c bu\\u1ED5i\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-icon view\",\n        onClick: showModal,\n        children: /*#__PURE__*/_jsxDEV(DiffOutlined, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"Th\\xEAm m\\xF4n h\\u1ECDc\",\n      visible: isModalVisible,\n      okButtonProps: {\n        loading: loading\n      },\n      onOk: handleOk,\n      onCancel: handleCancel,\n      okText: \"L\\u01B0u\",\n      cancelText: \"H\\u1EE7y\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"font-weight-black mb-2\",\n        children: \"Ch\\u1ECDn m\\xF4n h\\u1ECDc\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Select, {\n        className: \"w-100 style-input\",\n        onChange: handleChange_Subject,\n        children: dataSubject === null || dataSubject === void 0 ? void 0 : dataSubject.map(item => /*#__PURE__*/_jsxDEV(Option, {\n          value: item.ID,\n          children: item.SubjectName\n        }, item.ID, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 7\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/Option/ProgramDetail/Curriculum.tsx"],"names":["DiffOutlined","Modal","Select","Tooltip","useRouter","React","useEffect","useState","curriculumApi","programApi","subjectApi","ExpandTable","CurriculumForm","useWrap","CurriculumDetail","pageIndex","listFieldSearch","dataOption","dataSort","sort","sortType","text","Curriculum","props","key","router","programID","parseInt","query","slug","dataProgram","setDataProgram","dataSubject","setDataSubject","curriculumID","setCurriculumID","dataSource","setDataSource","showNoti","pageSize","userInformation","isLoading","setIsLoading","type","status","totalPage","setTotalPage","indexRow","setIndexRow","currentPage","setCurrentPage","listTodoApi","ProgramID","todoApi","setTodoApi","getDataSource","res","getAll","data","length","totalRow","error","message","getDataProgram","getDataSubject","afterPost","mes","_onSubmit","dataSubmit","ID","update","newDataSource","splice","add","resetListFieldSearch","Object","keys","forEach","handleDelete","Enable","getPagination","pageNumber","expandedRowRender","columns","title","dataIndex","render","id","fixed","width","className","RoleID","align","index","record","PickAllSubject","Option","onFetchData","isModalVisible","setIsModalVisible","valueSubject","setValueSubject","loading","setLoading","showModal","handleOk","SubjectID","addSubject","handleCancel","handleChange_Subject","value","map","item","SubjectName"],"mappings":"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","sourcesContent":["import { DiffOutlined } from '@ant-design/icons'\r\nimport { Modal, Select, Tooltip } from 'antd'\r\nimport { useRouter } from 'next/router'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Book } from 'react-feather'\r\nimport { curriculumApi, programApi, subjectApi } from '~/apiBase'\r\nimport ExpandTable from '~/components/ExpandTable'\r\nimport CurriculumForm from '~/components/Global/Option/CurriculumForm'\r\nimport DeleteItem from '~/components/Tables/DeleteItem'\r\nimport { useWrap } from '~/context/wrap'\r\nimport CurriculumDetail from './CurriculumDetail'\r\n\r\nlet pageIndex = 1\r\n\r\nlet listFieldSearch = {\r\n\tpageIndex: 1\r\n}\r\n\r\nconst dataOption = [\r\n\t{\r\n\t\tdataSort: {\r\n\t\t\tsort: 0,\r\n\t\t\tsortType: false\r\n\t\t},\r\n\t\ttext: 'Tên giảm dần'\r\n\t},\r\n\t{\r\n\t\tdataSort: {\r\n\t\t\tsort: 0,\r\n\t\t\tsortType: true\r\n\t\t},\r\n\t\ttext: 'Tên tăng dần '\r\n\t}\r\n]\r\n\r\nconst Curriculum = (props) => {\r\n\tconst { key } = props\r\n\tconst router = useRouter()\r\n\tconst programID = parseInt(router.query.slug as string)\r\n\r\n\tconst [dataProgram, setDataProgram] = useState<IProgram[]>([])\r\n\tconst [dataSubject, setDataSubject] = useState<ISubject[]>()\r\n\tconst [curriculumID, setCurriculumID] = useState(null)\r\n\r\n\t// ------ BASE USESTATE TABLE -------\r\n\tconst [dataSource, setDataSource] = useState<ICurriculum[]>([])\r\n\tconst { showNoti, pageSize, userInformation } = useWrap()\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: '',\r\n\t\tstatus: false\r\n\t})\r\n\tconst [totalPage, setTotalPage] = useState(null)\r\n\tconst [indexRow, setIndexRow] = useState(null)\r\n\tconst [currentPage, setCurrentPage] = useState(1)\r\n\tconst listTodoApi = {\r\n\t\tpageSize: pageSize,\r\n\t\tpageIndex: pageIndex,\r\n\t\tProgramID: programID ? programID : null\r\n\t}\r\n\tconst [todoApi, setTodoApi] = useState(listTodoApi)\r\n\r\n\t// GET DATA COURSE\r\n\tconst getDataSource = async () => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'GET_ALL',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\t\ttry {\r\n\t\t\tlet res = await curriculumApi.getAll(todoApi)\r\n\t\t\tif (res.status == 200) {\r\n\t\t\t\tif (res.data.data.length > 0) {\r\n\t\t\t\t\tsetDataSource(res.data.data)\r\n\t\t\t\t\tsetTotalPage(res.data.totalRow)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tshowNoti('danger', 'Không có dữ liệu')\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tres.status == 204 && showNoti('danger', 'Không có dữ liệu') && setDataSource([])\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// GET DATA PROGRAM\r\n\tconst getDataProgram = async () => {\r\n\t\ttry {\r\n\t\t\tlet res = await programApi.getAll(todoApi)\r\n\t\t\tres.status == 200 && setDataProgram(res.data.data)\r\n\r\n\t\t\tres.status == 204 && showNoti('danger', 'Không có dữ liệu')\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t}\r\n\t}\r\n\r\n\t// ---------------- GET DATA SUBJECT -------------\r\n\r\n\tconst getDataSubject = async () => {\r\n\t\ttry {\r\n\t\t\tlet res = await subjectApi.getAll({\r\n\t\t\t\tProgramID: programID,\r\n\t\t\t\tpageIndex: 1,\r\n\t\t\t\tpageSize: 9999\r\n\t\t\t})\r\n\t\t\tif (res.status == 200) {\r\n\t\t\t\tif (res.data.data.length > 0) {\r\n\t\t\t\t\tsetDataSubject(res.data.data)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tshowNoti('danger', 'Không có dữ liệu môn học')\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tres.status == 204 && showNoti('danger', 'Không có dữ liệu')\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t}\r\n\t}\r\n\r\n\t// ---------------- AFTER SUBMIT -----------------\r\n\tconst afterPost = (mes) => {\r\n\t\tshowNoti('success', mes)\r\n\t\tsetTodoApi({\r\n\t\t\t...listTodoApi,\r\n\t\t\tpageIndex: 1\r\n\t\t})\r\n\t\tsetCurrentPage(1)\r\n\t}\r\n\r\n\t// ----------------- ON SUBMIT --------------------\r\n\tconst _onSubmit = async (dataSubmit: any) => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'ADD_DATA',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\t\tlet res = null\r\n\t\tif (dataSubmit.ID) {\r\n\t\t\ttry {\r\n\t\t\t\tres = await curriculumApi.update(dataSubmit)\r\n\r\n\t\t\t\tif (res.status == 200) {\r\n\t\t\t\t\tlet newDataSource = [...dataSource]\r\n\t\t\t\t\tnewDataSource.splice(indexRow, 1, dataSubmit)\r\n\t\t\t\t\tsetDataSource(newDataSource)\r\n\t\t\t\t\tshowNoti('success', res.data.message)\r\n\t\t\t\t\tgetDataSubject()\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\t\tstatus: false\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttry {\r\n\t\t\t\tres = await curriculumApi.add(dataSubmit)\r\n\t\t\t\tres?.status == 200 && (afterPost(res.data.message), getDataSubject())\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\t\tstatus: false\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\t// HANDLE RESET\r\n\tconst resetListFieldSearch = () => {\r\n\t\tObject.keys(listFieldSearch).forEach(function (key) {\r\n\t\t\tif (key != 'pageIndex') {\r\n\t\t\t\tlistFieldSearch[key] = null\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// -------------- HANDLE DELETE --------------\r\n\tconst handleDelete = async (data) => {\r\n\t\ttry {\r\n\t\t\tlet res = await curriculumApi.update({\r\n\t\t\t\tID: data.ID,\r\n\t\t\t\tEnable: false\r\n\t\t\t})\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tshowNoti('success', 'Xóa thành công')\r\n\t\t\t\tsetTodoApi({ ...todoApi })\r\n\t\t\t} else {\r\n\t\t\t\tshowNoti('danger', 'Đường truyền mạng đang không ổn định')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t}\r\n\t}\r\n\r\n\t// -------------- GET PAGE_NUMBER -----------------\r\n\tconst getPagination = (pageNumber: number) => {\r\n\t\tpageIndex = pageNumber\r\n\t\tsetCurrentPage(pageNumber)\r\n\t\tsetTodoApi({\r\n\t\t\t...todoApi,\r\n\t\t\t// ...listFieldSearch,\r\n\t\t\tpageIndex: pageIndex\r\n\t\t})\r\n\t}\r\n\r\n\t// ============== USE EFFECT - FETCH DATA ===================\r\n\tuseEffect(() => {\r\n\t\tgetDataSource()\r\n\t}, [todoApi, key])\r\n\r\n\tuseEffect(() => {\r\n\t\tgetDataProgram()\r\n\t\tgetDataSubject()\r\n\t}, [])\r\n\r\n\t// EXPANDED ROW RENDER\r\n\r\n\tconst expandedRowRender = () => {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<CurriculumDetail\r\n\t\t\t\t\tisFixed={true}\r\n\t\t\t\t\tisNested={true}\r\n\t\t\t\t\tloadingOut={isLoading}\r\n\t\t\t\t\tdataSubject={dataSubject}\r\n\t\t\t\t\tprogramID={programID}\r\n\t\t\t\t\tcurriculumID={curriculumID}\r\n\t\t\t\t/>\r\n\t\t\t</>\r\n\t\t)\r\n\t}\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'ID',\r\n\t\t\tdataIndex: 'ID',\r\n\t\t\trender: (id) => <p className=\"font-weight-black\">{id}</p>,\r\n\t\t\tfixed: 'left'\r\n\t\t},\r\n\t\t{\r\n\t\t\twidth: '50%',\r\n\t\t\ttitle: 'Giáo trình',\r\n\t\t\tdataIndex: 'CurriculumName',\r\n\t\t\tkey: 'curriculumname',\r\n\t\t\trender: (text) => <p className=\"font-weight-black\">{text}</p>,\r\n\t\t\tfixed: 'left'\r\n\t\t},\r\n\t\t{\r\n\t\t\twidth: 120,\r\n\t\t\ttitle: 'Thời gian học',\r\n\t\t\tdataIndex: 'TimeOfLesson',\r\n\t\t\tkey: 'timeoflesson',\r\n\t\t\tclassName: 'text-center'\r\n\t\t},\r\n\t\t{\r\n\t\t\twidth: 120,\r\n\t\t\ttitle: 'Buổi học',\r\n\t\t\tdataIndex: 'Lesson',\r\n\t\t\tkey: 'lesson',\r\n\t\t\tclassName: 'text-center'\r\n\t\t},\r\n\r\n\t\t{\r\n\t\t\twidth: userInformation && userInformation?.RoleID !== 2 ? 180 : 0,\r\n\t\t\tkey: 'action',\r\n\t\t\talign: 'center',\r\n\t\t\trender: (text, data, index) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{userInformation && userInformation?.RoleID !== 2 && (\r\n\t\t\t\t\t\t<CurriculumForm\r\n\t\t\t\t\t\t\tdataProgram={dataProgram}\r\n\t\t\t\t\t\t\tgetIndex={() => setIndexRow(index)}\r\n\t\t\t\t\t\t\tindex={index}\r\n\t\t\t\t\t\t\trowData={data}\r\n\t\t\t\t\t\t\trowID={data.ID}\r\n\t\t\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t\t\t\t_onSubmit={(data: any) => _onSubmit(data)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</>\r\n\t\t\t)\r\n\t\t}\r\n\t]\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<ExpandTable\r\n\t\t\t\t// addClass=\"table-medium\"\r\n\t\t\t\tcurrentPage={currentPage}\r\n\t\t\t\ttotalPage={totalPage && totalPage}\r\n\t\t\t\tgetPagination={(pageNumber: number) => getPagination(pageNumber)}\r\n\t\t\t\tloading={isLoading}\r\n\t\t\t\tTitleCard={\r\n\t\t\t\t\tuserInformation &&\r\n\t\t\t\t\tuserInformation?.RoleID !== 2 && (\r\n\t\t\t\t\t\t<CurriculumForm dataProgram={dataProgram} isLoading={isLoading} _onSubmit={(data: any) => _onSubmit(data)} />\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\tdataSource={dataSource}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tExtra={'Giáo trình'}\r\n\t\t\t\texpandable={{ expandedRowRender }}\r\n\t\t\t\thandleExpand={(record: any) => (setCurriculumID(record.ID), getDataSubject())}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Curriculum\r\n\r\nconst PickAllSubject = (props) => {\r\n\tconst { Option } = Select\r\n\tconst { dataSubject, curriculumID, onFetchData } = props\r\n\tconst [isModalVisible, setIsModalVisible] = useState(false)\r\n\tconst [valueSubject, setValueSubject] = useState(false)\r\n\tconst { showNoti } = useWrap()\r\n\tconst [loading, setLoading] = useState(false)\r\n\r\n\tconst showModal = () => {\r\n\t\tsetIsModalVisible(true)\r\n\t}\r\n\r\n\tconst handleOk = async () => {\r\n\t\tsetLoading(true)\r\n\r\n\t\tlet dataSubmit = {\r\n\t\t\tID: curriculumID,\r\n\t\t\tSubjectID: valueSubject\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tlet res = await curriculumApi.addSubject(dataSubmit)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tshowNoti('success', 'Thêm môn học thành công')\r\n\t\t\t\tsetIsModalVisible(false)\r\n\t\t\t\tonFetchData()\r\n\t\t\t\tsetValueSubject(null)\r\n\t\t\t} else {\r\n\t\t\t\tshowNoti('danger', 'Đường truyền mạng đang không ổn định')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('error', error.message)\r\n\t\t} finally {\r\n\t\t\tsetLoading(false)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleCancel = () => {\r\n\t\tsetIsModalVisible(false)\r\n\t}\r\n\r\n\tconst handleChange_Subject = (value) => {\r\n\t\tsetValueSubject(value)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Tooltip title=\"Thêm môn học cho tất cả các buổi\">\r\n\t\t\t\t<button className=\"btn btn-icon view\" onClick={showModal}>\r\n\t\t\t\t\t<DiffOutlined />\r\n\t\t\t\t</button>\r\n\t\t\t</Tooltip>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\ttitle=\"Thêm môn học\"\r\n\t\t\t\tvisible={isModalVisible}\r\n\t\t\t\tokButtonProps={{ loading: loading }}\r\n\t\t\t\tonOk={handleOk}\r\n\t\t\t\tonCancel={handleCancel}\r\n\t\t\t\tokText=\"Lưu\"\r\n\t\t\t\tcancelText=\"Hủy\"\r\n\t\t\t>\r\n\t\t\t\t<p className=\"font-weight-black mb-2\">Chọn môn học</p>\r\n\t\t\t\t<Select className=\"w-100 style-input\" onChange={handleChange_Subject}>\r\n\t\t\t\t\t{dataSubject?.map((item) => (\r\n\t\t\t\t\t\t<Option key={item.ID} value={item.ID}>\r\n\t\t\t\t\t\t\t{item.SubjectName}\r\n\t\t\t\t\t\t</Option>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</Select>\r\n\t\t\t</Modal>\r\n\t\t</>\r\n\t)\r\n}\r\n"]},"metadata":{},"sourceType":"module"}