{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\ExamList\\\\ExamShow\\\\DragList.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport { useDoingTest } from '~/context/useDoingTest';\nimport ReactHtmlParser from 'react-html-parser';\nimport { useDoneTest } from '~/context/useDoneTest';\nvar activeDrag = null;\n\nvar DragList = function DragList(props) {\n  _s();\n\n  var _useDoingTest = useDoingTest(),\n      activeID = _useDoingTest.activeID,\n      getActiveID = _useDoingTest.getActiveID,\n      packageResult = _useDoingTest.packageResult,\n      getPackageResult = _useDoingTest.getPackageResult,\n      getListPicked = _useDoingTest.getListPicked,\n      removeListPicked = _useDoingTest.removeListPicked;\n\n  var dataQuestion = props.dataQuestion,\n      listQuestionID = props.listQuestionID,\n      isDoingTest = props.isDoingTest,\n      setChild = props.setChild,\n      openPagi = props.openPagi,\n      isTeach = props.isTeach;\n\n  var _useDoneTest = useDoneTest(),\n      doneTestData = _useDoneTest.doneTestData;\n\n  var _useState = useState(dataQuestion),\n      dataQuestionClone = _useState[0],\n      setDataQuestionClone = _useState[1];\n\n  var _useState2 = useState([]),\n      dataAnswer = _useState2[0],\n      setDataAnswer = _useState2[1];\n\n  var _useState3 = useState([]),\n      listCorrectAnswer = _useState3[0],\n      setListCorrectAnswer = _useState3[1];\n\n  var _useState4 = useState(false),\n      isDrop = _useState4[0],\n      setIsDrop = _useState4[1];\n\n  if (isDoingTest) {\n    var indexQuestion = packageResult.SetPackageResultDetailInfoList.findIndex(function (item) {\n      return item.ExamTopicDetailID === dataQuestion.ID;\n    });\n  }\n\n  useEffect(function () {\n    if (dataQuestion.Paragraph !== '') {\n      var spaceEditor = document.querySelectorAll('.drag-list .space-editor');\n\n      if (spaceEditor && spaceEditor.length > 0) {\n        spaceEditor.forEach(function (item, index) {\n          var quesID = parseInt(item.getAttribute('ques-id')); // Sắp xếp lại thứ tự các ô input trong đoạn văn\n\n          var indexQues = null;\n\n          if (listQuestionID.includes(quesID)) {\n            indexQues = listQuestionID.indexOf(quesID);\n          }\n\n          if (indexQues !== null) {\n            var positionSpace = document.querySelectorAll('.drag-list .position-space');\n\n            if (positionSpace.length < spaceEditor.length) {\n              var span = document.createElement('span');\n              span.classList.add('position-space');\n              span.id = quesID.toString();\n\n              if (quesID === activeID) {\n                span.classList.add('active');\n              }\n\n              span.append(\"(\".concat(indexQues + 1, \")\"));\n              item.innerHTML = \"\".concat((indexQues + 1).toString());\n              item.before(span);\n            } else {\n              if (item.innerHTML == '') {\n                item.innerHTML = \"\".concat((indexQues + 1).toString());\n              }\n            }\n          }\n        });\n      }\n    }\n  }, [listQuestionID, dataAnswer]); // ---- ALL ACTION IN DOING TEST ----\n  // On Drop\n\n  var drop = function drop(ev) {\n    ev.preventDefault();\n    var data = ev.dataTransfer.getData('text');\n    data && ev.target.appendChild(document.getElementById(data));\n\n    var nodeList = _toConsumableArray(ev.target.childNodes);\n\n    nodeList.forEach(function (item) {\n      dataAnswer.every(function (element) {\n        if (element.ansID === parseInt(item.id)) {\n          // Xử lí mảng dataAnswer\n          element.ansID = null;\n          element.html = null;\n          element.text = null;\n          setDataAnswer(_toConsumableArray(dataAnswer)); // Xử lí package\n\n          var indexQuestionDetail = packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList.findIndex(function (e) {\n            return e.ExerciseID === element.quesID;\n          });\n          indexQuestionDetail === -1 && (indexQuestionDetail = 0);\n          packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList = [];\n          getPackageResult(_objectSpread({}, packageResult));\n          return false;\n        }\n\n        return true;\n      });\n    });\n  }; // Allow Drop\n\n\n  var allowDrop = function allowDrop(ev) {\n    ev.preventDefault();\n  }; // On Drag\n\n\n  var drag = function drag(ev) {\n    ev.dataTransfer.setData('text', ev.target.id);\n  }; // -- ACTION DROP AND DRAG\n\n\n  useEffect(function () {\n    if (!doneTestData) {\n      if (isDoingTest) {\n        var el = document.querySelectorAll('.doingtest-group .drag-list .space-editor');\n        el.forEach(function (item) {\n          var quesID = parseInt(item.getAttribute('ques-id'));\n          dataAnswer.push({\n            quesID: quesID,\n            ansID: null,\n            html: null,\n            text: null\n          });\n          item.addEventListener('dragleave', function (event) {\n            item.classList.remove('space-left');\n            item.classList.remove('is-hover');\n          }); // ==================== DRAGOVER  ==============\n\n          item.addEventListener('dragover', function (event) {\n            var input = event.target;\n            event.preventDefault();\n            input.classList.add('is-hover'); // -- Đầy thành phần drop qua 1 bên khi có hành động drop khác\n\n            if (item.childNodes.length > 0) {\n              if (item.childNodes[0].nodeName === 'DIV') {\n                item.classList.add('space-left');\n              }\n            }\n          }); // ======================= DROP=========================\n\n          item.addEventListener('drop', function () {\n            var ev = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new CustomEvent(null, {\n              bubbles: true,\n              cancelable: true\n            });\n            // -- Thêm class auto và xóa khoảng cách sau khi đã drop xong\n            item.classList.add('auto');\n            item.classList.remove('space-left');\n            item.classList.remove('is-hover'); // Active input\n\n            getActiveID(parseInt(item.getAttribute('ques-id'))); // Đổi trạng thái để useeffect chứa active không chạy lại nữa\n\n            setIsDrop(true);\n\n            var actionDragAndDrop = function actionDragAndDrop() {\n              // -- Khởi tạo và xóa bên trong trước khi drop\n              var input = ev.target;\n              input.innerHTML = '';\n              ev.preventDefault();\n              var data = ev.dataTransfer.getData('text');\n              input.appendChild(document.getElementById(data)); // Kiểm tra sau khi drop thành công thì add vào mảng\n\n              if (input.childNodes[0].nodeName === 'DIV') {\n                var indexQues = dataAnswer.findIndex(function (item) {\n                  return item.quesID === quesID;\n                }); // -- Chặn drop thành phần bên trong\n\n                input.childNodes[0].addEventListener('drop', function (e) {\n                  e.preventDefault(), e.stopPropagation();\n                });\n                input.childNodes[0].addEventListener('dragstart', function () {\n                  var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new CustomEvent(null, {\n                    bubbles: true,\n                    cancelable: true\n                  });\n                  var inputChild = e.target;\n                  activeDrag = inputChild.id;\n                }); // -- Kiểm tra phần tử drop xuất phát từ vùng nào\n\n                if (dataAnswer.some(function (e) {\n                  return e['ansID'] === parseInt(input.children[0].id);\n                })) {\n                  var iQuestion = dataAnswer.findIndex(function (e) {\n                    return e.quesID === quesID;\n                  });\n                  dataAnswer.every(function (element) {\n                    if (element.ansID === parseInt(input.children[0].id)) {\n                      element.html = dataAnswer[iQuestion].html;\n                      element.ansID = dataAnswer[iQuestion].ansID;\n                      element.text = dataAnswer[iQuestion].text;\n                      return false;\n                    }\n\n                    return true;\n                  });\n                } else {\n                  // -- Thay thế cái mới và trả về vùng chứa câu trả lời\n                  if (dataAnswer[indexQues].html && dataAnswer[indexQues].ansID) {\n                    var getNodes = function getNodes(str) {\n                      return new DOMParser().parseFromString(str, 'text/html').body.childNodes;\n                    };\n\n                    var node = getNodes(dataAnswer[indexQues].html);\n                    document.getElementById('area-drop').appendChild(node[0]);\n                  }\n                } // -- Add phần tử mới vào mảng\n\n\n                dataAnswer[indexQues].ansID = parseInt(input.children[0].id);\n                dataAnswer[indexQues].html = input.innerHTML;\n                dataAnswer[indexQues].text = input.children[0].children[0].innerHTML;\n                setDataAnswer(_toConsumableArray(dataAnswer));\n              }\n            };\n\n            if (item.children.length == 0) {\n              actionDragAndDrop();\n            } else {\n              if (item.children[0].nodeName === 'TEXT') {\n                actionDragAndDrop();\n              } else {\n                if (item.children[0].id !== activeDrag) {\n                  actionDragAndDrop();\n                }\n              }\n            }\n          });\n        });\n        setDataAnswer(_toConsumableArray(dataAnswer));\n      }\n    }\n  }, []); // -- UPDATE AFTER DROP AND DRAG\n\n  useEffect(function () {\n    if (!doneTestData) {\n      if (isDoingTest) {\n        if ((dataAnswer === null || dataAnswer === void 0 ? void 0 : dataAnswer.length) > 0) {\n          var spaceEditor = document.querySelectorAll('.drag-list .space-editor');\n          var boxAns = document.querySelectorAll('.drag-list .drag-list-answer');\n          spaceEditor.forEach(function (item) {\n            var _dataAnswer$indexFind;\n\n            var quesID = parseInt(item.getAttribute('ques-id'));\n            var indexQuestionDetail = packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList.findIndex(function (e) {\n              return e.ExerciseID === quesID;\n            });\n            indexQuestionDetail === -1 && (indexQuestionDetail = 0); // --- Kiểm tra nếu có thành phần drop thì thêm class auto và ngược lại\n\n            if (item.childNodes.length > 0) {\n              if (item.childNodes[0].nodeName === 'DIV') {\n                item.classList.add('auto');\n              } else {\n                item.classList.remove('auto');\n              }\n            } else {\n              item.classList.remove('auto');\n            } // --- Sắp xếp lại  vị trí ---\n\n\n            var indexQues = null;\n\n            if (listQuestionID.includes(quesID)) {\n              indexQues = listQuestionID.indexOf(quesID);\n            } // --- --------------- ---\n\n\n            var indexFind = dataAnswer.findIndex(function (item) {\n              return item.quesID === quesID;\n            });\n            indexFind === -1 && (indexFind = 0);\n\n            if (((_dataAnswer$indexFind = dataAnswer[indexFind]) === null || _dataAnswer$indexFind === void 0 ? void 0 : _dataAnswer$indexFind.ansID) == null) {\n              if (packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList.length < 1) {\n                item.innerHTML = \"(\".concat((indexQues + 1).toString(), \")\");\n              }\n            } else {\n              if (item.childNodes.length == 0) {\n                var getNodes = function getNodes(str) {\n                  return new DOMParser().parseFromString(str, 'text/html').body.childNodes;\n                };\n\n                var node = getNodes(dataAnswer[indexFind].html);\n                item.appendChild(node[0]);\n                item.classList.add('auto');\n              }\n            }\n\n            var checkAndReplace = function checkAndReplace() {\n              dataAnswer.forEach(function (ans, index) {\n                if (quesID === ans.quesID) {\n                  if (ans.ansID !== null) {\n                    // -- TRẢ VỀ KQ CŨ\n                    var _getNodes = function _getNodes(str) {\n                      return new DOMParser().parseFromString(str, 'text/html').body.childNodes;\n                    };\n\n                    var _node = _getNodes(\"<div class=\\\"drag-list-answer\\\" draggable=\\\"true\\\" id=\\\"\".concat(ans.ansID, \"\\\"><span>\").concat(ans.text, \"</span></div>\"));\n\n                    item.innerHTML = '';\n                    item.appendChild(_node[0]);\n                    item.classList.add('auto');\n                  }\n                }\n              });\n            };\n\n            if (item.children.length == 0) {\n              checkAndReplace();\n            } else {\n              if (item.children[0].nodeName !== 'DIV') {\n                checkAndReplace();\n              }\n            }\n          });\n          boxAns.forEach(function (item) {\n            item.addEventListener('dragstart', function () {\n              var ev = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new CustomEvent(null, {\n                bubbles: true,\n                cancelable: true\n              });\n              ev.dataTransfer.setData('text', item.id);\n            }); // -- Chặn drop thành phần bên trong\n\n            item.addEventListener('drop', function (e) {\n              e.preventDefault(), e.stopPropagation();\n            });\n          }); // -- ADD VÀO MẢNG --\n\n          dataAnswer.forEach(function (item) {\n            if (item.ansID) {\n              var indexQuestionDetail = packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList.findIndex(function (e) {\n                return e.ExerciseID === item.quesID;\n              });\n              indexQuestionDetail === -1 && (indexQuestionDetail = 0); // Add new answer to list - Kiểm tra xem mảng có data chưa, nếu chưa thì thêm mới, ngược lại thì cập nhật object\n              // Đối với loại Điền từ thì mảng chỉ có 1 object đáp án\n\n              if (packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList.length == 0) {\n                packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList.push({\n                  AnswerID: item.ansID,\n                  AnswerContent: item.text,\n                  FileAudio: ''\n                });\n              } else {\n                packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList[0].AnswerContent = item.text;\n                packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList[0].AnswerID = item.ansID;\n              }\n\n              getListPicked(item.quesID);\n              getPackageResult(_objectSpread({}, packageResult));\n            } else {\n              removeListPicked(item.quesID);\n            }\n          });\n        }\n      }\n    }\n  }, [dataAnswer]); // Hiện lại những câu đã trả lời sau khi quay lai\n\n  useEffect(function () {\n    if (!doneTestData) {\n      if (isDoingTest && !isDrop) {\n        if (dataQuestion.Paragraph !== '') {\n          var spaceEditor = document.querySelectorAll('.drag-list .space-editor');\n          var dragAns = document.querySelectorAll('.drag-list #area-drop .drag-list-answer'); // -- Kiểm tra các ô drop\n\n          spaceEditor.forEach(function (item, index) {\n            var quesID = parseInt(item.getAttribute('ques-id'));\n\n            var checkAllElement = function checkAllElement() {\n              var indexQuestionDetail = packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList.findIndex(function (item) {\n                return item.ExerciseID === quesID;\n              });\n              indexQuestionDetail === -1 && (indexQuestionDetail = 0);\n              var indexDataAnswer = dataAnswer.findIndex(function (item) {\n                return item.quesID === quesID;\n              });\n\n              if (packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList.length > 0) {\n                var AnsIDPackage = null;\n                var AnsContentPackage = null;\n\n                if (dataAnswer[indexDataAnswer].ansID) {\n                  AnsIDPackage = dataAnswer[indexDataAnswer].ansID;\n                  AnsContentPackage = dataAnswer[indexDataAnswer].text;\n                } else {\n                  AnsIDPackage = packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList[0].AnswerID;\n                  AnsContentPackage = packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList[0].AnswerContent;\n                } // -- TRẢ VỀ KQ CŨ\n\n\n                var getNodes = function getNodes(str) {\n                  return new DOMParser().parseFromString(str, 'text/html').body.childNodes;\n                };\n\n                var node = getNodes(\"<div class=\\\"drag-list-answer\\\" draggable=\\\"true\\\" id=\\\"\".concat(AnsIDPackage, \"\\\"><span>\").concat(AnsContentPackage, \"</span></div>\"));\n                item.innerHTML = '';\n                item.appendChild(node[0]); // -- Cập nhật Data Answer\n\n                dataAnswer.every(function (element) {\n                  if (element.quesID === quesID) {\n                    element.ansID = AnsIDPackage;\n                    element.text = AnsContentPackage;\n                    element.html = \"<div class=\\\"drag-list-answer\\\" draggable=\\\"true\\\" id=\\\"\".concat(AnsIDPackage, \"\\\"><span>\").concat(AnsContentPackage, \"</span></div>\");\n                    return false;\n                  }\n\n                  return true;\n                });\n                setDataAnswer(_toConsumableArray(dataAnswer)); // -- XÓA TRONG AREA-DROP\n\n                dragAns.forEach(function (element) {\n                  if (parseInt(element.id) === AnsIDPackage) {\n                    element.remove();\n                  }\n                });\n              } // -- Reset data\n\n\n              setDataQuestionClone(_objectSpread({}, dataQuestionClone));\n              setChild(_objectSpread({}, dataQuestionClone));\n            };\n\n            if (item.children.length == 0) {\n              checkAllElement();\n            } else {\n              if (item.children[0].nodeName !== 'DIV') {\n                checkAllElement();\n              }\n            }\n          });\n        }\n      }\n    } else {\n      if (dataQuestion.Paragraph !== '') {\n        var _spaceEditor = document.querySelectorAll('.drag-list .space-editor');\n\n        _spaceEditor.forEach(function (item) {\n          item.setAttribute('contenteditable', 'false');\n          var quesID = parseInt(item.getAttribute('ques-id'));\n          dataQuestion.ExerciseTopic.every(function (ques) {\n            if (ques.ExerciseID === quesID) {\n              // Check this answer is right or wrong\n              if (ques.isTrue) {\n                item.classList.add('right-answer');\n              } else {\n                item.classList.add('wrong-answer');\n              } // Find answer content of user\n\n\n              if (ques.ExerciseAnswer.length > 0) {\n                var getNodes = function getNodes(str) {\n                  return new DOMParser().parseFromString(str, 'text/html').body.childNodes;\n                };\n\n                if (ques.ExerciseAnswer[0].AnswerContent && ques.ExerciseAnswer[0].AnswerContent !== '') {\n                  item.classList.add('auto');\n                  item.innerHTML = '';\n                  var nodeYourAns = getNodes(\"<div class=\\\"drag-list-answer\\\" id=\\\"\".concat(ques.ExerciseAnswer[0].AnswerID, \"\\\"><span>\").concat(ques.ExerciseAnswer[0].AnswerContent, \"</span></div>\"));\n                  item.appendChild(nodeYourAns[0]);\n                } // Tạo đáp án đúng để hover\n\n\n                var nodeCorrectAns = getNodes(\"<div class=\\\"tooltip-answer\\\" id=\\\"\".concat(quesID, \"\\\">\").concat(ques.ExerciseAnswer[0].ExerciseAnswerContent, \"</div>\"));\n                item.appendChild(nodeCorrectAns[0]);\n                listCorrectAnswer.push({\n                  id: ques.ExerciseAnswer[0].ExerciseAnswerID,\n                  content: ques.ExerciseAnswer[0].ExerciseAnswerContent\n                });\n                setListCorrectAnswer(_toConsumableArray(listCorrectAnswer));\n              }\n\n              return false;\n            }\n\n            return true;\n          });\n        });\n      }\n    }\n\n    if (doneTestData || isDoingTest) {\n      // -- Sắp xếp lại vị trí\n      var positionSpace = document.querySelectorAll('.position-space');\n      positionSpace.forEach(function (item) {\n        item.classList.remove('active');\n\n        if (parseInt(item.id) === activeID) {\n          item.classList.add('active');\n        }\n      });\n    }\n  }, [activeID]);\n  useEffect(function () {\n    if (doneTestData) {\n      if (listCorrectAnswer.length > 0) {\n        var spaceEditor = document.querySelectorAll('.test-wrapper .drag-list .space-editor');\n        var tooltipAns = document.querySelectorAll('.test-wrapper .drag-list .tooltip-answer');\n        spaceEditor.forEach(function (item) {\n          // Mouse over\n          item.addEventListener('mouseover', function () {\n            var quesID = item.getAttribute('ques-id');\n            tooltipAns.forEach(function (e) {\n              if (e.id === quesID) {\n                e.classList.remove('d-none');\n                e.classList.add('d-block');\n              }\n            });\n          }); // Mouse out\n\n          item.addEventListener('mouseout', function () {\n            var quesID = item.getAttribute('ques-id');\n            tooltipAns.forEach(function (e) {\n              if (e.id === quesID) {\n                e.classList.remove('d-block');\n                e.classList.add('d-none');\n              }\n            });\n          });\n        });\n      }\n    }\n  }, [listCorrectAnswer]);\n\n  var convertHTML = function convertHTML() {\n    if ((dataQuestion === null || dataQuestion === void 0 ? void 0 : dataQuestion.ExerciseTopic.length) > 0) {\n      var cloneValueEditor = dataQuestion.Paragraph;\n      var divCont = document.createElement('DIV');\n      divCont.innerHTML = cloneValueEditor;\n      var inputNodeList = divCont.querySelectorAll('input');\n\n      if (inputNodeList.length > 0) {\n        dataQuestion.ExerciseTopic.forEach(function (item, index) {\n          var newItem = document.createElement('DIV');\n          newItem.className = inputNodeList[index].className;\n          inputNodeList[index].parentNode.replaceChild(newItem, inputNodeList[index]);\n          newItem.setAttribute('ques-id', \"\".concat(item.ExerciseID));\n        });\n      }\n\n      return divCont.innerHTML;\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"drag-list\",\n    style: {\n      height: '100%',\n      marginLeft: !!isTeach ? 0 : -40\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"wrap-drag\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"main-drag test-body\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"\",\n          children: ReactHtmlParser(dataQuestion.Content)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 6\n        }, _this), /*#__PURE__*/_jsxDEV(\"h6\", {\n          className: \"font-italic mb-3 mt-4\",\n          children: \"K\\xE9o \\u0111\\xE1p \\xE1n v\\xE0o \\xF4 th\\xEDch h\\u1EE3p\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 6\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-lg-6 col-md-12 col-sm-12 col-12\",\n          style: {},\n          children: ReactHtmlParser(convertHTML())\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 6\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 521,\n        columnNumber: 5\n      }, _this), !openPagi && !isTeach && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed-ans\",\n        style: {\n          marginBottom: !!isTeach ? 70 : 0\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"answerlist\",\n          id: \"area-drop\",\n          onDrop: function onDrop(e) {\n            return drop(e);\n          },\n          onDragOver: function onDragOver(e) {\n            return allowDrop(e);\n          },\n          children: dataQuestionClone === null || dataQuestionClone === void 0 ? void 0 : dataQuestionClone.ExerciseTopic.map(function (item, index) {\n            return item.ExerciseAnswer.map(function (ans, indexAns) {\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"drag-list-answer\",\n                draggable: \"true\",\n                onDrop: function onDrop(e) {\n                  return e.preventDefault(), e.stopPropagation();\n                },\n                onDragStart: function onDragStart(e) {\n                  return drag(e);\n                },\n                id: ans.ID,\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: ans.AnswerContent\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 541,\n                  columnNumber: 11\n                }, _this)\n              }, indexAns, false, {\n                fileName: _jsxFileName,\n                lineNumber: 533,\n                columnNumber: 10\n              }, _this);\n            });\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 7\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 529,\n        columnNumber: 6\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 520,\n      columnNumber: 4\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 519,\n    columnNumber: 3\n  }, _this);\n};\n\n_s(DragList, \"jO8nFSqMvkg3z4iPBs7aWe63ZBg=\", false, function () {\n  return [useDoingTest, useDoneTest];\n});\n\n_c = DragList;\nexport default DragList;\n\nvar _c;\n\n$RefreshReg$(_c, \"DragList\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/ExamList/ExamShow/DragList.tsx"],"names":["React","useState","useEffect","useDoingTest","ReactHtmlParser","useDoneTest","activeDrag","DragList","props","activeID","getActiveID","packageResult","getPackageResult","getListPicked","removeListPicked","dataQuestion","listQuestionID","isDoingTest","setChild","openPagi","isTeach","doneTestData","dataQuestionClone","setDataQuestionClone","dataAnswer","setDataAnswer","listCorrectAnswer","setListCorrectAnswer","isDrop","setIsDrop","indexQuestion","SetPackageResultDetailInfoList","findIndex","item","ExamTopicDetailID","ID","Paragraph","spaceEditor","document","querySelectorAll","length","forEach","index","quesID","parseInt","getAttribute","indexQues","includes","indexOf","positionSpace","span","createElement","classList","add","id","toString","append","innerHTML","before","drop","ev","preventDefault","data","dataTransfer","getData","target","appendChild","getElementById","nodeList","childNodes","every","element","ansID","html","text","indexQuestionDetail","SetPackageExerciseStudentInfoList","e","ExerciseID","SetPackageExerciseAnswerStudentList","allowDrop","drag","setData","el","push","addEventListener","event","remove","input","nodeName","CustomEvent","bubbles","cancelable","actionDragAndDrop","stopPropagation","inputChild","some","children","iQuestion","getNodes","str","DOMParser","parseFromString","body","node","boxAns","indexFind","checkAndReplace","ans","AnswerID","AnswerContent","FileAudio","dragAns","checkAllElement","indexDataAnswer","AnsIDPackage","AnsContentPackage","setAttribute","ExerciseTopic","ques","isTrue","ExerciseAnswer","nodeYourAns","nodeCorrectAns","ExerciseAnswerContent","ExerciseAnswerID","content","tooltipAns","convertHTML","cloneValueEditor","divCont","inputNodeList","newItem","className","parentNode","replaceChild","height","marginLeft","Content","marginBottom","map","indexAns"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { useDoingTest } from '~/context/useDoingTest'\r\nimport ReactHtmlParser from 'react-html-parser'\r\nimport { useDoneTest } from '~/context/useDoneTest'\r\n\r\nlet activeDrag = null\r\n\r\nconst DragList = (props: any) => {\r\n\tconst { activeID, getActiveID, packageResult, getPackageResult, getListPicked, removeListPicked } = useDoingTest()\r\n\tconst { dataQuestion, listQuestionID, isDoingTest, setChild, openPagi, isTeach } = props\r\n\tconst { doneTestData } = useDoneTest()\r\n\tconst [dataQuestionClone, setDataQuestionClone] = useState(dataQuestion)\r\n\tconst [dataAnswer, setDataAnswer] = useState([])\r\n\tconst [listCorrectAnswer, setListCorrectAnswer] = useState([])\r\n\tconst [isDrop, setIsDrop] = useState(false)\r\n\r\n\tif (isDoingTest) {\r\n\t\tvar indexQuestion: any = packageResult.SetPackageResultDetailInfoList.findIndex(\r\n\t\t\t(item: any) => item.ExamTopicDetailID === dataQuestion.ID\r\n\t\t)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (dataQuestion.Paragraph !== '') {\r\n\t\t\tlet spaceEditor: any = document.querySelectorAll('.drag-list .space-editor')\r\n\t\t\tif (spaceEditor && spaceEditor.length > 0) {\r\n\t\t\t\tspaceEditor.forEach((item: any, index: any) => {\r\n\t\t\t\t\tlet quesID: any = parseInt(item.getAttribute('ques-id'))\r\n\t\t\t\t\t// Sắp xếp lại thứ tự các ô input trong đoạn văn\r\n\t\t\t\t\tlet indexQues: any = null\r\n\t\t\t\t\tif (listQuestionID.includes(quesID)) {\r\n\t\t\t\t\t\tindexQues = listQuestionID.indexOf(quesID)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (indexQues !== null) {\r\n\t\t\t\t\t\tlet positionSpace: any = document.querySelectorAll('.drag-list .position-space')\r\n\t\t\t\t\t\tif (positionSpace.length < spaceEditor.length) {\r\n\t\t\t\t\t\t\tlet span: any = document.createElement('span')\r\n\t\t\t\t\t\t\tspan.classList.add('position-space')\r\n\t\t\t\t\t\t\tspan.id = quesID.toString()\r\n\t\t\t\t\t\t\tif (quesID === activeID) {\r\n\t\t\t\t\t\t\t\tspan.classList.add('active')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tspan.append(`(${indexQues + 1})`)\r\n\t\t\t\t\t\t\titem.innerHTML = `${(indexQues + 1).toString()}`\r\n\t\t\t\t\t\t\titem.before(span)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (item.innerHTML == '') {\r\n\t\t\t\t\t\t\t\titem.innerHTML = `${(indexQues + 1).toString()}`\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}, [listQuestionID, dataAnswer])\r\n\r\n\t// ---- ALL ACTION IN DOING TEST ----\r\n\r\n\t// On Drop\r\n\tconst drop = (ev: any) => {\r\n\t\tev.preventDefault()\r\n\t\tvar data: any = ev.dataTransfer.getData('text')\r\n\t\tdata && ev.target.appendChild(document.getElementById(data))\r\n\t\tlet nodeList: any = [...ev.target.childNodes]\r\n\t\tnodeList.forEach((item: any) => {\r\n\t\t\tdataAnswer.every((element: any) => {\r\n\t\t\t\tif (element.ansID === parseInt(item.id)) {\r\n\t\t\t\t\t// Xử lí mảng dataAnswer\r\n\t\t\t\t\telement.ansID = null\r\n\t\t\t\t\telement.html = null\r\n\t\t\t\t\telement.text = null\r\n\t\t\t\t\tsetDataAnswer([...dataAnswer])\r\n\t\t\t\t\t// Xử lí package\r\n\t\t\t\t\tlet indexQuestionDetail: any = packageResult.SetPackageResultDetailInfoList[\r\n\t\t\t\t\t\tindexQuestion\r\n\t\t\t\t\t].SetPackageExerciseStudentInfoList.findIndex((e: any) => e.ExerciseID === element.quesID)\r\n\t\t\t\t\tindexQuestionDetail === -1 && (indexQuestionDetail = 0)\r\n\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[\r\n\t\t\t\t\t\tindexQuestionDetail\r\n\t\t\t\t\t].SetPackageExerciseAnswerStudentList = []\r\n\t\t\t\t\tgetPackageResult({ ...packageResult })\r\n\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\treturn true\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\t// Allow Drop\r\n\tconst allowDrop = (ev: any) => {\r\n\t\tev.preventDefault()\r\n\t}\r\n\r\n\t// On Drag\r\n\tconst drag = (ev: any) => {\r\n\t\tev.dataTransfer.setData('text', ev.target.id)\r\n\t}\r\n\r\n\t// -- ACTION DROP AND DRAG\r\n\tuseEffect(() => {\r\n\t\tif (!doneTestData) {\r\n\t\t\tif (isDoingTest) {\r\n\t\t\t\tlet el: any = document.querySelectorAll('.doingtest-group .drag-list .space-editor')\r\n\t\t\t\tel.forEach((item) => {\r\n\t\t\t\t\tconst quesID: any = parseInt(item.getAttribute('ques-id'))\r\n\t\t\t\t\tdataAnswer.push({ quesID: quesID, ansID: null, html: null, text: null })\r\n\t\t\t\t\titem.addEventListener('dragleave', (event: any) => {\r\n\t\t\t\t\t\titem.classList.remove('space-left')\r\n\t\t\t\t\t\titem.classList.remove('is-hover')\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// ==================== DRAGOVER  ==============\r\n\t\t\t\t\titem.addEventListener('dragover', (event: any) => {\r\n\t\t\t\t\t\tconst input: any = event.target as HTMLElement\r\n\t\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\t\tinput.classList.add('is-hover')\r\n\t\t\t\t\t\t// -- Đầy thành phần drop qua 1 bên khi có hành động drop khác\r\n\t\t\t\t\t\tif (item.childNodes.length > 0) {\r\n\t\t\t\t\t\t\tif (item.childNodes[0].nodeName === 'DIV') {\r\n\t\t\t\t\t\t\t\titem.classList.add('space-left')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// ======================= DROP=========================\r\n\t\t\t\t\titem.addEventListener(\r\n\t\t\t\t\t\t'drop',\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\tev: CustomEvent & {\r\n\t\t\t\t\t\t\t\tdataTransfer?: DataTransfer\r\n\t\t\t\t\t\t\t} = new CustomEvent(null, { bubbles: true, cancelable: true })\r\n\t\t\t\t\t\t) => {\r\n\t\t\t\t\t\t\t// -- Thêm class auto và xóa khoảng cách sau khi đã drop xong\r\n\t\t\t\t\t\t\titem.classList.add('auto')\r\n\t\t\t\t\t\t\titem.classList.remove('space-left')\r\n\t\t\t\t\t\t\titem.classList.remove('is-hover')\r\n\t\t\t\t\t\t\t// Active input\r\n\t\t\t\t\t\t\tgetActiveID(parseInt(item.getAttribute('ques-id')))\r\n\t\t\t\t\t\t\t// Đổi trạng thái để useeffect chứa active không chạy lại nữa\r\n\t\t\t\t\t\t\tsetIsDrop(true)\r\n\r\n\t\t\t\t\t\t\tconst actionDragAndDrop = () => {\r\n\t\t\t\t\t\t\t\t// -- Khởi tạo và xóa bên trong trước khi drop\r\n\t\t\t\t\t\t\t\tconst input: any = ev.target as HTMLElement\r\n\t\t\t\t\t\t\t\tinput.innerHTML = ''\r\n\t\t\t\t\t\t\t\tev.preventDefault()\r\n\t\t\t\t\t\t\t\tvar data: any = ev.dataTransfer.getData('text')\r\n\r\n\t\t\t\t\t\t\t\tinput.appendChild(document.getElementById(data))\r\n\t\t\t\t\t\t\t\t// Kiểm tra sau khi drop thành công thì add vào mảng\r\n\t\t\t\t\t\t\t\tif (input.childNodes[0].nodeName === 'DIV') {\r\n\t\t\t\t\t\t\t\t\tlet indexQues: any = dataAnswer.findIndex((item) => item.quesID === quesID)\r\n\t\t\t\t\t\t\t\t\t// -- Chặn drop thành phần bên trong\r\n\t\t\t\t\t\t\t\t\tinput.childNodes[0].addEventListener('drop', (e) => {\r\n\t\t\t\t\t\t\t\t\t\te.preventDefault(), e.stopPropagation()\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tinput.childNodes[0].addEventListener(\r\n\t\t\t\t\t\t\t\t\t\t'dragstart',\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\te: CustomEvent & {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdataTransfer?: DataTransfer\r\n\t\t\t\t\t\t\t\t\t\t\t} = new CustomEvent(null, {\r\n\t\t\t\t\t\t\t\t\t\t\t\tbubbles: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcancelable: true\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst inputChild: any = e.target as HTMLElement\r\n\t\t\t\t\t\t\t\t\t\t\tactiveDrag = inputChild.id\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t// -- Kiểm tra phần tử drop xuất phát từ vùng nào\r\n\t\t\t\t\t\t\t\t\tif (dataAnswer.some((e: any) => e['ansID'] === parseInt(input.children[0].id))) {\r\n\t\t\t\t\t\t\t\t\t\tlet iQuestion: any = dataAnswer.findIndex((e: any) => e.quesID === quesID)\r\n\t\t\t\t\t\t\t\t\t\tdataAnswer.every((element) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (element.ansID === parseInt(input.children[0].id)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\telement.html = dataAnswer[iQuestion].html\r\n\t\t\t\t\t\t\t\t\t\t\t\telement.ansID = dataAnswer[iQuestion].ansID\r\n\t\t\t\t\t\t\t\t\t\t\t\telement.text = dataAnswer[iQuestion].text\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t// -- Thay thế cái mới và trả về vùng chứa câu trả lời\r\n\t\t\t\t\t\t\t\t\t\tif (dataAnswer[indexQues].html && dataAnswer[indexQues].ansID) {\r\n\t\t\t\t\t\t\t\t\t\t\tlet getNodes: any = (str: any) => new DOMParser().parseFromString(str, 'text/html').body.childNodes\r\n\t\t\t\t\t\t\t\t\t\t\tlet node: any = getNodes(dataAnswer[indexQues].html)\r\n\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('area-drop').appendChild(node[0])\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t// -- Add phần tử mới vào mảng\r\n\t\t\t\t\t\t\t\t\tdataAnswer[indexQues].ansID = parseInt(input.children[0].id)\r\n\t\t\t\t\t\t\t\t\tdataAnswer[indexQues].html = input.innerHTML\r\n\t\t\t\t\t\t\t\t\tdataAnswer[indexQues].text = input.children[0].children[0].innerHTML\r\n\t\t\t\t\t\t\t\t\tsetDataAnswer([...dataAnswer])\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (item.children.length == 0) {\r\n\t\t\t\t\t\t\t\tactionDragAndDrop()\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (item.children[0].nodeName === 'TEXT') {\r\n\t\t\t\t\t\t\t\t\tactionDragAndDrop()\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (item.children[0].id !== activeDrag) {\r\n\t\t\t\t\t\t\t\t\t\tactionDragAndDrop()\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)\r\n\t\t\t\t})\r\n\t\t\t\tsetDataAnswer([...dataAnswer])\r\n\t\t\t}\r\n\t\t}\r\n\t}, [])\r\n\r\n\t// -- UPDATE AFTER DROP AND DRAG\r\n\tuseEffect(() => {\r\n\t\tif (!doneTestData) {\r\n\t\t\tif (isDoingTest) {\r\n\t\t\t\tif (dataAnswer?.length > 0) {\r\n\t\t\t\t\tlet spaceEditor: any = document.querySelectorAll('.drag-list .space-editor')\r\n\t\t\t\t\tlet boxAns: any = document.querySelectorAll('.drag-list .drag-list-answer')\r\n\t\t\t\t\tspaceEditor.forEach((item: any) => {\r\n\t\t\t\t\t\tconst quesID: any = parseInt(item.getAttribute('ques-id'))\r\n\t\t\t\t\t\tlet indexQuestionDetail: any = packageResult.SetPackageResultDetailInfoList[\r\n\t\t\t\t\t\t\tindexQuestion\r\n\t\t\t\t\t\t].SetPackageExerciseStudentInfoList.findIndex((e: any) => e.ExerciseID === quesID)\r\n\t\t\t\t\t\tindexQuestionDetail === -1 && (indexQuestionDetail = 0)\r\n\t\t\t\t\t\t// --- Kiểm tra nếu có thành phần drop thì thêm class auto và ngược lại\r\n\t\t\t\t\t\tif (item.childNodes.length > 0) {\r\n\t\t\t\t\t\t\tif (item.childNodes[0].nodeName === 'DIV') {\r\n\t\t\t\t\t\t\t\titem.classList.add('auto')\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\titem.classList.remove('auto')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\titem.classList.remove('auto')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// --- Sắp xếp lại  vị trí ---\r\n\t\t\t\t\t\tlet indexQues: any = null\r\n\t\t\t\t\t\tif (listQuestionID.includes(quesID)) {\r\n\t\t\t\t\t\t\tindexQues = listQuestionID.indexOf(quesID)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// --- --------------- ---\r\n\t\t\t\t\t\tlet indexFind: any = dataAnswer.findIndex((item: any) => item.quesID === quesID)\r\n\t\t\t\t\t\tindexFind === -1 && (indexFind = 0)\r\n\t\t\t\t\t\tif (dataAnswer[indexFind]?.ansID == null) {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail]\r\n\t\t\t\t\t\t\t\t\t.SetPackageExerciseAnswerStudentList.length < 1\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\titem.innerHTML = `(${(indexQues + 1).toString()})`\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (item.childNodes.length == 0) {\r\n\t\t\t\t\t\t\t\tlet getNodes = (str: any) => new DOMParser().parseFromString(str, 'text/html').body.childNodes\r\n\t\t\t\t\t\t\t\tlet node: any = getNodes(dataAnswer[indexFind].html)\r\n\t\t\t\t\t\t\t\titem.appendChild(node[0])\r\n\t\t\t\t\t\t\t\titem.classList.add('auto')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst checkAndReplace = () => {\r\n\t\t\t\t\t\t\tdataAnswer.forEach((ans: any, index: any) => {\r\n\t\t\t\t\t\t\t\tif (quesID === ans.quesID) {\r\n\t\t\t\t\t\t\t\t\tif (ans.ansID !== null) {\r\n\t\t\t\t\t\t\t\t\t\t// -- TRẢ VỀ KQ CŨ\r\n\t\t\t\t\t\t\t\t\t\tlet getNodes = (str: any) => new DOMParser().parseFromString(str, 'text/html').body.childNodes\r\n\t\t\t\t\t\t\t\t\t\tlet node: any = getNodes(\r\n\t\t\t\t\t\t\t\t\t\t\t`<div class=\"drag-list-answer\" draggable=\"true\" id=\"${ans.ansID}\"><span>${ans.text}</span></div>`\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\titem.innerHTML = ''\r\n\t\t\t\t\t\t\t\t\t\titem.appendChild(node[0])\r\n\t\t\t\t\t\t\t\t\t\titem.classList.add('auto')\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (item.children.length == 0) {\r\n\t\t\t\t\t\t\tcheckAndReplace()\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (item.children[0].nodeName !== 'DIV') {\r\n\t\t\t\t\t\t\t\tcheckAndReplace()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tboxAns.forEach((item: any) => {\r\n\t\t\t\t\t\titem.addEventListener(\r\n\t\t\t\t\t\t\t'dragstart',\r\n\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\tev: CustomEvent & {\r\n\t\t\t\t\t\t\t\t\tdataTransfer?: DataTransfer\r\n\t\t\t\t\t\t\t\t} = new CustomEvent(null, { bubbles: true, cancelable: true })\r\n\t\t\t\t\t\t\t) => {\r\n\t\t\t\t\t\t\t\tev.dataTransfer.setData('text', item.id)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t// -- Chặn drop thành phần bên trong\r\n\t\t\t\t\t\titem.addEventListener('drop', (e: any) => {\r\n\t\t\t\t\t\t\te.preventDefault(), e.stopPropagation()\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// -- ADD VÀO MẢNG --\r\n\t\t\t\t\tdataAnswer.forEach((item: any) => {\r\n\t\t\t\t\t\tif (item.ansID) {\r\n\t\t\t\t\t\t\tlet indexQuestionDetail = packageResult.SetPackageResultDetailInfoList[\r\n\t\t\t\t\t\t\t\tindexQuestion\r\n\t\t\t\t\t\t\t].SetPackageExerciseStudentInfoList.findIndex((e: any) => e.ExerciseID === item.quesID)\r\n\t\t\t\t\t\t\tindexQuestionDetail === -1 && (indexQuestionDetail = 0)\r\n\t\t\t\t\t\t\t// Add new answer to list - Kiểm tra xem mảng có data chưa, nếu chưa thì thêm mới, ngược lại thì cập nhật object\r\n\t\t\t\t\t\t\t// Đối với loại Điền từ thì mảng chỉ có 1 object đáp án\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail]\r\n\t\t\t\t\t\t\t\t\t.SetPackageExerciseAnswerStudentList.length == 0\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[\r\n\t\t\t\t\t\t\t\t\tindexQuestionDetail\r\n\t\t\t\t\t\t\t\t].SetPackageExerciseAnswerStudentList.push({\r\n\t\t\t\t\t\t\t\t\tAnswerID: item.ansID,\r\n\t\t\t\t\t\t\t\t\tAnswerContent: item.text,\r\n\t\t\t\t\t\t\t\t\tFileAudio: ''\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[\r\n\t\t\t\t\t\t\t\t\tindexQuestionDetail\r\n\t\t\t\t\t\t\t\t].SetPackageExerciseAnswerStudentList[0].AnswerContent = item.text\r\n\t\t\t\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[\r\n\t\t\t\t\t\t\t\t\tindexQuestionDetail\r\n\t\t\t\t\t\t\t\t].SetPackageExerciseAnswerStudentList[0].AnswerID = item.ansID\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgetListPicked(item.quesID)\r\n\t\t\t\t\t\t\tgetPackageResult({ ...packageResult })\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tremoveListPicked(item.quesID)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}, [dataAnswer])\r\n\r\n\t// Hiện lại những câu đã trả lời sau khi quay lai\r\n\tuseEffect(() => {\r\n\t\tif (!doneTestData) {\r\n\t\t\tif (isDoingTest && !isDrop) {\r\n\t\t\t\tif (dataQuestion.Paragraph !== '') {\r\n\t\t\t\t\tlet spaceEditor: any = document.querySelectorAll('.drag-list .space-editor')\r\n\t\t\t\t\tlet dragAns: any = document.querySelectorAll('.drag-list #area-drop .drag-list-answer')\r\n\t\t\t\t\t// -- Kiểm tra các ô drop\r\n\t\t\t\t\tspaceEditor.forEach((item: any, index: any) => {\r\n\t\t\t\t\t\tlet quesID: any = parseInt(item.getAttribute('ques-id'))\r\n\t\t\t\t\t\tconst checkAllElement = () => {\r\n\t\t\t\t\t\t\tlet indexQuestionDetail: any = packageResult.SetPackageResultDetailInfoList[\r\n\t\t\t\t\t\t\t\tindexQuestion\r\n\t\t\t\t\t\t\t].SetPackageExerciseStudentInfoList.findIndex((item) => item.ExerciseID === quesID)\r\n\t\t\t\t\t\t\tindexQuestionDetail === -1 && (indexQuestionDetail = 0)\r\n\t\t\t\t\t\t\tlet indexDataAnswer: any = dataAnswer.findIndex((item) => item.quesID === quesID)\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail]\r\n\t\t\t\t\t\t\t\t\t.SetPackageExerciseAnswerStudentList.length > 0\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tlet AnsIDPackage: any = null\r\n\t\t\t\t\t\t\t\tlet AnsContentPackage: any = null\r\n\r\n\t\t\t\t\t\t\t\tif (dataAnswer[indexDataAnswer].ansID) {\r\n\t\t\t\t\t\t\t\t\tAnsIDPackage = dataAnswer[indexDataAnswer].ansID\r\n\t\t\t\t\t\t\t\t\tAnsContentPackage = dataAnswer[indexDataAnswer].text\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tAnsIDPackage =\r\n\t\t\t\t\t\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail]\r\n\t\t\t\t\t\t\t\t\t\t\t.SetPackageExerciseAnswerStudentList[0].AnswerID\r\n\t\t\t\t\t\t\t\t\tAnsContentPackage =\r\n\t\t\t\t\t\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail]\r\n\t\t\t\t\t\t\t\t\t\t\t.SetPackageExerciseAnswerStudentList[0].AnswerContent\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// -- TRẢ VỀ KQ CŨ\r\n\t\t\t\t\t\t\t\tlet getNodes = (str: any) => new DOMParser().parseFromString(str, 'text/html').body.childNodes\r\n\t\t\t\t\t\t\t\tlet node: any = getNodes(\r\n\t\t\t\t\t\t\t\t\t`<div class=\"drag-list-answer\" draggable=\"true\" id=\"${AnsIDPackage}\"><span>${AnsContentPackage}</span></div>`\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\titem.innerHTML = ''\r\n\t\t\t\t\t\t\t\titem.appendChild(node[0])\r\n\t\t\t\t\t\t\t\t// -- Cập nhật Data Answer\r\n\t\t\t\t\t\t\t\tdataAnswer.every((element: any) => {\r\n\t\t\t\t\t\t\t\t\tif (element.quesID === quesID) {\r\n\t\t\t\t\t\t\t\t\t\telement.ansID = AnsIDPackage\r\n\t\t\t\t\t\t\t\t\t\telement.text = AnsContentPackage\r\n\t\t\t\t\t\t\t\t\t\telement.html = `<div class=\"drag-list-answer\" draggable=\"true\" id=\"${AnsIDPackage}\"><span>${AnsContentPackage}</span></div>`\r\n\t\t\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tsetDataAnswer([...dataAnswer])\r\n\t\t\t\t\t\t\t\t// -- XÓA TRONG AREA-DROP\r\n\t\t\t\t\t\t\t\tdragAns.forEach((element: any) => {\r\n\t\t\t\t\t\t\t\t\tif (parseInt(element.id) === AnsIDPackage) {\r\n\t\t\t\t\t\t\t\t\t\telement.remove()\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// -- Reset data\r\n\t\t\t\t\t\t\tsetDataQuestionClone({ ...dataQuestionClone })\r\n\t\t\t\t\t\t\tsetChild({ ...dataQuestionClone })\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (item.children.length == 0) {\r\n\t\t\t\t\t\t\tcheckAllElement()\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (item.children[0].nodeName !== 'DIV') {\r\n\t\t\t\t\t\t\t\tcheckAllElement()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (dataQuestion.Paragraph !== '') {\r\n\t\t\t\tlet spaceEditor: any = document.querySelectorAll('.drag-list .space-editor')\r\n\t\t\t\tspaceEditor.forEach((item: any) => {\r\n\t\t\t\t\titem.setAttribute('contenteditable', 'false')\r\n\t\t\t\t\tlet quesID: any = parseInt(item.getAttribute('ques-id'))\r\n\t\t\t\t\tdataQuestion.ExerciseTopic.every((ques) => {\r\n\t\t\t\t\t\tif (ques.ExerciseID === quesID) {\r\n\t\t\t\t\t\t\t// Check this answer is right or wrong\r\n\t\t\t\t\t\t\tif (ques.isTrue) {\r\n\t\t\t\t\t\t\t\titem.classList.add('right-answer')\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\titem.classList.add('wrong-answer')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// Find answer content of user\r\n\t\t\t\t\t\t\tif (ques.ExerciseAnswer.length > 0) {\r\n\t\t\t\t\t\t\t\tlet getNodes = (str: any) => new DOMParser().parseFromString(str, 'text/html').body.childNodes\r\n\t\t\t\t\t\t\t\tif (ques.ExerciseAnswer[0].AnswerContent && ques.ExerciseAnswer[0].AnswerContent !== '') {\r\n\t\t\t\t\t\t\t\t\titem.classList.add('auto')\r\n\t\t\t\t\t\t\t\t\titem.innerHTML = ''\r\n\t\t\t\t\t\t\t\t\tlet nodeYourAns: any = getNodes(\r\n\t\t\t\t\t\t\t\t\t\t`<div class=\"drag-list-answer\" id=\"${ques.ExerciseAnswer[0].AnswerID}\"><span>${ques.ExerciseAnswer[0].AnswerContent}</span></div>`\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\titem.appendChild(nodeYourAns[0])\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// Tạo đáp án đúng để hover\r\n\t\t\t\t\t\t\t\tlet nodeCorrectAns: any = getNodes(\r\n\t\t\t\t\t\t\t\t\t`<div class=\"tooltip-answer\" id=\"${quesID}\">${ques.ExerciseAnswer[0].ExerciseAnswerContent}</div>`\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\titem.appendChild(nodeCorrectAns[0])\r\n\t\t\t\t\t\t\t\tlistCorrectAnswer.push({\r\n\t\t\t\t\t\t\t\t\tid: ques.ExerciseAnswer[0].ExerciseAnswerID,\r\n\t\t\t\t\t\t\t\t\tcontent: ques.ExerciseAnswer[0].ExerciseAnswerContent\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tsetListCorrectAnswer([...listCorrectAnswer])\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (doneTestData || isDoingTest) {\r\n\t\t\t// -- Sắp xếp lại vị trí\r\n\t\t\tlet positionSpace: any = document.querySelectorAll('.position-space')\r\n\t\t\tpositionSpace.forEach((item: any) => {\r\n\t\t\t\titem.classList.remove('active')\r\n\t\t\t\tif (parseInt(item.id) === activeID) {\r\n\t\t\t\t\titem.classList.add('active')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}, [activeID])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (doneTestData) {\r\n\t\t\tif (listCorrectAnswer.length > 0) {\r\n\t\t\t\tlet spaceEditor = document.querySelectorAll('.test-wrapper .drag-list .space-editor')\r\n\t\t\t\tlet tooltipAns = document.querySelectorAll('.test-wrapper .drag-list .tooltip-answer')\r\n\t\t\t\tspaceEditor.forEach((item: any) => {\r\n\t\t\t\t\t// Mouse over\r\n\t\t\t\t\titem.addEventListener('mouseover', () => {\r\n\t\t\t\t\t\tlet quesID = item.getAttribute('ques-id')\r\n\t\t\t\t\t\ttooltipAns.forEach((e) => {\r\n\t\t\t\t\t\t\tif (e.id === quesID) {\r\n\t\t\t\t\t\t\t\te.classList.remove('d-none')\r\n\t\t\t\t\t\t\t\te.classList.add('d-block')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// Mouse out\r\n\t\t\t\t\titem.addEventListener('mouseout', () => {\r\n\t\t\t\t\t\tlet quesID = item.getAttribute('ques-id')\r\n\t\t\t\t\t\ttooltipAns.forEach((e) => {\r\n\t\t\t\t\t\t\tif (e.id === quesID) {\r\n\t\t\t\t\t\t\t\te.classList.remove('d-block')\r\n\t\t\t\t\t\t\t\te.classList.add('d-none')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}, [listCorrectAnswer])\r\n\tconst convertHTML = () => {\r\n\t\tif (dataQuestion?.ExerciseTopic.length > 0) {\r\n\t\t\tlet cloneValueEditor = dataQuestion.Paragraph\r\n\t\t\tconst divCont = document.createElement('DIV')\r\n\t\t\tdivCont.innerHTML = cloneValueEditor\r\n\t\t\tconst inputNodeList = divCont.querySelectorAll('input')\r\n\t\t\tif (inputNodeList.length > 0) {\r\n\t\t\t\tdataQuestion.ExerciseTopic.forEach((item: any, index: any) => {\r\n\t\t\t\t\tconst newItem = document.createElement('DIV')\r\n\t\t\t\t\tnewItem.className = inputNodeList[index].className\r\n\t\t\t\t\tinputNodeList[index].parentNode.replaceChild(newItem, inputNodeList[index])\r\n\t\t\t\t\tnewItem.setAttribute('ques-id', `${item.ExerciseID}`)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\treturn divCont.innerHTML\r\n\t\t}\r\n\t}\r\n\treturn (\r\n\t\t<div className=\"drag-list\" style={{ height: '100%', marginLeft: !!isTeach ? 0 : -40 }}>\r\n\t\t\t<div className=\"wrap-drag\">\r\n\t\t\t\t<div className=\"main-drag test-body\">\r\n\t\t\t\t\t<div className=\"\">{ReactHtmlParser(dataQuestion.Content)}</div>\r\n\t\t\t\t\t<h6 className=\"font-italic mb-3 mt-4\">Kéo đáp án vào ô thích hợp</h6>\r\n\t\t\t\t\t<div className=\"col-lg-6 col-md-12 col-sm-12 col-12\" style={{}}>\r\n\t\t\t\t\t\t{ReactHtmlParser(convertHTML())}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t{!openPagi && !isTeach && (\r\n\t\t\t\t\t<div className=\"fixed-ans\" style={{ marginBottom: !!isTeach ? 70 : 0 }}>\r\n\t\t\t\t\t\t<div className=\"answerlist\" id=\"area-drop\" onDrop={(e: any) => drop(e)} onDragOver={(e) => allowDrop(e)}>\r\n\t\t\t\t\t\t\t{dataQuestionClone?.ExerciseTopic.map((item: any, index: any) =>\r\n\t\t\t\t\t\t\t\titem.ExerciseAnswer.map((ans: any, indexAns: any) => (\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"drag-list-answer\"\r\n\t\t\t\t\t\t\t\t\t\tkey={indexAns}\r\n\t\t\t\t\t\t\t\t\t\tdraggable=\"true\"\r\n\t\t\t\t\t\t\t\t\t\tonDrop={(e: any) => (e.preventDefault(), e.stopPropagation())}\r\n\t\t\t\t\t\t\t\t\t\tonDragStart={(e: any) => drag(e)}\r\n\t\t\t\t\t\t\t\t\t\tid={ans.ID}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<span>{ans.AnswerContent}</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default DragList\r\n"]},"metadata":{},"sourceType":"module"}