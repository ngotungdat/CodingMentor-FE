{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _slicedToArray from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\context\\\\wrap.tsx\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { createContext, useState, useContext, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { CheckCircleOutlined, WarningOutlined } from '@ant-design/icons';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { oneSignalAPI, userApi, userInformationApi } from '~/apiBase';\nimport { useSession } from 'next-auth/client';\nimport OneSignal from 'react-onesignal';\nvar WrapContext = /*#__PURE__*/createContext({\n  titlePage: '',\n  getRouter: '',\n  getTitlePage: function getTitlePage() {},\n  showNoti: function showNoti() {},\n  getDataUser: function getDataUser() {},\n  userInformation: null,\n  useAllRoles: null,\n  useStaffRoles: null,\n  pageSize: 30,\n  isAdmin: false,\n  reloadNotification: false,\n  handleReloadNoti: Function,\n  reloadCart: false,\n  handleReloadCart: Function\n}); // const initialState = {\n//   noti: \"\",\n// };\n// function reducer() {}\n\nexport var WrapProvider = function WrapProvider(_ref) {\n  _s();\n\n  var children = _ref.children;\n  // Get path and slug\n  var router = useRouter();\n  var slug = router.query.slug;\n  var path = router.pathname;\n  var pathString = path.split('/'); // ---- //\n\n  var _useSession = useSession(),\n      _useSession2 = _slicedToArray(_useSession, 2),\n      session = _useSession2[0],\n      loading = _useSession2[1];\n\n  var _useState = useState(''),\n      titlePage = _useState[0],\n      setTitlePage = _useState[1];\n\n  var getRouter = router.pathname;\n\n  var _useState2 = useState({\n    content: '',\n    type: ''\n  }),\n      typeNoti = _useState2[0],\n      setTypeNoti = _useState2[1];\n\n  var _useState3 = useState(null),\n      userInfo = _useState3[0],\n      setUserInfo = _useState3[1];\n\n  var _useState4 = useState(null),\n      roles = _useState4[0],\n      setRoles = _useState4[1];\n\n  var _useState5 = useState(null),\n      staffRoles = _useState5[0],\n      setStaffRoles = _useState5[1];\n\n  var _useState6 = useState(false),\n      isAdmin = _useState6[0],\n      setIsAdmin = _useState6[1];\n\n  var _useState7 = useState(false),\n      reloadNotification = _useState7[0],\n      setReloadNotification = _useState7[1];\n\n  var _useState8 = useState(false),\n      reloadCart = _useState8[0],\n      setReloadCart = _useState8[1]; // --- Get Title Page ---\n\n\n  var getTitlePage = function getTitlePage(title) {\n    setTitlePage(title);\n  }; // --- Show Notification ---\n\n\n  var showNoti = function showNoti(type, content) {\n    var nodeNoti = function nodeNoti() {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"noti-box\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"noti-box__content\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"icon\",\n            children: type == 'danger' ? /*#__PURE__*/_jsxDEV(WarningOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 50\n            }, _this) : type == 'success' && /*#__PURE__*/_jsxDEV(CheckCircleOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 93\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 7\n          }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text\",\n            children: content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 7\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 6\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 5\n      }, _this);\n    };\n\n    switch (type) {\n      case 'success':\n        toast.success(nodeNoti);\n        break;\n\n      case 'danger':\n        toast.error(nodeNoti);\n        break;\n\n      case 'warning':\n        toast.warning(nodeNoti);\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  var getRoles = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(roleType) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return userInformationApi.getRole(roleType);\n\n            case 3:\n              res = _context.sent;\n              // @ts-ignore\n              res.status == 200 && roleType == 0 ? setRoles(res.data.data) : setStaffRoles(res.data.data);\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log('Lỗi lấy thông tin roles: ', _context.t0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n\n    return function getRoles(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(); // --- Get Data User ---\n\n\n  var getDataUser = function getDataUser(data) {\n    data && setUserInfo(data);\n  }; // --- Check is Admin ---\n\n\n  var checkIsAdmin = function checkIsAdmin(data) {\n    var role = data.RoleID;\n\n    if (role == 1 || role == 5) {\n      setIsAdmin(true);\n    }\n  }; // --- Get New Data Use ---\n\n\n  var getNewDataUser = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return userApi.getNew();\n\n            case 3:\n              res = _context2.sent;\n              res.status == 200 && (setUserInfo(res.data.data), checkIsAdmin(res.data.data));\n              _context2.next = 10;\n              break;\n\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log('Lỗi lấy thông tin user: ', _context2.t0);\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 7]]);\n    }));\n\n    return function getNewDataUser() {\n      return _ref3.apply(this, arguments);\n    };\n  }(); // --- Handle Reload Notification ---\n\n\n  var handleReloadNoti = function handleReloadNoti() {\n    setReloadNotification(!reloadNotification);\n  }; // --- Handle Reload Card ---\n\n\n  var handleReloadCart = function handleReloadCart() {\n    setReloadCart(!reloadCart);\n  };\n\n  var postOnesignalID = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var userId, res;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return OneSignal.getUserId();\n\n            case 3:\n              userId = _context3.sent;\n              _context3.next = 6;\n              return oneSignalAPI.update(userId);\n\n            case 6:\n              res = _context3.sent;\n              _context3.next = 12;\n              break;\n\n            case 9:\n              _context3.prev = 9;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.log('Lỗi lấy thông tin user: ', _context3.t0);\n\n            case 12:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 9]]);\n    }));\n\n    return function postOnesignalID() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    // console.log('Session: ', session);\n    if (loading && typeof session !== 'undefined' && session !== null) {\n      if (path.search('signin') < 1) {\n        getNewDataUser();\n        getRoles(0);\n        getRoles(1);\n        postOnesignalID();\n      }\n    }\n  }, [session]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(WrapContext.Provider, {\n      value: {\n        pageSize: 30,\n        titlePage: titlePage,\n        getTitlePage: getTitlePage,\n        getRouter: getRouter,\n        showNoti: showNoti,\n        getDataUser: getDataUser,\n        userInformation: userInfo,\n        useAllRoles: roles,\n        useStaffRoles: staffRoles,\n        isAdmin: isAdmin,\n        reloadNotification: reloadNotification,\n        handleReloadNoti: handleReloadNoti,\n        reloadCart: reloadCart,\n        handleReloadCart: handleReloadCart\n      },\n      children: [/*#__PURE__*/_jsxDEV(ToastContainer, {\n        position: \"top-right\",\n        autoClose: 3000,\n        hideProgressBar: false,\n        newestOnTop: false,\n        closeOnClick: true,\n        rtl: false,\n        pauseOnFocusLoss: true,\n        draggable: true,\n        pauseOnHover: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 5\n      }, _this), children]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 4\n    }, _this)\n  }, void 0, false);\n};\n\n_s(WrapProvider, \"50/hOE9b/5Nn7eEajHPitZpGMWo=\", false, function () {\n  return [useRouter, useSession];\n});\n\n_c = WrapProvider;\nexport var useWrap = function useWrap() {\n  _s2();\n\n  return useContext(WrapContext);\n};\n\n_s2(useWrap, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"WrapProvider\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/context/wrap.tsx"],"names":["React","createContext","useState","useContext","useEffect","useRouter","CheckCircleOutlined","WarningOutlined","ToastContainer","toast","oneSignalAPI","userApi","userInformationApi","useSession","OneSignal","WrapContext","titlePage","getRouter","getTitlePage","showNoti","getDataUser","userInformation","useAllRoles","useStaffRoles","pageSize","isAdmin","reloadNotification","handleReloadNoti","Function","reloadCart","handleReloadCart","WrapProvider","children","router","slug","query","path","pathname","pathString","split","session","loading","setTitlePage","content","type","typeNoti","setTypeNoti","userInfo","setUserInfo","roles","setRoles","staffRoles","setStaffRoles","setIsAdmin","setReloadNotification","setReloadCart","title","nodeNoti","success","error","warning","getRoles","roleType","getRole","res","status","data","console","log","checkIsAdmin","role","RoleID","getNewDataUser","getNew","postOnesignalID","getUserId","userId","update","search","useWrap"],"mappings":"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","sourcesContent":["import React, { createContext, useState, useContext, useEffect, useReducer } from 'react'\r\nimport { useRouter } from 'next/router'\r\nimport { CheckCircleOutlined, WarningOutlined } from '@ant-design/icons'\r\nimport { ToastContainer, toast } from 'react-toastify'\r\nimport 'react-toastify/dist/ReactToastify.css'\r\nimport { oneSignalAPI, userApi, userInformationApi } from '~/apiBase'\r\nimport { signIn, useSession } from 'next-auth/client'\r\nimport OneSignal from 'react-onesignal'\r\n\r\nexport type IProps = {\r\n\ttitlePage: string\r\n\tgetRouter: any\r\n\tgetTitlePage: Function\r\n\tshowNoti: Function\r\n\tgetDataUser: Function\r\n\tuserInformation: IUser\r\n\tuseAllRoles: IRole[]\r\n\tuseStaffRoles: IRole[]\r\n\tpageSize: number\r\n\tisAdmin: boolean\r\n\treloadNotification: boolean\r\n\thandleReloadNoti: Function\r\n\treloadCart: boolean\r\n\thandleReloadCart: Function\r\n}\r\n\r\nconst WrapContext = createContext<IProps>({\r\n\ttitlePage: '',\r\n\tgetRouter: '',\r\n\tgetTitlePage: () => {},\r\n\tshowNoti: () => {},\r\n\tgetDataUser: () => {},\r\n\tuserInformation: null,\r\n\tuseAllRoles: null,\r\n\tuseStaffRoles: null,\r\n\tpageSize: 30,\r\n\tisAdmin: false,\r\n\treloadNotification: false,\r\n\thandleReloadNoti: Function,\r\n\treloadCart: false,\r\n\thandleReloadCart: Function\r\n})\r\n\r\n// const initialState = {\r\n//   noti: \"\",\r\n// };\r\n\r\n// function reducer() {}\r\n\r\nexport const WrapProvider = ({ children }) => {\r\n\t// Get path and slug\r\n\tconst router = useRouter()\r\n\tconst slug = router.query.slug\r\n\tlet path: string = router.pathname\r\n\tlet pathString: string[] = path.split('/')\r\n\t// ---- //\r\n\tconst [session, loading] = useSession()\r\n\tconst [titlePage, setTitlePage] = useState('')\r\n\r\n\tconst getRouter = router.pathname\r\n\tconst [typeNoti, setTypeNoti] = useState({\r\n\t\tcontent: '',\r\n\t\ttype: ''\r\n\t})\r\n\tconst [userInfo, setUserInfo] = useState<IUser>(null)\r\n\tconst [roles, setRoles] = useState<IRole[]>(null)\r\n\tconst [staffRoles, setStaffRoles] = useState<IRole[]>(null)\r\n\tconst [isAdmin, setIsAdmin] = useState(false)\r\n\tconst [reloadNotification, setReloadNotification] = useState(false)\r\n\tconst [reloadCart, setReloadCart] = useState(false)\r\n\r\n\t// --- Get Title Page ---\r\n\tconst getTitlePage = (title) => {\r\n\t\tsetTitlePage(title)\r\n\t}\r\n\r\n\t// --- Show Notification ---\r\n\tconst showNoti = (type: string, content: string) => {\r\n\t\tconst nodeNoti = () => {\r\n\t\t\treturn (\r\n\t\t\t\t<div className={`noti-box`}>\r\n\t\t\t\t\t<div className=\"noti-box__content\">\r\n\t\t\t\t\t\t<span className=\"icon\">{type == 'danger' ? <WarningOutlined /> : type == 'success' && <CheckCircleOutlined />}</span>\r\n\t\t\t\t\t\t<span className=\"text\">{content}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase 'success':\r\n\t\t\t\ttoast.success(nodeNoti)\r\n\t\t\t\tbreak\r\n\t\t\tcase 'danger':\r\n\t\t\t\ttoast.error(nodeNoti)\r\n\t\t\t\tbreak\r\n\t\t\tcase 'warning':\r\n\t\t\t\ttoast.warning(nodeNoti)\r\n\t\t\t\tbreak\r\n\t\t\tdefault:\r\n\t\t\t\tbreak\r\n\t\t}\r\n\t}\r\n\r\n\tconst getRoles = async (roleType) => {\r\n\t\ttry {\r\n\t\t\tlet res = await userInformationApi.getRole(roleType)\r\n\t\t\t// @ts-ignore\r\n\t\t\tres.status == 200 && roleType == 0 ? setRoles(res.data.data) : setStaffRoles(res.data.data)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('Lỗi lấy thông tin roles: ', error)\r\n\t\t}\r\n\t}\r\n\r\n\t// --- Get Data User ---\r\n\tconst getDataUser = (data) => {\r\n\t\tdata && setUserInfo(data)\r\n\t}\r\n\r\n\t// --- Check is Admin ---\r\n\tconst checkIsAdmin = (data) => {\r\n\t\tlet role = data.RoleID\r\n\t\tif (role == 1 || role == 5) {\r\n\t\t\tsetIsAdmin(true)\r\n\t\t}\r\n\t}\r\n\r\n\t// --- Get New Data Use ---\r\n\tconst getNewDataUser = async () => {\r\n\t\ttry {\r\n\t\t\tlet res = await userApi.getNew()\r\n\r\n\t\t\tres.status == 200 && (setUserInfo(res.data.data), checkIsAdmin(res.data.data))\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('Lỗi lấy thông tin user: ', error)\r\n\t\t}\r\n\t}\r\n\r\n\t// --- Handle Reload Notification ---\r\n\tconst handleReloadNoti = () => {\r\n\t\tsetReloadNotification(!reloadNotification)\r\n\t}\r\n\r\n\t// --- Handle Reload Card ---\r\n\tconst handleReloadCart = () => {\r\n\t\tsetReloadCart(!reloadCart)\r\n\t}\r\n\r\n\tconst postOnesignalID = async () => {\r\n\t\ttry {\r\n\t\t\tconst userId = await OneSignal.getUserId()\r\n\t\t\tlet res = await oneSignalAPI.update(userId)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('Lỗi lấy thông tin user: ', error)\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\t// console.log('Session: ', session);\r\n\r\n\t\tif (loading && typeof session !== 'undefined' && session !== null) {\r\n\t\t\tif (path.search('signin') < 1) {\r\n\t\t\t\tgetNewDataUser()\r\n\t\t\t\tgetRoles(0)\r\n\t\t\t\tgetRoles(1)\r\n\t\t\t\tpostOnesignalID()\r\n\t\t\t}\r\n\t\t}\r\n\t}, [session])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<WrapContext.Provider\r\n\t\t\t\tvalue={{\r\n\t\t\t\t\tpageSize: 30,\r\n\t\t\t\t\ttitlePage: titlePage,\r\n\t\t\t\t\tgetTitlePage,\r\n\t\t\t\t\tgetRouter,\r\n\t\t\t\t\tshowNoti,\r\n\t\t\t\t\tgetDataUser,\r\n\t\t\t\t\tuserInformation: userInfo,\r\n\t\t\t\t\tuseAllRoles: roles,\r\n\t\t\t\t\tuseStaffRoles: staffRoles,\r\n\t\t\t\t\tisAdmin: isAdmin,\r\n\t\t\t\t\treloadNotification: reloadNotification,\r\n\t\t\t\t\thandleReloadNoti: handleReloadNoti,\r\n\t\t\t\t\treloadCart: reloadCart,\r\n\t\t\t\t\thandleReloadCart: handleReloadCart\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<ToastContainer\r\n\t\t\t\t\tposition=\"top-right\"\r\n\t\t\t\t\tautoClose={3000}\r\n\t\t\t\t\thideProgressBar={false}\r\n\t\t\t\t\tnewestOnTop={false}\r\n\t\t\t\t\tcloseOnClick\r\n\t\t\t\t\trtl={false}\r\n\t\t\t\t\tpauseOnFocusLoss\r\n\t\t\t\t\tdraggable\r\n\t\t\t\t\tpauseOnHover\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{children}\r\n\t\t\t</WrapContext.Provider>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport const useWrap = () => useContext(WrapContext)\r\n"]},"metadata":{},"sourceType":"module"}