{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\ExamList\\\\ExamShow\\\\WrittingList.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState } from 'react';\nimport ReactHtmlParser from 'react-html-parser';\nimport { Modal, Tooltip, Popconfirm } from 'antd';\nimport { Trash2 } from 'react-feather';\nimport { examDetailApi } from '~/apiBase';\nimport { useExamDetail } from '~/pages/question-bank/exam-list/exam-detail/[slug]';\nimport { useWrap } from '~/context/wrap';\nimport EditPoint from '../ExamForm/EditPoint';\nimport ChangePosition from '../ExamForm/ChangePosition';\nimport { useDoingTest } from '~/context/useDoingTest';\nimport { useDoneTest } from '~/context/useDoneTest';\nimport EditorSimple from '~/components/Elements/EditorSimple';\nimport MarkingExam from '../MarkingExam/MarkingExam'; // ---- COMPONENT CHILDREN ----\n\nconst WrittingModal = props => {\n  const {\n    onGetDataEditor,\n    contentOfStudent\n  } = props;\n  const {\n    0: isModalVisible,\n    1: setIsModalVisible\n  } = useState(false);\n  const {\n    0: contentEditor,\n    1: setContentEditor\n  } = useState(null);\n  const {\n    0: isModalConfirm,\n    1: setIsModalConfirm\n  } = useState(false);\n  const {\n    0: isReset,\n    1: setIsReset\n  } = useState(false);\n\n  const showModal = () => {\n    setIsModalVisible(true);\n    setIsReset(false);\n\n    if (!contentOfStudent) {\n      setIsReset(true);\n      setTimeout(() => {\n        setIsReset(false);\n      }, 200);\n    }\n  };\n\n  const handleOk = () => {\n    setIsModalVisible(false);\n    onGetDataEditor(contentEditor);\n  };\n\n  const handleCancel = () => {\n    if (contentOfStudent !== contentEditor) {\n      setIsModalConfirm(true);\n    } else {\n      setIsModalVisible(false);\n    }\n  };\n\n  const handleGetDataEditor = value => {\n    setContentEditor(value);\n  };\n\n  useEffect(() => {\n    setContentEditor(contentOfStudent);\n  }, [contentOfStudent]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-warning\",\n      onClick: showModal,\n      children: !contentOfStudent ? 'Làm bài tự luận' : 'Làm lại'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      className: \"modal-writting\",\n      width: 700,\n      title: \"Form vi\\u1EBFt b\\xE0i t\\u1EF1 lu\\u1EADn\",\n      cancelText: \"H\\u1EE7y\",\n      okText: \"L\\u01B0u\",\n      visible: isModalVisible,\n      onOk: handleOk,\n      onCancel: handleCancel,\n      children: isModalVisible && /*#__PURE__*/_jsxDEV(EditorSimple, {\n        isTranslate: false,\n        handleChange: value => handleGetDataEditor(value),\n        isReset: isReset,\n        questionContent: contentEditor\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"Ch\\xFA \\xFD\",\n      visible: isModalConfirm,\n      onOk: () => (setIsModalConfirm(false), setIsModalVisible(false)),\n      onCancel: () => setIsModalConfirm(false),\n      cancelText: \"\\u0110\\xF3ng\",\n      okText: \"OK\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          fontWeight: 500\n        },\n        children: \"B\\xE0i vi\\u1EBFt c\\u1EE7a b\\u1EA1n ch\\u01B0a \\u0111\\u01B0\\u1EE3c l\\u01B0u. B\\u1EA1n c\\xF3 mu\\u1ED1n tho\\xE1t kh\\u1ECFi form n\\xE0y?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n}; // ---- COMPONENT PARENT ----\n\n\nconst WrittingList = props => {\n  const {\n    doneTestData,\n    dataMarking,\n    getDataMarking\n  } = useDoneTest();\n  const {\n    onDeleteQuestion,\n    isChangePosition\n  } = useExamDetail();\n  const {\n    activeID,\n    packageResult,\n    getPackageResult,\n    getListPicked\n  } = useDoingTest();\n  const {\n    dataQuestion,\n    listQuestionID,\n    isDoingTest,\n    isMarked,\n    hideScore,\n    arPosition,\n    handleChange,\n    addOldItem\n  } = props;\n  const {\n    showNoti\n  } = useWrap();\n  const {\n    0: contentOfStudent,\n    1: setContentOfStudent\n  } = useState('');\n  const {\n    0: confirmLoading,\n    1: setConfirmLoading\n  } = useState(false);\n  const {\n    0: visible,\n    1: setVisible\n  } = useState({\n    id: null,\n    status: false\n  });\n\n  const returnPosition = quesID => {\n    let index = listQuestionID.indexOf(quesID);\n    let text = 'Câu ' + (index + 1).toString();\n    return text;\n  }; // Chấp nhận xóa câu hỏi\n\n\n  const handleOk = async quesItem => {\n    let itemDelete = {\n      ID: dataQuestion.ID,\n      Enable: false,\n      ExerciseOrExerciseGroup: [{\n        Point: quesItem.Point,\n        ExerciseOrExerciseGroupID: quesItem.ExerciseID\n      }]\n    };\n    setConfirmLoading(true);\n\n    try {\n      let res = await examDetailApi.update(itemDelete);\n\n      if (res.status == 200) {\n        onDeleteQuestion(itemDelete);\n        showNoti('success', 'Xóa thành công');\n      }\n    } catch (error) {\n      showNoti('danger', error.message);\n    } finally {\n      setConfirmLoading(false);\n    }\n  }; // Handle cancel popup delte\n\n\n  const handleCancel = quesID => {\n    setVisible({\n      id: quesID,\n      status: false\n    });\n  };\n\n  const deleteQuestionItem = quesID => {\n    !visible.status ? setVisible({\n      id: quesID,\n      status: true\n    }) : setVisible({\n      id: quesID,\n      status: false\n    });\n  };\n\n  const onGetPoint = (point, questionID) => {\n    if (dataMarking.setPackageExerciseStudentsList.some((item, index) => item['ID'] === questionID)) {\n      dataMarking.setPackageExerciseStudentsList.every(item => {\n        if (item.ID === questionID) {\n          item.Point = point;\n          return false;\n        }\n\n        return true;\n      });\n    } else {\n      dataMarking.setPackageExerciseStudentsList.push({\n        ID: questionID,\n        Point: point\n      });\n    }\n\n    getDataMarking(_objectSpread({}, dataMarking));\n  }; // ----------- ALL ACTION IN DOINGTEST -------------\n\n\n  const onGetDataEditor = (dataAns, quesID) => {\n    getListPicked(quesID);\n    setContentOfStudent(dataAns); // Find index\n\n    let indexQuestion = packageResult.SetPackageResultDetailInfoList.findIndex(item => item.ExamTopicDetailID === dataQuestion.ID);\n    let indexQuestionDetail = packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList.findIndex(item => item.ExerciseID === quesID); // Add new answer to list\n\n    if (packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList.length == 0) {\n      packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList.push({\n        AnswerID: 0,\n        AnswerContent: dataAns,\n        FileAudio: ''\n      });\n    } else {\n      packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail].SetPackageExerciseAnswerStudentList[0].AnswerContent = dataAns;\n    }\n\n    getPackageResult(_objectSpread({}, packageResult));\n  };\n\n  useEffect(() => {\n    if (!doneTestData) {\n      if (isDoingTest) {\n        // Find index\n        let indexQuestion = packageResult.SetPackageResultDetailInfoList.findIndex(item => item.ExamTopicDetailID === dataQuestion.ID);\n\n        if (packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[0].SetPackageExerciseAnswerStudentList.length > 0) {\n          setContentOfStudent(packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[0].SetPackageExerciseAnswerStudentList[0].AnswerContent);\n        }\n      }\n    } else {\n      if (dataQuestion.ExerciseTopic[0].ExerciseAnswer.length > 0) {\n        setContentOfStudent(dataQuestion.ExerciseTopic[0].ExerciseAnswer[0].AnswerContent);\n      }\n    }\n  }, [activeID]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: dataQuestion.ExerciseTopic.map((ques, ind) => {\n      var _dataMarking$setPacka;\n\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `question-item typing ${ques.ExerciseID === activeID ? 'active-doing' : ''}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"box-detail\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"box-title\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: `title-ques`,\n              children: returnPosition(ques.ExerciseID)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"title-text mt-3\",\n              children: ReactHtmlParser(ques.Content)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"box-doing-wrting mt-3\",\n              children: [contentOfStudent ? /*#__PURE__*/_jsxDEV(\"h6\", {\n                className: \"text-underline mb-2\",\n                children: /*#__PURE__*/_jsxDEV(\"u\", {\n                  children: \"B\\xE0i vi\\u1EBFt \\u0111\\xE3 l\\xE0m\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 11\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 10\n              }, this) : isDoingTest && /*#__PURE__*/_jsxDEV(\"h6\", {\n                className: \"text-underline\",\n                children: \"B\\u1EA5m v\\xE0o n\\xFAt b\\xEAn d\\u01B0\\u1EDBi \\u0111\\u1EC3 l\\xE0m b\\xE0i t\\u1EF1 lu\\u1EADn\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"content-of-student\",\n                children: ReactHtmlParser(contentOfStudent)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 10\n              }, this), !doneTestData && isDoingTest && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"writting-editor mt-2\",\n                children: /*#__PURE__*/_jsxDEV(WrittingModal, {\n                  contentOfStudent: contentOfStudent,\n                  onGetDataEditor: content => onGetDataEditor(content, ques.ExerciseID)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 11\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 10\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"box-action\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"box-action-list mb-2\",\n            children: !doneTestData && !isDoingTest && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [!isChangePosition && /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(EditPoint, {\n                  quesItem: ques,\n                  dataQuestion: dataQuestion\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 262,\n                  columnNumber: 12\n                }, this), /*#__PURE__*/_jsxDEV(Popconfirm, {\n                  title: \"B\\u1EA1n c\\xF3 ch\\u1EAFc mu\\u1ED1n x\\xF3a?\",\n                  onConfirm: () => handleOk(ques),\n                  okButtonProps: {\n                    loading: confirmLoading\n                  },\n                  onCancel: () => handleCancel(ques.ID),\n                  children: /*#__PURE__*/_jsxDEV(Tooltip, {\n                    title: \"X\\xF3a c\\xE2u h\\u1ECFi\",\n                    placement: \"rightTop\",\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"btn btn-icon delete\",\n                      onClick: () => deleteQuestionItem(ques.ID),\n                      children: /*#__PURE__*/_jsxDEV(Trash2, {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 271,\n                        columnNumber: 15\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 270,\n                      columnNumber: 14\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 269,\n                    columnNumber: 13\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 263,\n                  columnNumber: 12\n                }, this)]\n              }, void 0, true), /*#__PURE__*/_jsxDEV(ChangePosition, {\n                dataQuestion: dataQuestion,\n                arPosition: arPosition,\n                questionID: dataQuestion.ID,\n                handleChange: handleChange,\n                addOldItem: addOldItem\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 10\n              }, this)]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 7\n          }, this), hideScore == true ? /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"point-question\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text mb-2\",\n              children: !dataMarking ? ques === null || ques === void 0 ? void 0 : ques.Point : (_dataMarking$setPacka = dataMarking.setPackageExerciseStudentsList.find(item => item['ID'] === ques.ID)) === null || _dataMarking$setPacka === void 0 ? void 0 : _dataMarking$setPacka.Point\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 8\n          }, this), dataMarking && !isMarked && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"point-marking\",\n            children: /*#__PURE__*/_jsxDEV(MarkingExam, {\n              onGetPoint: point => onGetPoint(point, ques.ID),\n              dataRow: ques,\n              dataMarking: dataMarking\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 8\n          }, this), dataMarking && (ques === null || ques === void 0 ? void 0 : ques.Point) !== undefined && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"point-show mt-3\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mb-0\",\n              children: [\"\\u0110i\\u1EC3m: \", ques === null || ques === void 0 ? void 0 : ques.Point]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 8\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 6\n        }, this)]\n      }, ind, true, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 5\n      }, this);\n    })\n  }, void 0, false);\n};\n\nexport default WrittingList;","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/ExamList/ExamShow/WrittingList.tsx"],"names":["React","useEffect","useState","ReactHtmlParser","Modal","Tooltip","Popconfirm","Trash2","examDetailApi","useExamDetail","useWrap","EditPoint","ChangePosition","useDoingTest","useDoneTest","EditorSimple","MarkingExam","WrittingModal","props","onGetDataEditor","contentOfStudent","isModalVisible","setIsModalVisible","contentEditor","setContentEditor","isModalConfirm","setIsModalConfirm","isReset","setIsReset","showModal","setTimeout","handleOk","handleCancel","handleGetDataEditor","value","fontWeight","WrittingList","doneTestData","dataMarking","getDataMarking","onDeleteQuestion","isChangePosition","activeID","packageResult","getPackageResult","getListPicked","dataQuestion","listQuestionID","isDoingTest","isMarked","hideScore","arPosition","handleChange","addOldItem","showNoti","setContentOfStudent","confirmLoading","setConfirmLoading","visible","setVisible","id","status","returnPosition","quesID","index","indexOf","text","toString","quesItem","itemDelete","ID","Enable","ExerciseOrExerciseGroup","Point","ExerciseOrExerciseGroupID","ExerciseID","res","update","error","message","deleteQuestionItem","onGetPoint","point","questionID","setPackageExerciseStudentsList","some","item","every","push","dataAns","indexQuestion","SetPackageResultDetailInfoList","findIndex","ExamTopicDetailID","indexQuestionDetail","SetPackageExerciseStudentInfoList","SetPackageExerciseAnswerStudentList","length","AnswerID","AnswerContent","FileAudio","ExerciseTopic","ExerciseAnswer","map","ques","ind","Content","content","loading","find","undefined"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport ReactHtmlParser from 'react-html-parser'\r\nimport { Modal, Tooltip, Popconfirm } from 'antd'\r\nimport { Trash2 } from 'react-feather'\r\nimport { examDetailApi } from '~/apiBase'\r\nimport { useExamDetail } from '~/pages/question-bank/exam-list/exam-detail/[slug]'\r\nimport { useWrap } from '~/context/wrap'\r\nimport EditPoint from '../ExamForm/EditPoint'\r\nimport ChangePosition from '../ExamForm/ChangePosition'\r\nimport { useDoingTest } from '~/context/useDoingTest'\r\nimport { useDoneTest } from '~/context/useDoneTest'\r\nimport EditorSimple from '~/components/Elements/EditorSimple'\r\nimport MarkingExam from '../MarkingExam/MarkingExam'\r\n\r\n// ---- COMPONENT CHILDREN ----\r\nconst WrittingModal = (props) => {\r\n\tconst { onGetDataEditor, contentOfStudent } = props\r\n\tconst [isModalVisible, setIsModalVisible] = useState(false)\r\n\tconst [contentEditor, setContentEditor] = useState(null)\r\n\tconst [isModalConfirm, setIsModalConfirm] = useState(false)\r\n\tconst [isReset, setIsReset] = useState(false)\r\n\r\n\tconst showModal = () => {\r\n\t\tsetIsModalVisible(true)\r\n\t\tsetIsReset(false)\r\n\t\tif (!contentOfStudent) {\r\n\t\t\tsetIsReset(true)\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tsetIsReset(false)\r\n\t\t\t}, 200)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleOk = () => {\r\n\t\tsetIsModalVisible(false)\r\n\t\tonGetDataEditor(contentEditor)\r\n\t}\r\n\r\n\tconst handleCancel = () => {\r\n\t\tif (contentOfStudent !== contentEditor) {\r\n\t\t\tsetIsModalConfirm(true)\r\n\t\t} else {\r\n\t\t\tsetIsModalVisible(false)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleGetDataEditor = (value) => {\r\n\t\tsetContentEditor(value)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tsetContentEditor(contentOfStudent)\r\n\t}, [contentOfStudent])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<button className=\"btn btn-warning\" onClick={showModal}>\r\n\t\t\t\t{!contentOfStudent ? 'Làm bài tự luận' : 'Làm lại'}\r\n\t\t\t</button>\r\n\t\t\t<Modal\r\n\t\t\t\tclassName=\"modal-writting\"\r\n\t\t\t\twidth={700}\r\n\t\t\t\ttitle=\"Form viết bài tự luận\"\r\n\t\t\t\tcancelText=\"Hủy\"\r\n\t\t\t\tokText=\"Lưu\"\r\n\t\t\t\tvisible={isModalVisible}\r\n\t\t\t\tonOk={handleOk}\r\n\t\t\t\tonCancel={handleCancel}\r\n\t\t\t>\r\n\t\t\t\t{isModalVisible && (\r\n\t\t\t\t\t<EditorSimple\r\n\t\t\t\t\t\tisTranslate={false}\r\n\t\t\t\t\t\thandleChange={(value) => handleGetDataEditor(value)}\r\n\t\t\t\t\t\tisReset={isReset}\r\n\t\t\t\t\t\tquestionContent={contentEditor}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\t\t\t</Modal>\r\n\t\t\t<Modal\r\n\t\t\t\ttitle=\"Chú ý\"\r\n\t\t\t\tvisible={isModalConfirm}\r\n\t\t\t\tonOk={() => (setIsModalConfirm(false), setIsModalVisible(false))}\r\n\t\t\t\tonCancel={() => setIsModalConfirm(false)}\r\n\t\t\t\tcancelText=\"Đóng\"\r\n\t\t\t\tokText=\"OK\"\r\n\t\t\t>\r\n\t\t\t\t<p style={{ fontWeight: 500 }}>Bài viết của bạn chưa được lưu. Bạn có muốn thoát khỏi form này?</p>\r\n\t\t\t</Modal>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\n// ---- COMPONENT PARENT ----\r\nconst WrittingList = (props) => {\r\n\tconst { doneTestData, dataMarking, getDataMarking } = useDoneTest()\r\n\tconst { onDeleteQuestion, isChangePosition } = useExamDetail()\r\n\tconst { activeID, packageResult, getPackageResult, getListPicked } = useDoingTest()\r\n\tconst { dataQuestion, listQuestionID, isDoingTest, isMarked, hideScore, arPosition, handleChange, addOldItem } = props\r\n\tconst { showNoti } = useWrap()\r\n\tconst [contentOfStudent, setContentOfStudent] = useState('')\r\n\tconst [confirmLoading, setConfirmLoading] = useState(false)\r\n\tconst [visible, setVisible] = useState({\r\n\t\tid: null,\r\n\t\tstatus: false\r\n\t})\r\n\r\n\tconst returnPosition = (quesID) => {\r\n\t\tlet index = listQuestionID.indexOf(quesID)\r\n\t\tlet text = 'Câu ' + (index + 1).toString()\r\n\t\treturn text\r\n\t}\r\n\r\n\t// Chấp nhận xóa câu hỏi\r\n\tconst handleOk = async (quesItem) => {\r\n\t\tlet itemDelete = {\r\n\t\t\tID: dataQuestion.ID,\r\n\t\t\tEnable: false,\r\n\t\t\tExerciseOrExerciseGroup: [\r\n\t\t\t\t{\r\n\t\t\t\t\tPoint: quesItem.Point,\r\n\t\t\t\t\tExerciseOrExerciseGroupID: quesItem.ExerciseID\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t\tsetConfirmLoading(true)\r\n\t\ttry {\r\n\t\t\tlet res = await examDetailApi.update(itemDelete)\r\n\t\t\tif (res.status == 200) {\r\n\t\t\t\tonDeleteQuestion(itemDelete)\r\n\t\t\t\tshowNoti('success', 'Xóa thành công')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetConfirmLoading(false)\r\n\t\t}\r\n\t}\r\n\r\n\t// Handle cancel popup delte\r\n\tconst handleCancel = (quesID) => {\r\n\t\tsetVisible({\r\n\t\t\tid: quesID,\r\n\t\t\tstatus: false\r\n\t\t})\r\n\t}\r\n\r\n\tconst deleteQuestionItem = (quesID) => {\r\n\t\t!visible.status\r\n\t\t\t? setVisible({\r\n\t\t\t\t\tid: quesID,\r\n\t\t\t\t\tstatus: true\r\n\t\t\t  })\r\n\t\t\t: setVisible({\r\n\t\t\t\t\tid: quesID,\r\n\t\t\t\t\tstatus: false\r\n\t\t\t  })\r\n\t}\r\n\r\n\tconst onGetPoint = (point, questionID) => {\r\n\t\tif (dataMarking.setPackageExerciseStudentsList.some((item, index) => item['ID'] === questionID)) {\r\n\t\t\tdataMarking.setPackageExerciseStudentsList.every((item) => {\r\n\t\t\t\tif (item.ID === questionID) {\r\n\t\t\t\t\titem.Point = point\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\treturn true\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tdataMarking.setPackageExerciseStudentsList.push({\r\n\t\t\t\tID: questionID,\r\n\t\t\t\tPoint: point\r\n\t\t\t})\r\n\t\t}\r\n\t\tgetDataMarking({ ...dataMarking })\r\n\t}\r\n\r\n\t// ----------- ALL ACTION IN DOINGTEST -------------\r\n\tconst onGetDataEditor = (dataAns, quesID) => {\r\n\t\tgetListPicked(quesID)\r\n\t\tsetContentOfStudent(dataAns)\r\n\t\t// Find index\r\n\t\tlet indexQuestion = packageResult.SetPackageResultDetailInfoList.findIndex((item) => item.ExamTopicDetailID === dataQuestion.ID)\r\n\t\tlet indexQuestionDetail = packageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList.findIndex(\r\n\t\t\t(item) => item.ExerciseID === quesID\r\n\t\t)\r\n\t\t// Add new answer to list\r\n\t\tif (\r\n\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[indexQuestionDetail]\r\n\t\t\t\t.SetPackageExerciseAnswerStudentList.length == 0\r\n\t\t) {\r\n\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[\r\n\t\t\t\tindexQuestionDetail\r\n\t\t\t].SetPackageExerciseAnswerStudentList.push({\r\n\t\t\t\tAnswerID: 0,\r\n\t\t\t\tAnswerContent: dataAns,\r\n\t\t\t\tFileAudio: ''\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[\r\n\t\t\t\tindexQuestionDetail\r\n\t\t\t].SetPackageExerciseAnswerStudentList[0].AnswerContent = dataAns\r\n\t\t}\r\n\t\tgetPackageResult({ ...packageResult })\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!doneTestData) {\r\n\t\t\tif (isDoingTest) {\r\n\t\t\t\t// Find index\r\n\t\t\t\tlet indexQuestion = packageResult.SetPackageResultDetailInfoList.findIndex((item) => item.ExamTopicDetailID === dataQuestion.ID)\r\n\t\t\t\tif (\r\n\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[0]\r\n\t\t\t\t\t\t.SetPackageExerciseAnswerStudentList.length > 0\r\n\t\t\t\t) {\r\n\t\t\t\t\tsetContentOfStudent(\r\n\t\t\t\t\t\tpackageResult.SetPackageResultDetailInfoList[indexQuestion].SetPackageExerciseStudentInfoList[0]\r\n\t\t\t\t\t\t\t.SetPackageExerciseAnswerStudentList[0].AnswerContent\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (dataQuestion.ExerciseTopic[0].ExerciseAnswer.length > 0) {\r\n\t\t\t\tsetContentOfStudent(dataQuestion.ExerciseTopic[0].ExerciseAnswer[0].AnswerContent)\r\n\t\t\t}\r\n\t\t}\r\n\t}, [activeID])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{dataQuestion.ExerciseTopic.map((ques, ind) => (\r\n\t\t\t\t<div className={`question-item typing ${ques.ExerciseID === activeID ? 'active-doing' : ''}`} key={ind}>\r\n\t\t\t\t\t<div className=\"box-detail\">\r\n\t\t\t\t\t\t<div className=\"box-title\">\r\n\t\t\t\t\t\t\t<span className={`title-ques`}>{returnPosition(ques.ExerciseID)}</span>\r\n\t\t\t\t\t\t\t<div className=\"title-text mt-3\">{ReactHtmlParser(ques.Content)}</div>\r\n\t\t\t\t\t\t\t<div className=\"box-doing-wrting mt-3\">\r\n\t\t\t\t\t\t\t\t{contentOfStudent ? (\r\n\t\t\t\t\t\t\t\t\t<h6 className=\"text-underline mb-2\">\r\n\t\t\t\t\t\t\t\t\t\t<u>Bài viết đã làm</u>\r\n\t\t\t\t\t\t\t\t\t</h6>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\tisDoingTest && <h6 className=\"text-underline\">Bấm vào nút bên dưới để làm bài tự luận</h6>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t{<div className=\"content-of-student\">{ReactHtmlParser(contentOfStudent)}</div>}\r\n\t\t\t\t\t\t\t\t{!doneTestData && isDoingTest && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"writting-editor mt-2\">\r\n\t\t\t\t\t\t\t\t\t\t<WrittingModal\r\n\t\t\t\t\t\t\t\t\t\t\tcontentOfStudent={contentOfStudent}\r\n\t\t\t\t\t\t\t\t\t\t\tonGetDataEditor={(content) => onGetDataEditor(content, ques.ExerciseID)}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"box-action\">\r\n\t\t\t\t\t\t<div className=\"box-action-list mb-2\">\r\n\t\t\t\t\t\t\t{!doneTestData && !isDoingTest && (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{!isChangePosition && (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<EditPoint quesItem={ques} dataQuestion={dataQuestion} />\r\n\t\t\t\t\t\t\t\t\t\t\t<Popconfirm\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Bạn có chắc muốn xóa?\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonConfirm={() => handleOk(ques)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tokButtonProps={{ loading: confirmLoading }}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonCancel={() => handleCancel(ques.ID)}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Xóa câu hỏi\" placement=\"rightTop\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button className=\"btn btn-icon delete\" onClick={() => deleteQuestionItem(ques.ID)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Trash2 />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t</Popconfirm>\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t<ChangePosition\r\n\t\t\t\t\t\t\t\t\t\tdataQuestion={dataQuestion}\r\n\t\t\t\t\t\t\t\t\t\tarPosition={arPosition}\r\n\t\t\t\t\t\t\t\t\t\tquestionID={dataQuestion.ID}\r\n\t\t\t\t\t\t\t\t\t\thandleChange={handleChange}\r\n\t\t\t\t\t\t\t\t\t\taddOldItem={addOldItem}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{hideScore == true ? (\r\n\t\t\t\t\t\t\t<></>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<div className=\"point-question\">\r\n\t\t\t\t\t\t\t\t<p className=\"text mb-2\">\r\n\t\t\t\t\t\t\t\t\t{!dataMarking ? ques?.Point : dataMarking.setPackageExerciseStudentsList.find((item) => item['ID'] === ques.ID)?.Point}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{dataMarking && !isMarked && (\r\n\t\t\t\t\t\t\t<div className=\"point-marking\">\r\n\t\t\t\t\t\t\t\t<MarkingExam onGetPoint={(point) => onGetPoint(point, ques.ID)} dataRow={ques} dataMarking={dataMarking} />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{dataMarking && ques?.Point !== undefined && (\r\n\t\t\t\t\t\t\t<div className=\"point-show mt-3\">\r\n\t\t\t\t\t\t\t\t<p className=\"mb-0\">Điểm: {ques?.Point}</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t))}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default WrittingList\r\n"]},"metadata":{},"sourceType":"module"}