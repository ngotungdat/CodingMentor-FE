{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"D:\\\\MonaMedia\\\\Project\\\\IELTS-NguyenHuyen-FE\\\\IELTS-Nguyen-Huyen\\\\src\\\\components\\\\Global\\\\Package\\\\PackageDetail\\\\PackageDetail.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Tooltip } from 'antd';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Eye } from 'react-feather';\nimport { examTopicApi, packageApi } from '~/apiBase';\nimport { packageDetailApi } from '~/apiBase/package/package-detail';\nimport DeleteTableRow from '~/components/Elements/DeleteTableRow/DeleteTableRow';\nimport PowerTable from '~/components/PowerTable';\nimport { useWrap } from '~/context/wrap';\nimport { fmSelectArr } from '~/utils/functions';\nimport PackageDetailForm from './PackageDetailForm/PackageDetailForm';\n\nvar PackageDetail = function PackageDetail() {\n  _s();\n\n  var router = useRouter();\n  var ID = router.query.slug;\n\n  var _useState = useState([]),\n      packageDetailList = _useState[0],\n      setPackageDetailList = _useState[1];\n\n  var _useState2 = useState({\n    type: '',\n    status: false\n  }),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(null),\n      totalPage = _useState3[0],\n      setTotalPage = _useState3[1];\n\n  var _useWrap = useWrap(),\n      showNoti = _useWrap.showNoti;\n\n  var _useState4 = useState(null),\n      packageInfo = _useState4[0],\n      setPackageInfo = _useState4[1];\n\n  var _useState5 = useState([]),\n      optionExamTopicList = _useState5[0],\n      setOptionExamTopicList = _useState5[1]; // FILTER\n\n\n  var listFieldInit = {\n    pageIndex: 1,\n    pageSize: 10,\n    SetPackageID: ID\n  };\n  var refValue = useRef({\n    pageIndex: 1,\n    pageSize: 10\n  });\n\n  var _useState6 = useState(listFieldInit),\n      filters = _useState6[0],\n      setFilters = _useState6[1]; // PAGINATION\n\n\n  var getPagination = function getPagination(pageIndex, pageSize) {\n    if (!pageSize) pageSize = 10;\n    refValue.current = _objectSpread(_objectSpread({}, refValue.current), {}, {\n      pageSize: pageSize,\n      pageIndex: pageIndex\n    });\n    setFilters(_objectSpread(_objectSpread({}, filters), refValue.current));\n  }; // RESET SEARCH\n\n\n  var onResetSearch = function onResetSearch() {\n    setFilters(_objectSpread(_objectSpread({}, listFieldInit), {}, {\n      pageSize: refValue.current.pageSize\n    }));\n  }; // GET DATA IN FIRST TIME\n\n\n  var fetchPackageDetailList = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setIsLoading({\n                type: 'GET_ALL',\n                status: true\n              });\n              _context.prev = 1;\n              _context.next = 4;\n              return packageDetailApi.getAll(filters);\n\n            case 4:\n              res = _context.sent;\n\n              if (res.status === 200) {\n                if (res.data.totalRow && res.data.data.length) {\n                  setPackageDetailList(res.data.data);\n                  setTotalPage(res.data.totalRow);\n                }\n              } else if (res.status === 204) {\n                showNoti('danger', 'Không tìm thấy');\n              }\n\n              _context.next = 11;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](1);\n              showNoti('danger', _context.t0.message);\n\n            case 11:\n              _context.prev = 11;\n              setIsLoading({\n                type: 'GET_ALL',\n                status: false\n              });\n              return _context.finish(11);\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 8, 11, 14]]);\n    }));\n\n    return function fetchPackageDetailList() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var fetchPackage = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setIsLoading({\n                type: 'GET_ALL',\n                status: true\n              });\n              _context2.prev = 1;\n              _context2.next = 4;\n              return packageApi.getByID(ID);\n\n            case 4:\n              res = _context2.sent;\n\n              if (res.status === 200) {\n                setPackageInfo(res.data.data);\n              } else if (res.status === 204) {\n                showNoti('danger', 'Không tìm thấy');\n              }\n\n              _context2.next = 11;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](1);\n              showNoti('danger', _context2.t0.message);\n\n            case 11:\n              _context2.prev = 11;\n              setIsLoading({\n                type: 'GET_ALL',\n                status: false\n              });\n              return _context2.finish(11);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 8, 11, 14]]);\n    }));\n\n    return function fetchPackage() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var fetchExam = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var res, fmOptionExamTopicList;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setIsLoading({\n                type: 'GET_ALL',\n                status: true\n              });\n              _context3.prev = 1;\n              _context3.next = 4;\n              return examTopicApi.getAll({\n                selectAll: true,\n                Type: 2\n              });\n\n            case 4:\n              res = _context3.sent;\n\n              if (res.status === 200) {\n                fmOptionExamTopicList = fmSelectArr(res.data.data, 'Name', 'ID');\n                setOptionExamTopicList(fmOptionExamTopicList);\n              } else if (res.status === 204) {\n                showNoti('danger', 'Không tìm thấy');\n              }\n\n              _context3.next = 11;\n              break;\n\n            case 8:\n              _context3.prev = 8;\n              _context3.t0 = _context3[\"catch\"](1);\n              showNoti('danger', _context3.t0.message);\n\n            case 11:\n              _context3.prev = 11;\n              setIsLoading({\n                type: 'GET_ALL',\n                status: false\n              });\n              return _context3.finish(11);\n\n            case 14:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[1, 8, 11, 14]]);\n    }));\n\n    return function fetchExam() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    fetchPackage();\n    fetchExam();\n  }, []);\n  useEffect(function () {\n    fetchPackageDetailList();\n  }, [filters]);\n\n  var onCreatePackageDetail = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(data) {\n      var newPackageDetail, res;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: true\n              });\n              _context4.prev = 1;\n              newPackageDetail = {\n                SetPackageID: packageInfo.ID,\n                ExamTopicID: data.ExamTopicID\n              };\n              _context4.next = 5;\n              return packageDetailApi.add(newPackageDetail);\n\n            case 5:\n              res = _context4.sent;\n\n              if (!(res.status === 200)) {\n                _context4.next = 10;\n                break;\n              }\n\n              onResetSearch();\n              showNoti('success', res.data.message);\n              return _context4.abrupt(\"return\", res);\n\n            case 10:\n              _context4.next = 15;\n              break;\n\n            case 12:\n              _context4.prev = 12;\n              _context4.t0 = _context4[\"catch\"](1);\n              showNoti('danger', _context4.t0.message);\n\n            case 15:\n              _context4.prev = 15;\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: false\n              });\n              return _context4.finish(15);\n\n            case 18:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[1, 12, 15, 18]]);\n    }));\n\n    return function onCreatePackageDetail(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var onDeletePackageDetail = function onDeletePackageDetail(idx) {\n    return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var delObj, newDelObj, res;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: true\n              });\n              _context5.prev = 1;\n              delObj = packageDetailList[idx];\n              newDelObj = _objectSpread(_objectSpread({}, delObj), {}, {\n                Enable: false\n              });\n              _context5.next = 6;\n              return packageDetailApi.update(newDelObj);\n\n            case 6:\n              res = _context5.sent;\n              res.status === 200 && showNoti('success', res.data.message);\n\n              if (!(packageDetailList.length === 1)) {\n                _context5.next = 11;\n                break;\n              }\n\n              filters.pageIndex === 1 ? (setFilters(_objectSpread(_objectSpread(_objectSpread({}, listFieldInit), refValue.current), {}, {\n                pageIndex: 1\n              })), setPackageDetailList([])) : setFilters(_objectSpread(_objectSpread(_objectSpread({}, filters), refValue.current), {}, {\n                pageIndex: filters.pageIndex - 1\n              }));\n              return _context5.abrupt(\"return\");\n\n            case 11:\n              fetchPackageDetailList();\n              _context5.next = 17;\n              break;\n\n            case 14:\n              _context5.prev = 14;\n              _context5.t0 = _context5[\"catch\"](1);\n              showNoti('danger', _context5.t0.message);\n\n            case 17:\n              _context5.prev = 17;\n              setIsLoading({\n                type: 'ADD_DATA',\n                status: false\n              });\n              return _context5.finish(17);\n\n            case 20:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[1, 14, 17, 20]]);\n    }));\n  };\n\n  var columns = [{\n    title: 'Tên đề thi',\n    dataIndex: 'ExamTopicName'\n  }, {\n    title: 'Môn',\n    dataIndex: 'SubjectName'\n  }, {\n    title: 'Level',\n    dataIndex: 'SetPackageLevel',\n    render: function render(SetPackageLevel) {\n      return \"HSK \".concat(SetPackageLevel);\n    }\n  }, {\n    title: 'Thời gian',\n    dataIndex: 'Time',\n    render: function render(time) {\n      return \"\".concat(time, \" ph\\xFAt\");\n    }\n  }, {\n    title: 'Hình thức',\n    dataIndex: 'TypeName'\n  }, {\n    align: 'center',\n    render: function render(packageItem, record, idx) {\n      return /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          href: {\n            pathname: \"/question-bank/exam-list/exam-detail/\".concat(packageItem.ExamTopicID)\n          },\n          children: /*#__PURE__*/_jsxDEV(Tooltip, {\n            title: \"Chi ti\\u1EBFt \\u0111\\u1EC1 thi\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              className: \"btn btn-icon\",\n              children: /*#__PURE__*/_jsxDEV(Eye, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 9\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 8\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 7\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 6\n        }, _this), /*#__PURE__*/_jsxDEV(DeleteTableRow, {\n          handleDelete: onDeletePackageDetail(idx)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 6\n        }, _this)]\n      }, void 0, true);\n    }\n  }];\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(PowerTable, {\n      currentPage: filters.pageIndex,\n      totalPage: totalPage,\n      getPagination: getPagination,\n      loading: isLoading,\n      Size: \"package-list-table\",\n      addClass: \"basic-header\",\n      dataSource: packageDetailList,\n      columns: columns,\n      TitlePage: \"Danh s\\xE1ch b\\u1ED9 \\u0111\\u1EC1\",\n      TitleCard: /*#__PURE__*/_jsxDEV(PackageDetailForm, {\n        isLoading: isLoading,\n        packageInfo: packageInfo,\n        optionExamTopicList: optionExamTopicList,\n        handleSubmit: onCreatePackageDetail\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 6\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 4\n    }, _this)\n  }, void 0, false);\n};\n\n_s(PackageDetail, \"rewOiN/P42FdSoNwhHirtsjOBeQ=\", false, function () {\n  return [useRouter, useWrap];\n});\n\n_c = PackageDetail;\nexport default PackageDetail;\n\nvar _c;\n\n$RefreshReg$(_c, \"PackageDetail\");","map":{"version":3,"sources":["D:/MonaMedia/Project/IELTS-NguyenHuyen-FE/IELTS-Nguyen-Huyen/src/components/Global/Package/PackageDetail/PackageDetail.tsx"],"names":["Tooltip","Link","useRouter","React","useEffect","useRef","useState","Eye","examTopicApi","packageApi","packageDetailApi","DeleteTableRow","PowerTable","useWrap","fmSelectArr","PackageDetailForm","PackageDetail","router","ID","query","slug","packageDetailList","setPackageDetailList","type","status","isLoading","setIsLoading","totalPage","setTotalPage","showNoti","packageInfo","setPackageInfo","optionExamTopicList","setOptionExamTopicList","listFieldInit","pageIndex","pageSize","SetPackageID","refValue","filters","setFilters","getPagination","current","onResetSearch","fetchPackageDetailList","getAll","res","data","totalRow","length","message","fetchPackage","getByID","fetchExam","selectAll","Type","fmOptionExamTopicList","onCreatePackageDetail","newPackageDetail","ExamTopicID","add","onDeletePackageDetail","idx","delObj","newDelObj","Enable","update","columns","title","dataIndex","render","SetPackageLevel","time","align","packageItem","record","pathname"],"mappings":"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","sourcesContent":["import { Tooltip } from 'antd'\r\nimport Link from 'next/link'\r\nimport { useRouter } from 'next/router'\r\nimport React, { useEffect, useRef, useState } from 'react'\r\nimport { Eye } from 'react-feather'\r\nimport { examTopicApi, packageApi } from '~/apiBase'\r\nimport { packageDetailApi } from '~/apiBase/package/package-detail'\r\nimport DeleteTableRow from '~/components/Elements/DeleteTableRow/DeleteTableRow'\r\nimport PowerTable from '~/components/PowerTable'\r\nimport { useWrap } from '~/context/wrap'\r\nimport { fmSelectArr } from '~/utils/functions'\r\nimport PackageDetailForm from './PackageDetailForm/PackageDetailForm'\r\n\r\nconst PackageDetail = () => {\r\n\tconst router = useRouter()\r\n\tconst { slug: ID } = router.query\r\n\tconst [packageDetailList, setPackageDetailList] = useState<ISetPackageDetail[]>([])\r\n\tconst [isLoading, setIsLoading] = useState({\r\n\t\ttype: '',\r\n\t\tstatus: false\r\n\t})\r\n\tconst [totalPage, setTotalPage] = useState(null)\r\n\tconst { showNoti } = useWrap()\r\n\tconst [packageInfo, setPackageInfo] = useState<IPackage>(null)\r\n\tconst [optionExamTopicList, setOptionExamTopicList] = useState<IOptionCommon[]>([])\r\n\t// FILTER\r\n\tconst listFieldInit = {\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: 10,\r\n\r\n\t\tSetPackageID: ID\r\n\t}\r\n\tlet refValue = useRef({\r\n\t\tpageIndex: 1,\r\n\t\tpageSize: 10\r\n\t})\r\n\tconst [filters, setFilters] = useState(listFieldInit)\r\n\t// PAGINATION\r\n\tconst getPagination = (pageIndex: number, pageSize: number) => {\r\n\t\tif (!pageSize) pageSize = 10\r\n\t\trefValue.current = {\r\n\t\t\t...refValue.current,\r\n\t\t\tpageSize,\r\n\t\t\tpageIndex\r\n\t\t}\r\n\t\tsetFilters({\r\n\t\t\t...filters,\r\n\t\t\t...refValue.current\r\n\t\t})\r\n\t}\r\n\t// RESET SEARCH\r\n\tconst onResetSearch = () => {\r\n\t\tsetFilters({\r\n\t\t\t...listFieldInit,\r\n\t\t\tpageSize: refValue.current.pageSize\r\n\t\t})\r\n\t}\r\n\t// GET DATA IN FIRST TIME\r\n\tconst fetchPackageDetailList = async () => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'GET_ALL',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\t\ttry {\r\n\t\t\tlet res = await packageDetailApi.getAll(filters)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tif (res.data.totalRow && res.data.data.length) {\r\n\t\t\t\t\tsetPackageDetailList(res.data.data)\r\n\t\t\t\t\tsetTotalPage(res.data.totalRow)\r\n\t\t\t\t}\r\n\t\t\t} else if (res.status === 204) {\r\n\t\t\t\tshowNoti('danger', 'Không tìm thấy')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tconst fetchPackage = async () => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'GET_ALL',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\t\ttry {\r\n\t\t\tlet res = await packageApi.getByID(ID)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tsetPackageInfo(res.data.data)\r\n\t\t\t} else if (res.status === 204) {\r\n\t\t\t\tshowNoti('danger', 'Không tìm thấy')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tconst fetchExam = async () => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'GET_ALL',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\t\ttry {\r\n\t\t\tlet res = await examTopicApi.getAll({ selectAll: true, Type: 2 })\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tconst fmOptionExamTopicList = fmSelectArr(res.data.data, 'Name', 'ID')\r\n\t\t\t\tsetOptionExamTopicList(fmOptionExamTopicList)\r\n\t\t\t} else if (res.status === 204) {\r\n\t\t\t\tshowNoti('danger', 'Không tìm thấy')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'GET_ALL',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tfetchPackage()\r\n\t\tfetchExam()\r\n\t}, [])\r\n\r\n\tuseEffect(() => {\r\n\t\tfetchPackageDetailList()\r\n\t}, [filters])\r\n\r\n\tconst onCreatePackageDetail = async (data: { Name: string; ExamTopicID: number }) => {\r\n\t\tsetIsLoading({\r\n\t\t\ttype: 'ADD_DATA',\r\n\t\t\tstatus: true\r\n\t\t})\r\n\t\ttry {\r\n\t\t\tconst newPackageDetail = {\r\n\t\t\t\tSetPackageID: packageInfo.ID,\r\n\t\t\t\tExamTopicID: data.ExamTopicID\r\n\t\t\t}\r\n\t\t\tconst res = await packageDetailApi.add(newPackageDetail)\r\n\t\t\tif (res.status === 200) {\r\n\t\t\t\tonResetSearch()\r\n\t\t\t\tshowNoti('success', res.data.message)\r\n\t\t\t\treturn res\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tshowNoti('danger', error.message)\r\n\t\t} finally {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tconst onDeletePackageDetail = (idx: number) => {\r\n\t\treturn async () => {\r\n\t\t\tsetIsLoading({\r\n\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\tstatus: true\r\n\t\t\t})\r\n\t\t\ttry {\r\n\t\t\t\tconst delObj = packageDetailList[idx]\r\n\t\t\t\tconst newDelObj = {\r\n\t\t\t\t\t...delObj,\r\n\t\t\t\t\tEnable: false\r\n\t\t\t\t}\r\n\t\t\t\tconst res = await packageDetailApi.update(newDelObj)\r\n\t\t\t\tres.status === 200 && showNoti('success', res.data.message)\r\n\t\t\t\tif (packageDetailList.length === 1) {\r\n\t\t\t\t\tfilters.pageIndex === 1\r\n\t\t\t\t\t\t? (setFilters({\r\n\t\t\t\t\t\t\t\t...listFieldInit,\r\n\t\t\t\t\t\t\t\t...refValue.current,\r\n\t\t\t\t\t\t\t\tpageIndex: 1\r\n\t\t\t\t\t\t  }),\r\n\t\t\t\t\t\t  setPackageDetailList([]))\r\n\t\t\t\t\t\t: setFilters({\r\n\t\t\t\t\t\t\t\t...filters,\r\n\t\t\t\t\t\t\t\t...refValue.current,\r\n\t\t\t\t\t\t\t\tpageIndex: filters.pageIndex - 1\r\n\t\t\t\t\t\t  })\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tfetchPackageDetailList()\r\n\t\t\t} catch (error) {\r\n\t\t\t\tshowNoti('danger', error.message)\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading({\r\n\t\t\t\t\ttype: 'ADD_DATA',\r\n\t\t\t\t\tstatus: false\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'Tên đề thi',\r\n\t\t\tdataIndex: 'ExamTopicName'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Môn',\r\n\t\t\tdataIndex: 'SubjectName'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Level',\r\n\t\t\tdataIndex: 'SetPackageLevel',\r\n\t\t\trender: (SetPackageLevel) => `HSK ${SetPackageLevel}`\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Thời gian',\r\n\t\t\tdataIndex: 'Time',\r\n\t\t\trender: (time) => `${time} phút`\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'Hình thức',\r\n\t\t\tdataIndex: 'TypeName'\r\n\t\t},\r\n\t\t{\r\n\t\t\talign: 'center',\r\n\t\t\trender: (packageItem: ISetPackageDetail, record, idx) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\thref={{\r\n\t\t\t\t\t\t\tpathname: `/question-bank/exam-list/exam-detail/${packageItem.ExamTopicID}`\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Tooltip title=\"Chi tiết đề thi\">\r\n\t\t\t\t\t\t\t<a className=\"btn btn-icon\">\r\n\t\t\t\t\t\t\t\t<Eye />\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t<DeleteTableRow handleDelete={onDeletePackageDetail(idx)} />\r\n\t\t\t\t</>\r\n\t\t\t)\r\n\t\t}\r\n\t]\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<PowerTable\r\n\t\t\t\tcurrentPage={filters.pageIndex}\r\n\t\t\t\ttotalPage={totalPage}\r\n\t\t\t\tgetPagination={getPagination}\r\n\t\t\t\tloading={isLoading}\r\n\t\t\t\tSize=\"package-list-table\"\r\n\t\t\t\taddClass=\"basic-header\"\r\n\t\t\t\tdataSource={packageDetailList}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tTitlePage=\"Danh sách bộ đề\"\r\n\t\t\t\tTitleCard={\r\n\t\t\t\t\t<PackageDetailForm\r\n\t\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t\t\tpackageInfo={packageInfo}\r\n\t\t\t\t\t\toptionExamTopicList={optionExamTopicList}\r\n\t\t\t\t\t\thandleSubmit={onCreatePackageDetail}\r\n\t\t\t\t\t/>\r\n\t\t\t\t}\r\n\t\t\t/>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default PackageDetail\r\n"]},"metadata":{},"sourceType":"module"}